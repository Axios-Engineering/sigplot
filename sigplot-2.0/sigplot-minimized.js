/*

 File: CanvasInput.js
  CanvasInput v1.0.10
  http://goldfirestudios.com/blog/108/CanvasInput-HTML5-Canvas-Text-Input

  (c) 2013, James Simpson of GoldFire Studios
  goldfirestudios.com

  (c) 2013, Axios, Inc.
  Modifications made by Axios, Inc.
  axiosengineering.com

  MIT License

 File: common.js
 Copyright (c) 2012-2014, Michael Ihde, All rights reserved.
 Copyright (c) 2012-2014, Axios Inc., All rights reserved.

 This file is part of SigPlot.

 SigPlot is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser
 General Public License as published by the Free Software Foundation; either version 3.0 of the License, or
 (at your option) any later version. This library is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
 PURPOSE. See the GNU Lesser General Public License for more details. You should have received a copy of the
 GNU Lesser General Public License along with SigPlot.


 File: m.js
 Copyright (c) 2012-2014, Michael Ihde, All rights reserved.
 Copyright (c) 2012-2014, Axios Inc., All rights reserved.

 This file is part of SigPlot.

 SigPlot is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser
 General Public License as published by the Free Software Foundation; either version 3.0 of the License, or
 (at your option) any later version. This library is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
 PURPOSE. See the GNU Lesser General Public License for more details. You should have received a copy of the
 GNU Lesser General Public License along with SigPlot.

 File: sigplot.js
 Copyright (c) 2012-2014, Michael Ihde, All rights reserved.
 Copyright (c) 2012-2014, Axios Inc., All rights reserved.

 This file is part of SigPlot.

 SigPlot is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser
 General Public License as published by the Free Software Foundation; either version 3.0 of the License, or
 (at your option) any later version. This library is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
 PURPOSE. See the GNU Lesser General Public License for more details. You should have received a copy of the
 GNU Lesser General Public License along with SigPlot.

 File: sigplot.layer1d.js
 Copyright (c) 2012-2014, Michael Ihde, All rights reserved.
 Copyright (c) 2012-2014, Axios Inc., All rights reserved.

 This file is part of SigPlot.

 SigPlot is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser
 General Public License as published by the Free Software Foundation; either version 3.0 of the License, or
 (at your option) any later version. This library is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
 PURPOSE. See the GNU Lesser General Public License for more details. You should have received a copy of the
 GNU Lesser General Public License along with SigPlot.

 File: sigplot.layer2d.js
 Copyright (c) 2012-2014, Michael Ihde, All rights reserved.
 Copyright (c) 2012-2014, Axios Inc., All rights reserved.

 This file is part of SigPlot.

 SigPlot is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser
 General Public License as published by the Free Software Foundation; either version 3.0 of the License, or
 (at your option) any later version. This library is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
 PURPOSE. See the GNU Lesser General Public License for more details. You should have received a copy of the
 GNU Lesser General Public License along with SigPlot.

 File: bluefile.js
 Copyright (c) 2012-2014, Michael Ihde, All rights reserved.
 Copyright (c) 2012-2014, Axios Inc., All rights reserved.

 This file is part of SigPlot.

 SigPlot is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser
 General Public License as published by the Free Software Foundation; either version 3.0 of the License, or
 (at your option) any later version. This library is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
 PURPOSE. See the GNU Lesser General Public License for more details. You should have received a copy of the
 GNU Lesser General Public License along with SigPlot.


 File: mx.js
 Copyright (c) 2012-2014, Michael Ihde, All rights reserved.
 Copyright (c) 2012-2014, Axios Inc., All rights reserved.

 This file is part of SigPlot.

 SigPlot is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser
 General Public License as published by the Free Software Foundation; either version 3.0 of the License, or
 (at your option) any later version. This library is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
 PURPOSE. See the GNU Lesser General Public License for more details. You should have received a copy of the
 GNU Lesser General Public License along with SigPlot.
*/
(function(ea){"object"===typeof exports&&"undefined"!==typeof module?module.exports=ea():"function"===typeof define&&define.amd?define([],ea):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).sigplot=ea()})(function(){return function R(P,W,b){function e(a,c){if(!W[a]){if(!P[a]){var h="function"==typeof require&&require;if(!c&&h)return h(a,!0);if(m)return m(a,!0);h=Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h;}h=W[a]=
{exports:{}};P[a][0].call(h.exports,function(b){var h=P[a][1][b];return e(h?h:b)},h,h.exports,R,P,W,b)}return W[a].exports}for(var m="function"==typeof require&&require,a=0;a<b.length;a++)e(b[a]);return e}({1:[function(R,P,W){(function(){var b=[],e=window.CanvasInput=function(m){var a=this;m=m?m:{};a._canvas=m.canvas||null;a._ctx=a._canvas?a._canvas.getContext("2d"):null;a._x=m.x||0;a._y=m.y||0;a._extraX=m.extraX||0;a._extraY=m.extraY||0;a._fontSize=m.fontSize||14;a._fontFamily=m.fontFamily||"Arial";
a._fontColor=m.fontColor||"#000";a._placeHolderColor=m.placeHolderColor||"#bfbebd";a._fontWeight=m.fontWeight||"normal";a._fontStyle=m.fontStyle||"normal";a._readonly=m.readonly||!1;a._maxlength=m.maxlength||null;a._width=m.width||150;a._height=m.height||a._fontSize;a._padding=0<=m.padding?m.padding:5;a._borderWidth=0<=m.borderWidth?m.borderWidth:1;a._borderColor=m.borderColor||"#959595";a._borderRadius=0<=m.borderRadius?m.borderRadius:3;a._backgroundImage=m.backgroundImage||"";a._boxShadow=m.boxShadow||
"1px 1px 0px rgba(255, 255, 255, 1)";a._innerShadow=m.innerShadow||"0px 0px 4px rgba(0, 0, 0, 0.4)";a._selectionColor=m.selectionColor||"rgba(179, 212, 253, 0.8)";a._placeHolder=m.placeHolder||"";a._value=m.value||a._placeHolder;a._onsubmit=m.onsubmit||function(){};a._onkeydown=m.onkeydown||function(){};a._onkeyup=m.onkeyup||function(){};a._onfocus=m.onfocus||function(){};a._onblur=m.onblur||function(){};a._cursor=!1;a._cursorPos=0;a._hasFocus=!1;a._selection=[0,0];a._wasOver=!1;a._renderOnReturn=
void 0!==m.renderOnReturn?m.renderOnReturn:!0;a._disableBlur=m.disableBlur||!1;a._tabToClear=m.tabToClear||!1;a.boxShadow(a._boxShadow,!0);a._calcWH();a._renderCanvas=document.createElement("canvas");a._renderCanvas.setAttribute("width",a.outerW);a._renderCanvas.setAttribute("height",a.outerH);a._renderCtx=a._renderCanvas.getContext("2d");a._shadowCanvas=document.createElement("canvas");a._shadowCanvas.setAttribute("width",a._width+2*a._padding);a._shadowCanvas.setAttribute("height",a._height+2*a._padding);
a._shadowCtx=a._shadowCanvas.getContext("2d");"undefined"!==typeof m.backgroundGradient?(a._backgroundColor=a._renderCtx.createLinearGradient(0,0,0,a.outerH),a._backgroundColor.addColorStop(0,m.backgroundGradient[0]),a._backgroundColor.addColorStop(1,m.backgroundGradient[1])):a._backgroundColor=m.backgroundColor||"#fff";a._canvas&&(a.mousemoveCanvasListener=function(b){b=b||window.event;a.mousemove(b,a)},a._canvas.addEventListener("mousemove",a.mousemoveCanvasListener,!1),a.mousedownCanvasListener=
function(b){b=b||window.event;a.mousedown(b,a)},a._canvas.addEventListener("mousedown",a.mousedownCanvasListener,!1),a.mouseupCanvasListener=function(b){b=b||window.event;a.mouseup(b,a)},a._canvas.addEventListener("mouseup",a.mouseupCanvasListener,!1));a.mouseupWindowListener=function(b){a._hasFocus&&!a._mouseDown&&a.blur()};window.addEventListener("mouseup",a.mouseupWindowListener,!0);a.keydownWindowListener=function(b){b=b||window.event;a._hasFocus&&a.keydown(b,a)};window.addEventListener("keydown",
a.keydownWindowListener,!1);a.keyupWindowListener=function(b){b=b||window.event;a._hasFocus&&a._onkeyup(b,a)};window.addEventListener("keyup",a.keyupWindowListener,!1);a.pasteWindowListener=function(b){b=b||window.event;if(a._hasFocus){b=b.clipboardData.getData("text/plain");var m=a._value.substr(0,a._cursorPos),h=a._value.substr(a._cursorPos);a._value=m+b+h;a._cursorPos+=b.length;a.render()}};window.addEventListener("paste",a.pasteWindowListener,!1);b.push(a);a._inputsIndex=b.length-1;a.render()};
e.prototype={canvas:function(b){return"undefined"!==typeof b?(this._canvas=b,this._ctx=this._canvas.getContext("2d"),this.render()):this._canvas},x:function(b){return"undefined"!==typeof b?(this._x=b,this.render()):this._x},y:function(b){return"undefined"!==typeof b?(this._y=b,this.render()):this._y},extraX:function(b){return"undefined"!==typeof b?(this._extraX=b,this.render()):this._extraX},extraY:function(b){return"undefined"!==typeof b?(this._extraY=b,this.render()):this._extraY},fontSize:function(b){return"undefined"!==
typeof b?(this._fontSize=b,this.render()):this._fontSize},fontFamily:function(b){return"undefined"!==typeof b?(this._fontFamily=b,this.render()):this._fontFamily},fontColor:function(b){return"undefined"!==typeof b?(this._fontColor=b,this.render()):this._fontColor},placeHolderColor:function(b){return"undefined"!==typeof b?(this._placeHolderColor=b,this.render()):this._placeHolderColor},fontWeight:function(b){return"undefined"!==typeof b?(this._fontWeight=b,this.render()):this._fontWeight},fontStyle:function(b){return"undefined"!==
typeof b?(this._fontStyle=b,this.render()):this._fontStyle},width:function(b){return"undefined"!==typeof b?(this._width=b,this._calcWH(),this._updateCanvasWH(),this.render()):this._width},height:function(b){return"undefined"!==typeof b?(this._height=b,this._calcWH(),this._updateCanvasWH(),this.render()):this._height},padding:function(b){return"undefined"!==typeof b?(this._padding=b,this._calcWH(),this._updateCanvasWH(),this.render()):this._padding},borderWidth:function(b){return"undefined"!==typeof b?
(this._borderWidth=b,this._calcWH(),this._updateCanvasWH(),this.render()):this._borderWidth},borderColor:function(b){return"undefined"!==typeof b?(this._borderColor=b,this.render()):this._borderColor},borderRadius:function(b){return"undefined"!==typeof b?(this._borderRadius=b,this.render()):this._borderRadius},backgroundColor:function(b){return"undefined"!==typeof b?(this._backgroundColor=b,this.render()):this._backgroundColor},backgroundGradient:function(b){return"undefined"!==typeof b?(this._backgroundColor=
this._renderCtx.createLinearGradient(0,0,0,this.outerH),this._backgroundColor.addColorStop(0,b[0]),this._backgroundColor.addColorStop(1,b[1]),this.render()):this._backgroundColor},boxShadow:function(b,a){if("undefined"!==typeof b){var d=b.split("px ");this._boxShadow={x:"none"===this._boxShadow?0:parseInt(d[0],10),y:"none"===this._boxShadow?0:parseInt(d[1],10),blur:"none"===this._boxShadow?0:parseInt(d[2],10),color:"none"===this._boxShadow?"":d[3]};this.shadowL=0>this._boxShadow.x?Math.abs(this._boxShadow.x)+
this._boxShadow.blur:Math.abs(this._boxShadow.blur-this._boxShadow.x);this.shadowR=this._boxShadow.blur+this._boxShadow.x;this.shadowT=0>this._boxShadow.y?Math.abs(this._boxShadow.y)+this._boxShadow.blur:Math.abs(this._boxShadow.blur-this._boxShadow.y);this.shadowB=this._boxShadow.blur+this._boxShadow.y;this.shadowW=this.shadowL+this.shadowR;this.shadowH=this.shadowT+this.shadowB;this._calcWH();if(!a)return this._updateCanvasWH(),this.render()}else return this._boxShadow},innerShadow:function(b){return"undefined"!==
typeof b?(this._innerShadow=b,this.render()):this._innerShadow},selectionColor:function(b){return"undefined"!==typeof b?(this._selectionColor=b,this.render()):this._selectionColor},placeHolder:function(b){return"undefined"!==typeof b?(this._placeHolder=b,this.render()):this._placeHolder},value:function(b){return"undefined"!==typeof b?(this._value=b,this.focus()):this._value},onsubmit:function(b){if("undefined"!==typeof b)return this._onsubmit=b,this;this._onsubmit()},onkeydown:function(b){if("undefined"!==
typeof b)return this._onkeydown=b,this;this._onkeydown()},onkeyup:function(b){if("undefined"!==typeof b)return this._onkeyup=b,this;this._onkeyup()},focus:function(b){var a=this,d;if(!a._readonly){a._hasFocus||a._onfocus(a);a._selectionUpdated?delete a._selectionUpdated:a._selection=[0,0];a._cursorPos="number"===typeof b?b:a._clipText().length;a._placeHolder===a._value&&(a._value="");a._hasFocus=!0;a._cursor=!0;a._cursorInterval&&clearInterval(a._cursorInterval);a._cursorInterval=setInterval(function(){a._cursor=
!a._cursor;a.render()},500);b=navigator.userAgent.toLowerCase();b=0<=b.indexOf("chrome")&&0<=b.indexOf("mobile")&&0<=b.indexOf("android");var c="undefined"!==typeof window.orientation;c&&!b&&document&&document.createElement&&(d=document.createElement("input"))?(d.type="text",d.style.opacity=0,d.style.position="absolute",d.style.left=a._x+a._extraX+(a._canvas?a._canvas.offsetLeft:0)+"px",d.style.top=a._y+a._extraY+(a._canvas?a._canvas.offsetTop:0)+"px",d.style.width=a._width,d.style.height=0,document.body.appendChild(d),
d.focus(),d.addEventListener("blur",function(){a.blur(a)},!1)):c&&a.value(prompt(a._placeHolder)||"");return a.render()}},blur:function(b){b=b||this;b._disableBlur||(b._onblur(b),b._cursorInterval&&clearInterval(b._cursorInterval),b._hasFocus=!1,b._cursor=!1,b._selection=[0,0],""===b._value&&(b._value=b._placeHolder));return b.render()},disableBlur:function(b){(b||this)._disableBlur=!0},enableBlur:function(b){(b||this)._disableBlur=!1},keydown:function(m,a){var d=m.which,c=m.shiftKey,h=null,n;if(a._hasFocus){a._onkeydown(m,
a);if(65===d&&(m.ctrlKey||m.metaKey))return a._selection=[0,a._value.length],m.preventDefault(),a.render();if(17===d||m.metaKey||m.ctrlKey)return a;m.preventDefault();if(8===d)!a._clearSelection()&&0<a._cursorPos&&(c=a._value.substr(0,a._cursorPos-1),n=a._value.substr(a._cursorPos,a._value.length),a._value=c+n,a._cursorPos--);else if(37===d)0<a._cursorPos&&(a._cursorPos--,a._cursor=!0,a._selection=[0,0]);else if(39===d)a._cursorPos<a._value.length&&(a._cursorPos++,a._cursor=!0,a._selection=[0,0]);
else if(13===d)a._onsubmit(m,a);else if(9===d)if(a._tabToClear)a._value="",a._cursorPos=0;else{var f=b[a._inputsIndex+1]?a._inputsIndex+1:0;f!==a._inputsIndex&&(a.blur(),setTimeout(function(){b[f].focus()},10))}else if(h=a._mapCodeToKey(c,d)){a._clearSelection();if(a._maxlength&&a._maxlength<=a._value.length)return;c=a._value?a._value.substr(0,a._cursorPos):"";n=a._value?a._value.substr(a._cursorPos):"";a._value=c+h+n;a._cursorPos++}return 13==d&&a._renderOnReturn||13!==d?a.render():function(){}}},
click:function(b,a){var d=a._mousePos(b),c=d.x,d=d.y;if(a._endSelection)delete a._endSelection,delete a._selectionUpdated;else if(a._canvas&&a._overInput(c,d)||!a._canvas){if(a._mouseDown)return a._mouseDown=!1,a.click(b,a),a.focus(a._clickPos(c,d))}else return a.blur()},mousemove:function(b,a){var d=a._mousePos(b),c=d.x,h=d.y;(d=a._overInput(c,h))&&a._canvas?(a._canvas.style.cursor="text",a._wasOver=!0):a._wasOver&&a._canvas&&(a._canvas.style.cursor="default",a._wasOver=!1);if(a._hasFocus&&0<=a._selectionStart)if(h=
a._clickPos(c,h),c=Math.min(a._selectionStart,h),h=Math.max(a._selectionStart,h),!d)a._selectionUpdated=!0,a._endSelection=!0,delete a._selectionStart,a.render();else if(a._selection[0]!==c||a._selection[1]!==h)a._selection=[c,h],a.render()},mousedown:function(b,a){var d=a._mousePos(b),c=d.x,d=d.y,h=a._overInput(c,d);a._mouseDown=h;a._hasFocus&&h&&(a._selectionStart=a._clickPos(c,d))},mouseup:function(b,a){var d=a._mousePos(b),c=d.x,d=d.y,h=a._clickPos(c,d)!==a._selectionStart;a._hasFocus&&0<=a._selectionStart&&
a._overInput(c,d)&&h?(a._selectionUpdated=!0,delete a._selectionStart,a.render()):delete a._selectionStart;a.click(b,a)},renderCanvas:function(){return this._renderCanvas},cleanup:function(){this._canvas.removeEventListener("mouseup",this.mouseupCanvasListener,!1);this._canvas.removeEventListener("mousedown",this.mousedownCanvasListener,!1);this._canvas.removeEventListener("mousemove",this.mousemoveCanvasListener,!1);window.removeEventListener("keydown",this.keydownWindowListener,!1);window.removeEventListener("keyup",
this.keyupWindowListener,!1);window.removeEventListener("mouseup",this.mouseupWindowListener,!0);window.removeEventListener("paste",this.pasteWindowListener,!1);clearInterval(this._cursorInterval);this._canvas.style.cursor="default";for(var m=0;m<b.length;m++)b[m]===this&&b.remove(m)},render:function(){var b=this,a=b._renderCtx,d=b.outerW,c=b.outerH,h=b._borderRadius,n=b._borderWidth,f=b.shadowW,z=b.shadowH;a.clearRect(0,0,a.canvas.width,a.canvas.height);a.shadowOffsetX=b._boxShadow.x;a.shadowOffsetY=
b._boxShadow.y;a.shadowBlur=b._boxShadow.blur;a.shadowColor=b._boxShadow.color;0<b._borderWidth&&(a.fillStyle=b._borderColor,b._roundedRect(a,b.shadowL,b.shadowT,d-f,c-z,h),a.fill(),a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=0);b._drawTextBox(function(){a.shadowOffsetX=0;a.shadowOffsetY=0;a.shadowBlur=0;var r=b._clipText(),e=b._padding+b._borderWidth+b.shadowT;if(0<b._selection[1]){var D=b._textWidth(r.substring(0,b._selection[0])),y=b._textWidth(r.substring(b._selection[0],b._selection[1]));
a.fillStyle=b._selectionColor;a.fillRect(e+D,e,y,b._height)}a.fillStyle=b._placeHolder===b._value&&""!==b._value?b._placeHolderColor:b._fontColor;b._cursor&&(D=b._textWidth(r.substring(0,b._cursorPos)),a.fillRect(e+D,e,1,b._height));D=b._padding+b._borderWidth+b.shadowL;e=Math.round(e+b._height/2);a.font=b._fontStyle+" "+b._fontWeight+" "+b._fontSize+"px "+b._fontFamily;a.textAlign="left";a.textBaseline="middle";a.fillText(r,D,e);y=b._innerShadow.split("px ");r="none"===b._innerShadow?0:parseInt(y[0],
10);e="none"===b._innerShadow?0:parseInt(y[1],10);D="none"===b._innerShadow?0:parseInt(y[2],10);y="none"===b._innerShadow?"":y[3];if(0<D){var w=b._shadowCtx,G=w.canvas.width,L=w.canvas.height;w.clearRect(0,0,G,L);w.shadowBlur=D;w.shadowColor=y;w.shadowOffsetX=0;w.shadowOffsetY=e;w.fillRect(-1*d,-100,3*d,100);w.shadowOffsetX=r;w.shadowOffsetY=0;w.fillRect(G,-1*c,100,3*c);w.shadowOffsetX=0;w.shadowOffsetY=e;w.fillRect(-1*d,L,3*d,100);w.shadowOffsetX=r;w.shadowOffsetY=0;w.fillRect(-100,-1*c,100,3*c);
b._roundedRect(a,n+b.shadowL,n+b.shadowT,d-2*n-f,c-2*n-z,h);a.clip();a.drawImage(b._shadowCanvas,0,0,G,L,n+b.shadowL,n+b.shadowT,G,L)}b._ctx&&(b._ctx.clearRect(b._x,b._y,a.canvas.width,a.canvas.height),b._ctx.drawImage(b._renderCanvas,b._x,b._y));return b})},_drawTextBox:function(b){var a=this,d=a._renderCtx,c=a.outerW,h=a.outerH,n=a._borderRadius,f=a._borderWidth,z=a.shadowW,r=a.shadowH;if(""===a._backgroundImage)d.fillStyle=a._backgroundColor,a._roundedRect(d,f+a.shadowL,f+a.shadowT,c-2*f-z,h-2*
f-r,n),d.fill(),b();else{var e=new Image;e.src=a._backgroundImage;e.onload=function(){d.drawImage(e,0,0,e.width,e.height,f+a.shadowL,f+a.shadowT,c,h);b()}}},_clearSelection:function(){if(0<this._selection[1]){var b=this._selection[0],a=this._selection[1];this._value=this._value.substr(0,b)+this._value.substr(a);this._cursorPos=b;this._cursorPos=0>this._cursorPos?0:this._cursorPos;this._selection=[0,0];return!0}return!1},_clipText:function(b){b="undefined"===typeof b?this._value:b;var a=this._textWidth(b)/
(this._width-this._padding);return(1<a?b.substr(-1*Math.floor(b.length/a)):b)+""},_textWidth:function(b){var a=this._renderCtx;a.font=this._fontStyle+" "+this._fontWeight+" "+this._fontSize+"px "+this._fontFamily;a.textAlign="left";return a.measureText(b).width},_calcWH:function(){this.outerW=this._width+2*this._padding+2*this._borderWidth+this.shadowW;this.outerH=this._height+2*this._padding+2*this._borderWidth+this.shadowH},_updateCanvasWH:function(){var b=this._renderCanvas.width,a=this._renderCanvas.height;
this._renderCanvas.setAttribute("width",this.outerW);this._renderCanvas.setAttribute("height",this.outerH);this._shadowCanvas.setAttribute("width",this._width+2*this._padding);this._shadowCanvas.setAttribute("height",this._height+2*this._padding);this._ctx&&this._ctx.clearRect(this._x,this._y,b,a)},_roundedRect:function(b,a,d,c,h,n){c<2*n&&(n=c/2);h<2*n&&(n=h/2);b.beginPath();b.moveTo(a+n,d);b.lineTo(a+c-n,d);b.quadraticCurveTo(a+c,d,a+c,d+n);b.lineTo(a+c,d+h-n);b.quadraticCurveTo(a+c,d+h,a+c-n,d+
h);b.lineTo(a+n,d+h);b.quadraticCurveTo(a,d+h,a,d+h-n);b.lineTo(a,d+n);b.quadraticCurveTo(a,d,a+n,d);b.closePath()},_overInput:function(b,a){var d=b<=this._x+this._extraX+this._width+2*this._padding,c=a>=this._y+this._extraY,h=a<=this._y+this._extraY+this._height+2*this._padding;return b>=this._x+this._extraX&&d&&c&&h},_clickPos:function(b,a){var d=this._value;this._value===this._placeHolder&&(d="");var d=this._clipText(d),c=0,h=d.length;if(b-(this._x+this._extraX)<this._textWidth(d))for(var n=0;n<
d.length;n++)if(c+=this._textWidth(d[n]),c>=b-(this._x+this._extraX)){h=n;break}return h},_mousePos:function(b){var a=b.target,d=document.defaultView.getComputedStyle(a,void 0),c=parseInt(d.paddingLeft,10)||0,h=parseInt(d.paddingLeft,10)||0,n=parseInt(d.borderLeftWidth,10)||0,d=parseInt(d.borderLeftWidth,10)||0,f=document.body.parentNode.offsetTop||0,z=document.body.parentNode.offsetLeft||0,r=0,e=0;if("unefined"!==typeof a.offsetParent){do r+=a.offsetLeft,e+=a.offsetTop;while(a=a.offsetParent)}return{x:b.pageX-
(r+(c+n+z)),y:b.pageY-(e+(h+d+f))}},_mapCodeToKey:function(b,a){for(var d=[8,9,13,16,17,18,20,27,91,92],c="",c=0;c<d.length;c++)if(a===d[c])return;if("boolean"===typeof b&&"number"===typeof a)return d={32:" ",48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",107:"+",173:"_",189:"_",186:":",187:"+",188:"<",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},c=b?65<=a&&90>=a?String.fromCharCode(a):d[a]:65<=a&&90>=a?String.fromCharCode(a).toLowerCase():96===a?"0":97===
a?"1":98===a?"2":99===a?"3":100===a?"4":101===a?"5":102===a?"6":103===a?"7":104===a?"8":105===a?"9":188===a?",":190===a?".":191===a?"/":192===a?"`":220===a?"\\":187===a?"=":189===a||173===a?"-":222===a?"'":186===a?";":219===a?"[":221===a?"]":String.fromCharCode(a)}};P.exports=e})()},{}],2:[function(R,P,W){(function(){function b(){}function e(b){b=new Uint8Array(b);if(E)return String.fromCharCode.apply(null,b);for(var a="",h=0;h<b.length;h++)a+=String.fromCharCode(b[h]);return a}function m(b){return 0<=
b&&31>b?1<<b:m[b]||(m[b]=Math.pow(2,b))}function a(b){var a=document.createElement("a");a.href=b;for(var h=a.protocol.replace(":",""),c=a.hostname,f=a.port,n=a.search,d={},z=a.search.replace(/^\?/,"").split("&"),r=z.length,e=0,E;e<r;e++)z[e]&&(E=z[e].split("="),d[E[0]]=E[1]);return{source:b,protocol:h,host:c,port:f,query:n,params:d,file:(a.pathname.match(/\/([^\/?#]+)$/i)||[null,""])[1],hash:a.hash.replace("#",""),path:a.pathname.replace(/^([^\/])/,"/$1"),relative:(a.href.match(/tps?:\/\/[^\/]+(.+)/)||
[null,""])[1],segments:a.pathname.replace(/^\//,"").split("/")}}function d(b,a,h){h=h||1024;var c=0,f=new ArrayBuffer(b.length),n=new Uint8Array(f),d=function(){for(var z=c+h;c<z;c++)n[c]=b.charCodeAt(c)&255;c>=b.length?a(f):setTimeout(d,0)};setTimeout(d,0)}var c=R("./common");navigator.userAgent.match(/(iPad|iPhone|iPod)/i);var h=function(){var b=new ArrayBuffer(4),a=new Uint32Array(b),b=new Uint8Array(b);a[0]=3735928559;if(239===b[0])return"LE";if(222===b[0])return"BE";throw Error("unknown endianness");
}(),n={S:1,C:2,V:3,Q:4,M:9,X:10,T:16,U:1,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9},f={P:0.125,A:1,O:1,B:1,I:2,L:4,X:8,F:4,D:8},z={P:null,A:null,O:Uint8Array,B:Int8Array,I:Int16Array,L:Int32Array,X:null,F:Float32Array,D:Float64Array},r={P:null,A:null,O:"getUint8",B:"getInt8",I:"getInt16",L:"getInt32",X:function(b,a,h){var c,f,n=Math.pow(2,53);h?(c=4,f=0):(c=0,f=4);c=b.getInt32(a+c,h);b=b.getInt32(a+f,h)+m(32)*c;return b>=n?(window.console.info("Int is bigger than JS can represent."),Infinity):b},F:"getFloat32",
D:"getFloat64"},E=!0;try{var D=new Uint8Array(new ArrayBuffer(4));D[0]=66;D[1]=76;D[2]=85;D[3]=69;"BLUE"!==String.fromCharCode.apply(null,D)&&(E=!1)}catch(y){E=!1}b.BlueHeader=function(b,a){this.options={ext_header_type:"dict"};c.update(this.options,a);this.file_name=this.file=null;this.offset=0;this.buf=b;if(null!=this.buf){var h=new DataView(this.buf);this.version=e(this.buf.slice(0,4));this.headrep=e(this.buf.slice(4,8));this.datarep=e(this.buf.slice(8,12));var f="EEEI"===this.headrep,n="EEEI"===
this.datarep;this.ext_start=h.getInt32(24,f);this.ext_size=h.getInt32(28,f);this.type=h.getUint32(48,f);this["class"]=this.type/1E3;this.format=e(this.buf.slice(52,54));this.timecode=h.getFloat64(56,f);1===this["class"]?(this.xstart=h.getFloat64(256,f),this.xdelta=h.getFloat64(264,f),this.xunits=h.getInt32(272,f),this.yunits=h.getInt32(296,f),this.subsize=1):2===this["class"]&&(this.xstart=h.getFloat64(256,f),this.xdelta=h.getFloat64(264,f),this.xunits=h.getInt32(272,f),this.subsize=h.getInt32(276,
f),this.ystart=h.getFloat64(280,f),this.ydelta=h.getFloat64(288,f),this.yunits=h.getInt32(296,f));this.data_start=h.getFloat64(32,f);this.data_size=h.getFloat64(40,f);var h=this.data_start,d=this.data_start+this.data_size;this.ext_size&&(this.ext_header=this.unpack_keywords(this.buf,this.ext_size,512*this.ext_start,f));this.setData(this.buf,h,d,n)}};b.BlueHeader.prototype={setData:function(b,a,c,d){1===this["class"]?(this.spa=n[this.format[0]],this.bps=f[this.format[1]],this.bpa=this.spa*this.bps,
this.ape=1,this.bpe=this.ape*this.bpa):2===this["class"]&&(this.spa=n[this.format[0]],this.bps=f[this.format[1]],this.bpa=this.spa*this.bps,this.ape=this.subsize,this.bpe=this.ape*this.bpa);void 0===d&&(d="LE"===h);if("LE"===h&&!d)throw"Not supported "+h+" "+d;if("BE"===h&&this.littleEndianData)throw"Not supported "+h+" "+d;b?(this.dview=a&&c?this.createArray(b,a,(c-a)/this.bps):this.createArray(b),this.size=this.dview.length/(this.spa*this.ape)):this.dview=this.createArray(null,null,this.size)},
unpack_keywords:function(b,a,h,f){var c,n,d,z,E,m,y=[],p={},F={},K=0;b=b.slice(h,b.length);var v=new DataView(b);for(b=e(b);K<a;)m=K+8,h=v.getUint32(K,f),c=v.getInt16(K+4,f),n=v.getInt8(K+6,f),d=b.slice(K+7,K+8),c=h-c,E=m+c,n=b.slice(E,E+n),"A"===d?z=b.slice(m,m+c):r[d]?z="string"===typeof r[d]?v[r[d]](m,f):r[d](v,m,f):window.console.info("Unsupported keyword format "+d+" for tag "+n),"undefined"===typeof p[n]?p[n]=1:(p[n]++,n=""+n+p[n]),F[n]=z,y.push({tag:n,value:z}),K+=h;b=["dict","json",{},"XMTable",
"JSON","DICT"];for(var C in b)if(b[C]===this.options.ext_header_type)return F;return y},createArray:function(b,a,h){var c=z[this.format[1]];if(void 0===c)throw"unknown format "+this.format[1];void 0===a&&(a=0);void 0===h&&(h=b.length||b.byteLength/f[this.format[1]]);return b?new c(b,a,h):new c(h)}};b.BlueFileReader=function(b){this.options=b};b.BlueFileReader.prototype={readheader:function(a,h){var c=this,f=new FileReader,n=a.webkitSlice(0,512);f.onloadend=function(a){return function(n){n.target.error?
h(null):(n=new b.BlueHeader(f.result,c.options),n.file=a,h(n))}}(a);f.readAsArrayBuffer(n)},read:function(a,h){var f=this,c=new FileReader;c.onloadend=function(a){return function(n){n.target.error?h(null):(n=new b.BlueHeader(c.result,f.options),n.file=a,n.file_name=a.name,h(n))}}(a);c.readAsArrayBuffer(a)},read_http:function(h,c){var f=this,n=new XMLHttpRequest;n.open("GET",h,!0);n.responseType="arraybuffer";n.overrideMimeType("text/plain; charset=x-user-defined");n.onload=function(z){if(4!==n.readyState||
200!==n.status&&0!==n.status)c(null);else if(z=null,n.response){z=n.response;z=new b.BlueHeader(z,f.options);a(h);var r=a(h);z.file_name=r.file;c(z)}else n.responseText&&d(n.responseText,function(n){n=new b.BlueHeader(n,f.options);a(h);var d=a(h);n.file_name=d.file;c(n)})};n.onerror=function(b){c(null)};n.send(null)}};P.exports=b})()},{"./common":3}],3:[function(R,P,W){(function(){P.exports={};window.ArrayBuffer&&!ArrayBuffer.prototype.slice&&(ArrayBuffer.prototype.slice=function(b,e){var m=new Uint8Array(this);
void 0===e&&(e=m.length);for(var a=new ArrayBuffer(e-b),d=new Uint8Array(a),c=0;c<d.length;c++)d[c]=m[c+b];return a});Array.prototype.remove=function(b,e){var m=this.slice((e||b)+1||this.length);this.length=0>b?this.length+b:b;return this.push.apply(this,m)};window.requestAnimFrame=function(b){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){return window.setTimeout(b,
1E3/60)}}();window.cancelAnimFrame=function(b){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCanelAnimationFrame||function(b){window.clearTimeout(b)}}();P.exports.dashOn=function(b,e,m){return b.setLineDash?(b.setLineDash([e,m]),!0):void 0!==b.mozDash?(b.mozDash=[e,m],!0):b.webkitLineDash&&0===b.webkitLineDash.length?(b.webkitLineDash=[e,m],!0):!1};P.exports.dashOff=function(b){b.setLineDash?b.setLineDash([]):
b.mozDash?b.mozDash=null:b.webkitLineDash&&(b.webkitLineDash=[])};P.exports.getKeyCode=function(b){b=window.event||b;return b=b.charCode||b.keyCode};P.exports.setKeypressHandler=function(b){window.addEventListener?window.addEventListener("keypress",b,!1):window.attachEvent&&window.attachEvent("onkeypress",b)};Array.isArray||(Array.isArray=function(b){return"[object Array]"===Object.prototype.toString.call(b)});window.Float64Array||(window.Float64Array=function(){return window.Float64Array||function(b,
e,m){if(!(b instanceof ArrayBuffer))throw"Invalid type";var a=new DataView(b),d=[];b=(b.byteLength-e)/8;d.length=void 0===m?b:Math.min(m,b);for(m=0;m<d.length;m++)d[m]=a.getFloat64(8*m+e,!0);d.subarray=function(b,a){return d.slice(b,a)};return d}}());(function(){var b=function(){};window.console||(window.console={log:b,info:b,warn:b,debug:b,error:b});if((new Int8Array([0,1,0])).subarray(1).subarray(1)[0]){var e=function(b,a){0===arguments.length?(b=0,a=this.length):(0>b&&(b+=this.length),b=Math.max(0,
Math.min(this.length,b)),1===arguments.length?a=this.length:(0>a&&(a+=this.length),a=Math.max(b,Math.min(this.length,a))));return new this.constructor(this.buffer,this.byteOffset+b*this.BYTES_PER_ELEMENT,a-b)};[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array].forEach(function(b){b.prototype.subarray=e})}})();(function(b,e){function m(h,n,f,z){h[d](a+n,"wheel"===c?f:function(a){!a&&(a=b.event);var h={originalEvent:a,target:a.target||a.srcElement,type:"wheel",
deltaMode:"MozMousePixelScroll"===a.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){a.preventDefault?a.preventDefault():a.returnValue=!1}};"mousewheel"===c?(h.deltaY=-0.025*a.wheelDelta,a.wheelDeltaX&&(h.deltaX=-0.025*a.wheelDeltaX)):h.deltaY=a.detail;return f(h)},z||!1)}var a="",d,c;b.addEventListener?d="addEventListener":(d="attachEvent",a="on");c="onwheel"in e.createElement("div")?"wheel":void 0!==e.onmousewheel?"mousewheel":"DOMMouseScroll";b.addWheelListener=function(b,a,f){m(b,c,a,f);"DOMMouseScroll"===
c&&m(b,"MozMousePixelScroll",a,f)}})(window,document);P.exports.update=function e(m,a){for(var d in a){var c=a[d];"object"===typeof c?e(m[d],c):m[d]=c}return m}})()},{}],4:[function(R,P,W){(function(){function b(){}function e(b){return(10>b?"0":"")+b}var m=R("./bluefile"),a=R("loglevel");b.log=a;navigator.userAgent.match(/(iPad|iPhone|iPod)/i)||"undefined"===typeof Float64Array||Float64Array.emulated||!Float64Array.BYTES_PER_ELEMENT?b.PointArray=Float32Array:b.PointArray=Float64Array;var d={0:["None",
"U"],1:["Time","sec"],2:["Delay","sec"],3:["Frequency","Hz"],4:["Time code format",""],5:["Distance","m"],6:["Speed","m/s"],7:["Acceleration","m/sec^2"],8:["Jerk","m/sec^3"],9:["Doppler","Hz"],10:["Doppler rate","Hz/sec"],11:["Energy","J"],12:["Power","W"],13:["Mass","g"],14:["Volume","l"],15:["Angular power density","W/ster"],16:["Integrated power density","W/rad"],17:["Spatial power density","W/m^2"],18:["Integrated power density","W/m"],19:["Spectral power density","W/MHz"],20:["Amplitude","U"],
21:["Real","U"],22:["Imaginary","U"],23:["Phase","rad"],24:["Phase","deg"],25:["Phase","cycles"],26:["10*Log","U"],27:["20*Log","U"],28:["Magnitude","U"],29:["Unknown","U"],30:["Unknown","U"],31:["General dimensionless",""],32:["Counts",""],33:["Angle","rad"],34:["Angle","deg"],35:["Relative power","dB"],36:["Relative power","dBm"],37:["Relative power","dBW"],38:["Solid angle","ster"],40:["Distance","ft"],41:["Distance","nmi"],42:["Speed","ft/sec"],43:["Speed","nmi/sec"],44:["Speed","knots=nmi/hr"],
45:["Acceleration","ft/sec^2"],46:["Acceleration","nmi/sec^2"],47:["Acceleration","knots/sec"],48:["Acceleration","G"],49:["Jerk","G/sec"],50:["Rotation","rps"],51:["Rotation","rpm"],52:["Angular velocity","rad/sec"],53:["Angular velocity","deg/sec"],54:["Angular acceleration","rad/sec^2"],55:["Angular acceleration","deg/sec^2"],60:["Latitude","deg"],61:["Longitude","deg"],62:["Altitude","ft"],63:["Altitude","m"]};b.UNITS=d;b.Mc={colormap:[{name:"Greyscale",colors:[{pos:0,red:0,green:0,blue:0},{pos:60,
red:50,green:50,blue:50},{pos:100,red:100,green:100,blue:100},{pos:100,red:0,green:0,blue:0},{pos:100,red:0,green:0,blue:0},{pos:100,red:0,green:0,blue:0},{pos:100,red:0,green:0,blue:0}]},{name:"Ramp Colormap",colors:[{pos:0,red:0,green:0,blue:15},{pos:10,red:0,green:0,blue:50},{pos:31,red:0,green:65,blue:75},{pos:50,red:0,green:85,blue:0},{pos:70,red:75,green:80,blue:0},{pos:83,red:100,green:60,blue:0},{pos:100,red:100,green:0,blue:0}]},{name:"Color Wheel",colors:[{pos:0,red:100,green:100,blue:0},
{pos:20,red:0,green:80,blue:40},{pos:30,red:0,green:100,blue:100},{pos:50,red:10,green:10,blue:0},{pos:65,red:100,green:0,blue:0},{pos:88,red:100,green:40,blue:0},{pos:100,red:100,green:100,blue:0}]},{name:"Spectrum",colors:[{pos:0,red:0,green:75,blue:0},{pos:22,red:0,green:90,blue:90},{pos:37,red:0,green:0,blue:85},{pos:49,red:90,green:0,blue:85},{pos:68,red:90,green:0,blue:0},{pos:80,red:90,green:90,blue:0},{pos:100,red:95,green:95,blue:95}]},{name:"calewhite",colors:[{pos:0,red:100,green:100,blue:100},
{pos:16.666,red:0,green:0,blue:100},{pos:33.333,red:0,green:100,blue:100},{pos:50,red:0,green:100,blue:0},{pos:66.666,red:100,green:100,blue:0},{pos:83.333,red:100,green:0,blue:0},{pos:100,red:100,green:0,blue:100}]},{name:"HotDesat",colors:[{pos:0,red:27.84,green:27.84,blue:85.88},{pos:14.2857,red:0,green:0,blue:35.69},{pos:28.571,red:0,green:100,blue:100},{pos:42.857,red:0,green:49.8,blue:0},{pos:57.14286,red:100,green:100,blue:0},{pos:71.42857,red:100,green:37.65,blue:0},{pos:85.7143,red:41.96,
green:0,blue:0},{pos:100,red:87.84,green:29.8,blue:29.8}]},{name:"Sunset",colors:[{pos:0,red:10,green:0,blue:23},{pos:18,red:34,green:0,blue:60},{pos:36,red:58,green:20,blue:47},{pos:55,red:74,green:20,blue:28},{pos:72,red:90,green:43,blue:0},{pos:87,red:100,green:72,blue:0},{pos:100,red:100,green:100,blue:76}]}]};b.PIPESIZE=1048576;b.initialize=function(a,c){var f=new m.BlueHeader(null);f.version="BLUE";f.size=0;f.type=1E3;f.format="SF";f.timecode=0;f.xstart=0;f.xdelta=1;f.xunits=0;f.subsize=1;f.ystart=
0;f.ydelta=1;f.yunits=0;c||(c={});for(var d in c)f[d]=c[d];1<f.subsize&&(f.type=2E3);f["class"]=f.type/1E3;if(2===f["class"]&&void 0===c.subsize)throw"subsize must be provided with type 2000 files";c.pipe?(f.pipe=!0,f.in_byte=0,f.out_byte=0,f.buf=new ArrayBuffer(c.pipesize||b.PIPESIZE),f.setData(f.buf),f.data_free=f.dview.length):f.setData(a);return f};b.force1000=function(b){2===b["class"]&&(b.size=b.size&&!b.pipe?b.subsize*b.size:0,b.bpe/=b.subsize,b.ape=1)};b.grab=function(b,a,c,d){if(!b.dview)return 0;
"C"===b.format[0]&&(c*=2);d=Math.min(a.length,b.dview.length-c);if(void 0===a.set)for(var r=0;r<d;r++)a[r]=b.dview[c+r];else a.set(b.dview.subarray(c,c+d));"C"===b.format[0]&&(d/=2);return d};b.filad=function(b,a,c){if(b.data_free<a.length)throw"Pipe full";var d=b.in_byte/b.dview.BYTES_PER_ELEMENT,r=d+a.length;if(r>b.dview.length){var r=b.dview.length-d,e=a.length-r;a.subarray?(b.dview.set(a.subarray(0,r),d),b.dview.set(a.subarray(r,a.length),0)):(b.dview.set(a.slice(0,r),d),b.dview.set(a.slice(r,
a.length),0));b.in_byte=e*b.dview.BYTES_PER_ELEMENT}else b.dview.set(a,d),b.in_byte=r*b.dview.BYTES_PER_ELEMENT%b.buf.byteLength;b.data_free-=a.length;if(b.onwritelisteners)for(a=0;a<b.onwritelisteners.length;a++)if(c)b.onwritelisteners[a]();else window.setTimeout(b.onwritelisteners[a],0)};b.pavail=function(b){return b.dview.length-b.data_free};b.grabx=function(b,a,c,d){var r=b.dview.length-b.data_free;void 0===d&&(d=0);if(!c)c=Math.min(a.length-d,r);else if(c>a.length-d)throw"m.grabx : nget larger then available buffer space";
if(0>c)throw"m.grabx : nget cannot be negative";if(c>r)return 0;var r=b.out_byte/b.dview.BYTES_PER_ELEMENT,e=r+c;if(e>=b.dview.length){var m=b.dview.length-r,e=e-b.dview.length;a.set(b.dview.subarray(r,b.dview.length),d);a.set(b.dview.subarray(0,e),d+m)}else a.set(b.dview.subarray(r,e),d);b.out_byte=e*b.dview.BYTES_PER_ELEMENT%b.buf.byteLength;b.data_free+=c;return c};b.addPipeWriteListener=function(b,a){b.onwritelisteners||(b.onwritelisteners=[]);-1===b.onwritelisteners.indexOf(a)&&b.onwritelisteners.push(a)};
b.units_name=function(b){b=d[b];return b[0]+" ("+b[1]+")"};b.trim_name=function(b){var a=b.indexOf("]");-1===a&&(a=b.indexOf("/"));-1===a&&(a=b.indexOf(":"));var c=b.substr(a+1,b.length).indexOf(".");0>c&&(c=b.length-a);return b.substr(a+1,a+c+1)};b.label=function(a,c){var f=["Unknown","U"];"string"===typeof a?f=[a,null]:Array.isArray(a)?f=a:(f=d[a],void 0===f&&(f=["Unknown","U"]));var z=b.mult_prefix(c);return f[1]?f[0]+" ("+z+f[1]+")":f[0]};b.bound=function(b,a,c){return b<a?a:b>c?c:b};b.touch_distance=
function(b,a){var c=b.pageX-a.pageX,d=b.pageY-a.pageY;return Math.sqrt(c*c+d*d)};b.mult_prefix=function(b){var a="?";1==b?a="":10==b?a="da":0.1==b?a="d":100==b?a="h":0.01==b?a="c":1E3==b?a="K":0.001==b?a="m":1E6==b?a="M":1E-6==b?a="u":1E9==b?a="G":1E-9==b?a="n":1E12==b?a="T":1E-12==b&&(a="p");return a};var c="F";b.vstype=function(b){c=b;"D"===c||"L"===c||"F"===c||"I"===c||"B"===c||alert("Unsupported vector type")};b.log10=function(b,a){void 0===a&&(a=1E-20);return Math.log(Math.max(b,a))/Math.log(10)};
b.vlog10=function(b,a,c){void 0===a&&(a=1E-20);void 0===c&&(c=b);for(var d=0;d<b.length&&!(c.length<=d);d++)c[d]=Math.log(Math.max(b[d],a))/Math.log(10)};b.vlogscale=function(b,a,c,d){void 0===a&&(a=1E-20);void 0===c&&(c=1);void 0===d&&(d=b);for(var e=0;e<b.length&&!(d.length<=e);e++)d[e]=Math.log(Math.abs(Math.max(b[e],a)))/Math.log(10),d[e]*=c};b.cvmag2logscale=function(b,a,c,d){void 0===a&&(a=1E-20);void 0===c&&(c=1);void 0===d&&(d=b);for(var e=0,m=0;m<d.length;m++){e=2*m+1;if(e>=b.length)break;
d[m]=b[e-1]*b[e-1]+b[e]*b[e];d[m]=Math.log(Math.abs(Math.max(d[m],a)))/Math.log(10);d[m]*=c}};b.vsmul=function(b,a,c,d){void 0===c&&(c=b);void 0===d&&(d=c.length);d=Math.min(c.length,d);d=Math.min(b.length,d);for(var e=0;e<d&&!(c.length<=e);e++)c[e]=b[e]*a};b.vmxmn=function(b,a){var c=b[0],d=b[0],e=0,m=0;a=Math.min(a,b.length);for(var D=0;D<a;D++)b[D]>c&&(c=b[D],e=D),b[D]<d&&(d=b[D],m=D);return{smax:c,smin:d,imax:e,imin:m}};b.vmov=function(b,a,c,d,e){void 0===e&&(e=b.length);e=Math.min(b.length,e);
for(var m=0;m<e;m++){var D=m*a,y=m*d;if(D>=b.length)break;if(y>=c.length)break;c[y]=b[D]}};b.vfill=function(b,a,c){void 0===c&&(c=b.length);c=Math.min(b.length,c);for(var d=0;d<c;d++)b[d]=a};b.vabs=function(b,a,c){void 0===c&&(c=b.length);void 0===a&&(a=b);for(var d=0;d<c;d++)a[d]=Math.abs(b[d])};b.cvmag=function(b,a,c){void 0===c&&(c=a.length);c=Math.min(a.length,c);for(var d=0;d<c;d++){var e=2*d+1;if(e>=b.length)break;a[d]=Math.sqrt(b[e-1]*b[e-1]+b[e]*b[e])}};b.cvmag2=function(b,a,c){void 0===c&&
(c=a.length);c=Math.min(a.length,c);for(var d=0,e=0;e<c;e++){d=2*e+1;if(d>=b.length)break;a[e]=b[d-1]*b[d-1]+b[d]*b[d]}};b.cvpha=function(b,a,c){void 0===c&&(c=a.length);c=Math.min(a.length,c);for(var d=0,e=0,m=d=0;m<c;m++){d=2*m+1;if(d>=b.length)break;e=b[d-1];d=b[d];0===e&&0===d&&(e=1);a[m]=Math.atan2(d,e)}};b.cvphad=function(b,a,c){void 0===c&&(c=a.length);c=Math.min(a.length,c);for(var d=0,e=0,m=d=0;m<c;m++){d=2*m+1;if(d>=b.length)break;e=b[d-1];d=b[d];0===e&&0===d&&(e=1);a[m]=Math.atan2(d,e)*
(180/Math.PI)}};b.trunc=function(b){return b-b%1};b.sign=function(b,a){return 0<=a?Math.abs(b):-Math.abs(b)};b.sec2tod=function(b,a){var c="",c=Date.UTC(1950,0,1);Date.UTC(1949,11,31);var d=new Date,d=new Date(d.getFullYear(),d.getMonth(),d.getDate(),0,0,0,0);0<=b?86400>b?(c=d.getTime()+1E3*b,d=new Date(c),c=e(d.getHours())+":"+e(d.getMinutes())+":"+e(d.getSeconds())):86400===b?c="24:00:00":31536E3>b?(c=b/86400,c=[0<c?Math.floor(c):Math.ceil(c)],d=new Date(1E3*b+d.getTime()),c=c.toString()+"::"+e(d.getHours())+
":"+e(d.getMinutes())+":"+e(d.getSeconds())):(c=Math.floor(1E3*b)+c,d=new Date(c),c=d.getUTCFullYear()+":"+e(d.getUTCMonth()+1)+":"+e(d.getUTCDate())+"::"+e(d.getUTCHours())+":"+e(d.getUTCMinutes())+":"+e(d.getUTCSeconds())):-31536E3<b?(c=b/86400,c=0>=c?Math.ceil(c):Math.floor(c),d=new Date(Math.abs(1E3*b)+d.getTime()),c=0===c?"-0":c.toString(),c=c+"::"+e(d.getHours())+":"+e(d.getMinutes())+":"+e(d.getSeconds())):(c=Math.floor(1E3*b)+c,d=new Date(c),c=d.getUTCFullYear()+":"+e(d.getUTCMonth()+1)+":"+
e(d.getUTCDate())+"::"+e(d.getUTCHours())+":"+e(d.getUTCMinutes())+":"+e(d.getUTCSeconds()));c=0===b%1?c+".000000":c+("."+Math.abs(b%1).toPrecision(6).slice(2,8));if(a){var d=c.indexOf("."),m=-1;-1!==d&&(m=c.substr(d,c.length).indexOf("0"));-1!==m&&(c=c.substr(0,d+m))}return c};b.sec2tspec=function(a,c,d){c=c||"";if(0<=a&&86400>=a)return b.sec2tod(a,d);a%=86400;return"delta"!==c&&0>=a?b.sec2tod(a+86400,d):"delta"===c&&0>=a?"-"+b.sec2tod(-1*a,d):b.sec2tod(a,d)};b.sec2tod_j1970=function(b){var a="";
0<=b&&86400>b?(a=new Date(1E3*b),a=e(a.getHours())+":"+e(a.getMinutes())+":"+e(a.getSeconds())):0>b&&-31536E3<b?(a=new Date(1E3*b),a=(b/86400*-1).toString()+"::"+e(a.getHours())+":"+e(a.getMinutes())+":"+e(a.getSeconds())):(a=new Date(1E3*(b-631152E3)),a=a.getFullYear()+":"+e(a.getMonth())+":"+e(a.getDate())+"::"+e(a.getHours())+":"+e(a.getMinutes())+":"+e(a.getSeconds()));0!==b%1&&(a+="."+(b%1).toPrecision(6).slice(2,8));return a};b.j1970toj1950=function(b){return void 0!==b.getTime?b.getTime()/
1E3+631152E3:b+631152E3};b.j1950toj1970=function(b){return b-631152E3};b.throttle=function(b,a){var c=(new Date).getTime();return function(){var d=(new Date).getTime();d-c>=b&&(c=d,a.apply(null,arguments))}};P.exports=b})()},{"./bluefile":2,loglevel:9}],5:[function(R,P,W){(function(){function b(){}function e(){this.ymax=this.ymin=this.xmax=this.xmin=this.yl=this.xl=this.yo=this.xo=0;this.mode=this.func=void 0}function m(p){this.root=p;this.parent=document.createElement("div");this.parent.style.position=
"relative";this.parent.width=p.clientWidth;this.parent.height=p.clientHeight;p.appendChild(this.parent);this.canvas=document.createElement("canvas");this.canvas.style.position="absolute";this.canvas.style.top="0px";this.canvas.style.left="0px";this.canvas.width=p.clientWidth;this.canvas.height=p.clientHeight;this.parent.appendChild(this.canvas);this.active_canvas=this.canvas;this.wid_canvas=document.createElement("canvas");this.wid_canvas.style.position="absolute";this.wid_canvas.style.top="0px";
this.wid_canvas.style.left="0px";this.wid_canvas.style.zIndex=1;this.wid_canvas.width=p.clientWidth;this.wid_canvas.height=p.clientHeight;this.parent.appendChild(this.wid_canvas);this.font=void 0;this.font_family="Courier New, monospace";this.level=this.text_h=this.text_w=0;this.width=this.parent.width;this.height=this.parent.height;this.ymrk=this.xmrk=this.ypos=this.xpos=0;this.origin=1;this.stk=[new b.STKSTRUCT];b.setbgfg(this,"black","white");this.warpbox=this.event_cb=void 0;this.rmode=!1;this.linewidth=
1;this.style=void 0;this.xi=!1;this.l=this.state_mask=this.button_press=this.button_release=0;this.r=this.width;this.t=0;this.b=this.height;this.scrollbar_x=new b.SCROLLBAR;this.scrollbar_y=new b.SCROLLBAR;this.prompt=void 0;this.pixel=[];this._renderCanvas=document.createElement("canvas")}function a(b,F,a,c,d,g,A){d<=a?A>a&&0<(c-F)*(A-a)-(g-F)*(d-a)&&(b+=1):A<=a&&0>(c-F)*(A-a)-(g-F)*(d-a)&&(b-=1);return b}function d(p,F){if(!F.animationFrameHandle){var a=Math.floor((p.canvas.height-70)/(1.5*p.text_h));
I.n_show=a>=F.items.length?F.items.length:a;F.animationFrameHandle=requestAnimFrame(b.withWidgetLayer(p,function(){b.erase_window(p);F.animationFrameHandle=void 0;var a=1.5*p.text_h;F.x=Math.max(F.x,0);F.y=Math.max(F.y,0);F.x=Math.min(F.x,p.width-F.w);F.y=Math.min(F.y,p.height-F.h);var K=F.x+I.GBorder+Math.max(0,I.sidelab),c=F.y+I.GBorder+I.toplab*(a+I.GBorder),d=F.w-2*I.GBorder-Math.abs(I.sidelab);b.widgetbox(p,F.x,F.y,F.w,F.h,K,c,d,F.h-2*I.GBorder-I.toplab*(a+I.GBorder),F.title);var q=p.wid_canvas.getContext("2d");
q.lineWidth=1;q.strokeStyle=p.xwbs;q.beginPath();q.moveTo(K,c-4+0.5);q.lineTo(K+d-1,c-4+0.5);q.stroke();q.strokeStyle=p.xwts;q.beginPath();q.moveTo(K,c-3+0.5);q.lineTo(K+d-1,c-3+0.5);q.stroke();var u=F.queue[0],e=F.queue[I.n_show-1];if(0===e){for(e=0;e<I.n_show;e++)F.queue[e]=e;u=F.queue[0];e=F.queue[I.n_show-1]}for(var k=0;u<=e;u++){var l=F.items[u],s=c+a*k,k=k+1;"separator"===l.style?(q.fillStyle=p.xwbs,q.fillRect(K,s,d,a),q.beginPath(),q.moveTo(K,s+0.5),q.lineTo(K+d,s+0.5),q.stroke(),q.textBaseline=
"middle",q.textAlign="left",q.fillStyle=p.xwfg,q.fillText(" "+l.text+" ",K+2*p.text_w,s+a/2)):(b.LEGACY_RENDER?(q.fillStyle=p.xwlo,q.fillRect(K,s,d,a),q.beginPath(),q.moveTo(K,s+0.5),q.lineTo(K+d,s+0.5),q.stroke(),l.selected&&b.shadowbox(p,K-1,s,d+2,a,1,2,"",0.75)):(q.save(),q.globalAlpha=0.75,q.fillStyle=l.selected?p.xwts:p.xwlo,q.fillRect(K,s,d,a),q.restore(),q.strokeStyle=p.bg,q.beginPath(),q.moveTo(K,s+0.5),q.lineTo(K+d,s+0.5),q.stroke()),q.textBaseline="middle",q.textAlign="left",q.fillStyle=
p.xwfg,"checkbox"===l.style?(q.fillText(" "+l.text+" ",K+2*p.text_w,s+a/2),q.strokeStyle=p.xwfg,q.strokeRect(K+1+p.text_w,s+(a-p.text_w)/2,p.text_w,p.text_w),l.checked&&(q.beginPath(),q.moveTo(K+1+p.text_w,s+(a-p.text_w)/2),q.lineTo(K+1+p.text_w+p.text_w,s+(a-p.text_w)/2+p.text_w),q.stroke(),q.beginPath(),q.moveTo(K+1+p.text_w+p.text_w,s+(a-p.text_w)/2),q.lineTo(K+1+p.text_w,s+(a-p.text_w)/2+p.text_w),q.stroke())):(q.fillText(" "+l.text+" ",K,s+a/2),l.checked&&(q.beginPath(),q.moveTo(K+1,s+p.text_h/
4),q.lineTo(K+1+p.text_w-2,s+p.text_h/4+p.text_h/2),q.lineTo(K+1,s+p.text_h/4+p.text_h),q.lineTo(K+1,s+p.text_h/4),q.fill())))}}))}}function c(p,F){b.onWidgetLayer(p,function(){b.erase_window(p)});p.menu=void 0;p.widget=null;for(var a=0;a<F.items.length;a++){var c=F.items[a];if(c.selected){c.handler?c.handler():c.menu&&(a=c.menu,"function"===typeof c.menu&&(a=c.menu()),a.finalize=F.finalize,b.menu(p,a));break}}!p.menu&&F.finalize&&F.finalize()}function h(p,F){b.onWidgetLayer(p,function(){b.erase_window(p)});
p.menu=void 0;p.widget=null;!p.menu&&F.finalize&&F.finalize()}function n(b,F,a){var c=!0,d;d=F/b;0<b?d>a.tL?c=!1:d>a.tE&&(a.tE=d):0>b?d<a.tE?c=!1:d<a.tL&&(a.tL=d):0<F&&(c=!1);return c}function f(b,F,a,c,d,g,A,q){0>F&&(F=0);0>a&&(a=0);0>c&&(c=0);0>d&&(d=0);q&&(b.lineWidth=q);A&&(b.strokeStyle=A);1===b.lineWidth%2&&(F===c&&(c=F=Math.floor(F)+0.5),a===d&&(d=a=Math.floor(a)+0.5));if(!g||!g.mode)b.beginPath(),b.moveTo(F,a),b.lineTo(c,d),b.stroke(),b.beginPath();else if("dashed"===g.mode){if($.dashOn(b,
g.on,g.off))b.beginPath(),b.moveTo(F,a),b.lineTo(c,d),b.stroke(),$.dashOff(b);else if(b.beginPath(),a===d)for(d=Math.min(F,c),c=Math.max(F,c);d<c;)b.moveTo(d,a),b.lineTo(d+g.on,a),b.stroke(),d+=g.on+g.off;else if(F===c)for(c=Math.min(a,d),d=Math.max(a,d);c<d;)b.moveTo(F,c),b.lineTo(F,c+g.on),b.stroke(),c+=g.on+g.off;else throw"Only horizontal or vertical dashed lines are supported";b.beginPath()}else if("xor"===g.mode)if("undefined"===typeof Uint8ClampedArray)b.beginPath(),b.moveTo(F,a),b.lineTo(c,
d),b.stroke(),b.beginPath();else{A=g=0;if(a===d)g=Math.abs(c-F),A=q,F=Math.min(F,c);else if(F===c)g=q,A=Math.abs(d-a),a=Math.min(a,d);else throw"Only horizontal and vertical lines can be drawn with XOR";if(0!==g&&0!==A){F=Math.floor(F);a=Math.floor(a);c=b.getImageData(F,a,g,A);d=c.data;g=0;for(q=d.length;g<q;g+=4)d[g]=255-d[g],d[g+1]=255-d[g+1],d[g+2]=255-d[g+2],d[g+3]=255;b.putImageData(c,F,a);b.clearRect(0,0,1,1)}}}function z(b,a,c,d,C){r(b,a,C);c&&(b.strokeStyle=c);d&&(b.fillStyle=d);b.fill();
b.closePath()}function r(b,a,c){if(!(1>a.length)){var d=a[0].x,C=a[0].y;b.lineWidth=c?c:1;b.beginPath();b.moveTo(d,C);for(c=0;c<a.length;c++)d=a[c].x,C=a[c].y,b.lineTo(d,C)}}function E(b){return Math.floor(Math.round(b/100*255))}function D(b,a,c){return"rgb("+Math.round(b)+", "+Math.round(a)+", "+Math.round(c)+")"}function y(b,a){var c,d;if(".000000"===b.substring(5,8))c=4;else for(c=b.length-1;"0"===b[c];)c-=1;for(d=0;" "===b[d]&&(5<c-d+1||a);)d+=1;c=b.substring(d,c+1);-1===c.indexOf(".")&&(c+=".");
return c}function w(p){p._animationFrameHandle=void 0;var a=p.warpbox;p.active_canvas.getContext("2d");if(a&&p.xpos>=a.xmin&&p.xpos<=a.xmax&&p.ypos>=a.ymin&&p.ypos<=a.ymax){a.xl=p.xpos;a.yl=p.ypos;var c=Math.min(a.xo,a.xl),d=Math.min(a.yo,a.yl),C=Math.abs(a.xl-a.xo),g=Math.abs(a.yl-a.yo);0!==C&&0!==g&&("vertical"===a.mode?(c=p.l,C=p.r-p.l):"horizontal"===a.mode&&(d=p.t,g=p.b-p.t),b.onWidgetLayer(p,function(){b.erase_window(p);b.draw_box(p,"xor",c,d,C,g,a.style.opacity,a.style.fill_color)}))}}function G(b,
a,c){return b<a?a:b>c?c:b}function L(b,a,c,d,C,g,A,q,u,e,k,l,s){void 0===e&&(e=0);void 0===k&&(k=0);void 0===l&&(l=c.width-e);void 0===s&&(s=c.height-k);b._renderCanvas.width=c.width;b._renderCanvas.height=c.height;for(var h=b._renderCanvas.getContext("2d"),f=h.createImageData(b._renderCanvas.width,b._renderCanvas.height),n=new Uint8Array(c),m=0;m<c.height;++m)for(var w=0;w<c.width;++w){var x=4*(m*c.width+w);f.data[x]=n[x];f.data[x+1]=n[x+1];f.data[x+2]=n[x+2];f.data[x+3]=255}h.putImageData(f,0,0);
a.save();a.globalAlpha=d;C||(a.imageSmoothingEnabled=!1,a.mozImageSmoothingEnabled=!1,a.webkitImageSmoothingEnabled=!1);a.drawImage(b._renderCanvas,e,k,l,s,g,A,q,u);a.restore()}function T(b,a,c,d,C,g,A,q,u,e,k,l,s){void 0===e&&(e=0);void 0===k&&(k=0);void 0===l&&(l=c.width-e);void 0===s&&(s=c.height-k);if(32768>c.width&&32768>c.height){b._renderCanvas.width=c.width;b._renderCanvas.height=c.height;var h=b._renderCanvas.getContext("2d"),f=h.createImageData(b._renderCanvas.width,b._renderCanvas.height);
c=new Uint8ClampedArray(c);f.data.set(c);h.putImageData(f,0,0)}else 32768>l&&32768>s?(b._renderCanvas.width=l,b._renderCanvas.height=s,ca(b._renderCanvas,c,e,k,l,s)):(b._renderCanvas.width=Math.min(2*q,c.width),b._renderCanvas.height=Math.min(2*u,c.height),ca(b._renderCanvas,c,e,k,l,s),l=b._renderCanvas.width,s=b._renderCanvas.height),k=e=0;a.save();a.globalAlpha=d;C||(a.imageSmoothingEnabled=!1,a.mozImageSmoothingEnabled=!1,a.webkitImageSmoothingEnabled=!1);a.drawImage(b._renderCanvas,e,k,l,s,g,
A,q,u);a.restore()}function ca(b,a,c,d,C,g){var A=new Uint32Array(a);C||(C=a.width);g||(g=a.height);c||(c=0);d||(d=0);var q=b.width,u=b.height;b=b.getContext("2d");var e=b.createImageData(q,u),k=new ArrayBuffer(e.data.length),l=new Uint8ClampedArray(k),k=new Uint32Array(k);C/=q;g/=u;for(var s=0,h=0,u=s=0;u<k.length;u++)s=Math.round(Math.floor(u%q)*C)+c,h=Math.round(Math.floor(u/q)*g)+d,s=Math.floor(h*a.width+s),k[u]=A[s];e.data.set(l);b.putImageData(e,0,0)}var Y=R("tinycolor2"),$=R("./common"),M=
R("./CanvasInput"),B=R("./m");b.XW_INIT=-3;b.XW_DRAW=1;b.XW_EVENT=2;b.XW_UPDATE=3;b.XW_COMMAND=5;b.SB_EXPAND=1;b.SB_SHRINK=2;b.SB_FULL=3;b.SB_STEPINC=4;b.SB_STEPDEC=5;b.SB_PAGEINC=6;b.SB_PAGEDEC=7;b.SB_DRAG=8;b.SB_WHEELUP=9;b.SB_WHEELDOWN=10;b.L_ArrowLeft=1001;b.L_ArrowRight=1002;b.L_ArrowUp=1003;b.L_ArrowDown=1004;b.L_dashed=801;b.GBorder=3;b.L_RModeOff=900;b.L_RModeOn=901;b.L_PixelSymbol=1;b.L_CircleSymbol=2;b.L_SquareSymbol=3;b.L_PlusSymbol=4;b.L_XSymbol=5;b.L_TriangleSymbol=6;b.L_ITriangleSymbol=
7;b.L_HLineSymbol=8;b.L_VLineSymbol=9;b.LEGACY_RENDER=!1;b.STKSTRUCT=function(){this.y2=this.x2=this.y1=this.x1=this.yscl=this.xscl=this.ymax=this.ymin=this.xmax=this.xmin=0};b.SCROLLBAR=function(){this.repeat_count=this.origin=this.mxevent=this.arrow=this.a2=this.a1=this.soff=this.swmin=this.sw=this.s1=this.h=this.w=this.y=this.x=this.repeat_pause=this.initial_pause=this.dragoutline=this.scale=this.page=this.step=this.trange=this.tmin=this.srange=this.smin=this.action=this.flag=null};b.open=function(p){p=
new m(p);p.wid_canvas.oncontextmenu=function(b){b.preventDefault();return!1};this._ctx=p.active_canvas.getContext("2d");p.onmousemove=function(p){return function(a){var c=a.target.getBoundingClientRect();p.x=a.x||a.clientX;p.y=a.y||a.clientY;p.xpos=void 0===a.offsetX?a.pageX-c.left-window.scrollX:a.offsetX;p.ypos=void 0===a.offsetX?a.pageY-c.top-window.scrollY:a.offsetY;p.warpbox&&(p.warpbox.style=(a.ctrlKey||a.metaKey)&&void 0!==p.warpbox.alt_style?p.warpbox.alt_style:p.warpbox.def_style,b.redraw_warpbox(p));
b.widget_callback(p,a)}}(p);p.onmouseup=function(p){return function(a){if(p.warpbox){b.onWidgetLayer(p,function(){b.erase_window(p)});var c=p.warpbox;p.warpbox=void 0;if((1===a.which||3===a.which)&&c.func){var d=c.xo,g=c.yo,A=c.xl,q=c.yl;"vertical"===c.mode?(d=p.l,A=p.r):"horizontal"===c.mode&&(g=p.t,q=p.b);c.func(a,d,g,A,q,c.style.return_value,c.mode)}}b.widget_callback(p,a)}}(p);p.onmousedown=function(p){return function(a){a.preventDefault();b.widget_callback(p,a);return!1}}(p);p.onkeydown=function(p){return function(a){if(p.warpbox){var c=
$.getKeyCode(a);17!==c&&224!==c&&91!==c&&93!==c||p.warpbox.style===p.warpbox.alt_style||(p.warpbox.style=p.warpbox.alt_style,b.redraw_warpbox(p))}b.widget_callback(p,a)}}(p);p.onkeyup=function(p){return function(a){p.warpbox&&(a=$.getKeyCode(a),17!==a&&224!==a&&91!==a&&93!==a||p.warpbox.style===p.warpbox.def_style||(p.warpbox.style=p.warpbox.def_style,b.redraw_warpbox(p)))}}(p);p.ontouchend=function(b){return function(p){b.onmouseup({which:1})}}(p);p.ontouchmove=function(p){return function(a){var c=
p.canvas,d=0,g=0;if(void 0!==c.offsetParent){do d+=c.offsetLeft,g+=c.offsetTop;while(c=c.offsetParent)}p.xpos=a.targetTouches[0].pageX-d;p.ypos=a.targetTouches[0].pageY-g;b.redraw_warpbox(p)}}(p);b.enableListeners(p);return p};b.enableListeners=function(p){b.addEventListener(p,"mousemove",p.onmousemove,!1);window.addEventListener("mouseup",p.onmouseup,!1);b.addEventListener(p,"mousedown",p.onmousedown,!1);window.addEventListener("keydown",p.onkeydown,!1);window.addEventListener("keyup",p.onkeyup,
!1)};b.disableListeners=function(p){b.removeEventListener(p,"mousemove",p.onmousemove,!1);window.removeEventListener("mouseup",p.onmouseup,!1);b.removeEventListener(p,"mousedown",p.onmousedown,!1);window.removeEventListener("keydown",p.onkeydown,!1);window.removeEventListener("keyup",p.onkeyup,!1)};b.addEventListener=function(b,a,c,d){return b.wid_canvas.addEventListener(a,c,d)};b.removeEventListener=function(b,a,c,d){return b.wid_canvas.removeEventListener(a,c,d)};b.dispatchEvent=function(b,a){return b.wid_canvas.dispatchEvent(a)};
b.onWidgetLayer=function(p,a){b.onCanvas(p,p.wid_canvas,a)};b.onCanvas=function(b,a,c){var d=b.active_canvas;b.active_canvas=a;try{if(c)return c()}finally{b.active_canvas=d}};b.withWidgetLayer=function(p,a){return function(){b.onWidgetLayer(p,a)}};b.render=function(b,a){if(a){var c=b.active_canvas;c._animationFrameHandle||(c._animationFrameHandle=requestAnimFrame(function(){c._animationFrameHandle=void 0;a()}))}};b.fullscreen=function(p,a){void 0===a&&(a=!p.fullscreen);a?(p.fullscreen={position:p.root.style.position,
height:p.root.style.height,width:p.root.style.width,left:p.root.style.left,top:p.root.style.top,zIndex:p.root.style.zIndex},p.root.style.position="fixed",p.root.style.height="100%",p.root.style.width="100%",p.root.style.left="0px",p.root.style.top="0px",p.root.style.zIndex=16777271):(p.root.style.position=p.fullscreen.position,p.root.style.height=p.fullscreen.height,p.root.style.width=p.fullscreen.width,p.root.style.left=p.fullscreen.left,p.root.style.top=p.fullscreen.top,p.root.style.zIndex=p.fullscreen.zIndex,
p.fullscreen=void 0);b.checkresize(p)};b.checkresize=function(b){var a=b.canvas;return a.height!==b.root.clientHeight||a.width!==b.root.clientWidth?(b.height=b.root.clientHeight,b.width=b.root.clientWidth,b.canvas.height=b.height,b.canvas.width=b.width,b.wid_canvas.height=b.height,b.wid_canvas.width=b.width,!0):!1};b.invertbgfg=function(p){b.setbgfg(p,p.fg,p.bg,!p.xi)};b.mixcolor=function(b,a,c){b=Y(b).toRgb();a=Y(a).toRgb();var d=1-c;a.r=b.r*d+a.r*c;a.g=b.g*d+a.g*c;a.b=b.b*d+a.b*c;return Y(a).toHexString(!0)};
b.linear_gradient=function(b,a,c,d,C,g){var A=b.active_canvas.getContext("2d");b=1/g.length;a=A.createLinearGradient(a,c,d,C);for(c=0;c<g.length-1;c++)a.addColorStop(b*c,g[c]);a.addColorStop(1,g[g.length-1]);return a};b.setbgfg=function(p,a,c,d){p.bg=Y(a).toHexString();p.fg=Y(c).toHexString();p.xi=Y(d).toHexString();Y.equals(p.bg,"black")&&Y.equals(p.fg,"white")?(p.xwfg=p.fg,p.xwbg="rgb(35%,35%,30%)",p.xwts="rgb(60%,60%,55%)",p.xwbs="rgb(25%,25%,20%)",p.xwms=b.mixcolor(p.xwts,p.xwbs,0.5),p.xwlo="rgb(15%,15%,10%)",
p.hi=p.xwts):Y.equals(p.bg,"white")&&Y.equals(p.fg,"black")?(p.xwfg=p.fg,p.xwbg="rgb(60%,60%,55%)",p.xwts="rgb(80%,80%,75%)",p.xwbs="rgb(40%,40%,35%)",p.xwms=b.mixcolor(p.xwts,p.xwbs,0.5),p.xwlo="rgb(70%,70%,65%)",p.hi=p.xwbs):(a=Y(p.bg).toRgb(),127.5<Math.sqrt(0.299*a.r*a.r+0.587*a.g*a.g+0.114*a.b*a.b)?(p.xwfg="black",p.xwbg="rgb(60%,60%,55%)",p.xwts="rgb(80%,80%,75%)",p.xwbs="rgb(40%,40%,35%)",p.xwms=b.mixcolor(p.xwts,p.xwbs,0.5),p.xwlo="rgb(70%,70%,65%)",p.hi=p.xwts):(p.xwfg="white",p.xwbg="rgb(35%,35%,30%)",
p.xwts="rgb(60%,60%,55%)",p.xwbs="rgb(25%,25%,20%)",p.xwms=b.mixcolor(p.xwts,p.xwbs,0.5),p.xwlo="rgb(15%,15%,10%)",p.hi=p.xwbs))};b.settheme=function(b,a){b.bg=a.bg;b.fg=a.fg;b.xi=a.xi;b.xwfg=a.xwfg;b.xwbg=a.xwbg;b.xwts=a.xwts;b.xwbs=a.xwbs;b.xwlo=a.xwlo;b.hi=a.hi};b.close=function(b){var a=b.wid_canvas;a.removeEventListener("mousemove",b.onmousemove,!1);a.removeEventListener("mouseup",b.onmouseup,!1);b.parent&&b.parent.parentNode&&b.parent.parentNode.removeChild(b.parent)};b.scrollbar=function(p,
a,c,d,C,g,A,q,u,e,k){var l,s,h,f=0,n=new b.SCROLLBAR;l=void 0!==a.flag?a.flag:a;s=Math.abs(l);h=g-C>d-c?3>p.origin?2:4:p.origin&2?3:1;10>s&&(a=n);if(10>s||0===a.action)b.scroll(p,a,b.XW_INIT,void 0,k),a.flag=l,a.initial_pause=-1,b.scroll_loc(a,c,C,d-c+1,g-C+1,h,k);a.srange=A.pe-A.ps;switch(s){case 0:c=d=C=1;break;case 1:case 11:c=d=0.9*a.srange;C=2;break;case 2:case 12:c=0.1*a.srange;d=9*c;C=2;break;case 3:case 13:c=1;d=a.srange-1;C=1;break;default:return 0}b.scroll_vals(a,A.ps,a.srange,q,u-q,c,d,
C,k);0===l?b.scroll(p,a,b.XW_DRAW,void 0,void 0):b.scroll(p,a,b.XW_EVENT,e,k)&&(A.ps!==a.smin&&(A.ps=a.smin,f+=1),A.pe!==a.smin+a.srange&&(A.pe=a.smin+a.srange,f+=2));return f};b.scroll=function(a,c,d,v,C){var g;if(void 0===c)return!1;switch(d){case b.XW_INIT:b.scroll_loc(c,0,0,a.width,20,1,C);b.scroll_vals(c,0,10,0,100,1,10,1,C);c.flag=0;c.action=0;c.initial_pause=0.25;c.repeat_pause=0.05;c.mxevent=!0;c.repeat_count=0;break;case b.XW_EVENT:g=0;if(c.mxevent)g=a.button_release?-a.button_release:a.button_press;
else if("mousedown"===v.type||"mouseup"===v.type){switch(v.which){case 1:g=1;break;case 2:g=2;break;case 3:g=3;break;case 4:g=4;break;case 5:g=5}"mouseup"===v.type&&(g=-g)}else if("mousewheel"===v.type||"DOM-MouseScroll"===v.type)v.wheelDelta&&0<v.wheelDelta?g=4:v.wheelDelta&&0>v.wheelDelta&&(g=5);if(0===c.action){if(4===g||5===g)a.xpos=c.x;if(1!==g&&2!==g&&4!==g&&5!==g||a.xpos<c.x||a.ypos<c.y||a.xpos>c.x+c.w||a.ypos>c.y+c.h)return!1}else if(0>g){c.action=c.repeat_count=0;break}c.origin&1?(v=a.xpos-
c.x,c.origin&2&&(v=c.w-v)):(v=a.ypos-c.y,2>=c.origin&&(v=c.h-v));if(0===c.action){c.repeat_count=0;var A=b.scroll_real2pix(c);c.s1=C.s1=A.s1;c.sw=C.sw=A.sw;c.soff=C.soff=v-c.s1;if(0===c.trange)c.smin=C.smin=c.tmin,c.srange=C.srange=0;else switch(g){case 1:c.action=v>c.a1&&v<c.a2?0<c.soff?b.SB_PAGEINC:b.SB_PAGEDEC:0<c.soff?b.SB_STEPINC:b.SB_STEPDEC;break;case 4:c.action=b.SB_WHEELUP;break;case 5:c.action=b.SB_WHEELDOWN;break}}else switch(c.action){case b.SB_WHEELUP:case b.SB_WHEELDOWN:case b.SB_EXPAND:case b.SB_SHRINK:case b.SB_FULL:c.action=
c.repeat_count=0}case b.XW_COMMAND:g=c.smin;v=c.srange;switch(c.action){case b.SB_STEPINC:g+=c.step;break;case b.SB_STEPDEC:g-=c.step;break;case b.SB_PAGEINC:g+=c.page;break;case b.SB_PAGEDEC:g-=c.page;break;case b.SB_FULL:g=c.tmin;v=c.trange;break;case b.SB_EXPAND:v*=c.scale;g=0>=g&&0<=g+c.srange?g*c.scale:g-(v-c.srange)/2;break;case b.SB_SHRINK:v/=c.scale;g=0>g&&0<=g+c.srange?g+v/c.scale:0===g&&0<=g+c.srange?v/c.scale:g+(c.srange-v)/2;break;case b.SB_WHEELUP:g-=c.page;break;case b.SB_WHEELDOWN:g+=
c.page}0<c.trange?(g=Math.max(c.tmin,Math.min(g,c.tmin+c.trange-v)),v=Math.min(v,c.trange)):(g=Math.min(c.tmin,Math.max(g,c.tmin+c.trange-v)),v=Math.max(v,c.trange));c.smin===g&&c.srange===v?c.action!==b.SB_DRAG&&(c.action=c.repeat_count=0):(c.smin=C.smin=g,c.srange=C.srange=v,c.repeat_count++);d===b.XW_COMMAND&&(b.scroll(a,c,b.XW_UPDATE,void 0),c.action=0);break;case b.XW_DRAW:case b.XW_UPDATE:b.redrawScrollbar(c,a,d)}return!0};b.scroll_loc=function(a,c,d,v,C,g,A){void 0!==a&&(a.x=A.x=c,a.y=A.y=
d,a.w=A.w=v,a.h=A.h=C,a.origin=A.origin=Math.max(1,Math.min(4,g)),a.origin&1?(a.a2=A.a2=a.w,a.arrow=A.arrow=Math.min(B.trunc((a.w-B.trunc(2*b.GBorder))/3),a.h+b.GBorder)):(a.a2=A.a2=a.h,a.arrow=A.arrow=Math.min(B.trunc((a.h-B.trunc(2*b.GBorder))/3),a.w+b.GBorder)),a.a1=A.a1=a.arrow+b.GBorder,a.a2-=a.arrow+b.GBorder,A.a2-=a.arrow+b.GBorder,a.swmin=A.swmin=Math.min(10,a.a2-a.a1),a.s1=A.s1=0,a.sw=A.sw=0,a.action=A.action=0)};b.scroll_vals=function(b,a,c,d,C,g,A,q,u){void 0!==b&&(b.smin=u.smin=a,b.srange=
u.srange=c,b.tmin=u.tmin=d,b.trange=u.trange=C,b.step=u.step=g,b.page=u.page=A,b.scale=u.scale=Math.max(q,1))};b.draw_symbol=function(a,c,d,v,C,g,A){for(var q=a.active_canvas.getContext("2d"),u=0,e=0,k=0,l=!1,s=[],e=0;4>e;e++)s[e]={x:0,y:0};e="";l=0>g;u=Math.abs(g);e=2*u;q.fillStyle=c;q.strokeStyle=c;if("function"===typeof C)C(q,A,d,v);else switch(C){case b.L_CircleSymbol:q.beginPath();l?(q.arc(d,v,u,0,360),q.fill()):(q.arc(d,v,u,0,360),q.stroke());break;case b.L_SquareSymbol:l?q.fillRect(d-u,v-u,
e,e):q.strokeRect(d-u,v-u,e,e);break;case b.L_PixelSymbol:q.beginPath();q.arc(d,v,1,0,2*Math.PI,!0);q.fill();break;case b.L_ITriangleSymbol:u=-u;case b.L_TriangleSymbol:e=B.trunc(1.5*u);k=B.trunc(0.8*u);s[1].x=-k;s[1].y=e;s[2].x=2*k;s[2].y=0;s[3].x=-k;s[3].y=-e;a=[];for(e=0;4>e;e++)a[e]={x:0,y:0};l?(a[0].x=d,a[0].y=v-u,a[1].x=a[0].x+s[1].x,a[1].y=a[0].y+s[1].y,a[2].x=a[1].x+s[2].x,a[2].y=a[1].y+s[2].y,a[3].x=a[2].x+s[3].x,a[3].y=a[2].y+s[3].y,z(q,a)):(a[0].x=d,a[0].y=v-u,a[1].x=a[0].x+s[1].x,a[1].y=
a[0].y+s[1].y,a[2].x=a[1].x+s[2].x,a[2].y=a[1].y+s[2].y,a[3].x=a[2].x+s[3].x,a[3].y=a[2].y+s[3].y,r(q,a,void 0),q.stroke(),q.closePath());break;case b.L_PlusSymbol:f(q,d,v+u,d,v-u);f(q,d+u,v,d-u,v);break;case b.L_HLineSymbol:f(q,d+u,v,d-u,v);break;case b.L_VLineSymbol:f(q,d,v+u,d,v-u);break;case b.L_XSymbol:f(q,d-u,v-u,d+u,v+u);f(q,d+u,v-u,d-u,v+u);break;default:e=C,u=B.trunc(a.text_w/2),l&&q.fillText(e.substring(0,2),d-u,v+u)}};b.draw_symbols=function(a,c,d,v,C,g,e,q){for(var u=0;u<C;u++)b.draw_symbol(a,
c,d[u],v[u],g,e,u+q)};b.trace=function(p,c,d,v,C,g,e,q,u,h,k){if(void 0===d||void 0===v)throw"mx.trace requires xpoint and ypoint";void 0===e&&(e=1);void 0===q&&(q=1);void 0===u&&(u=0);void 0===h&&(h=0);void 0===k&&(k={});if(0>=C)B.log.warn("No points to draw");else if(0===q&&0===u)B.log.warn("No line or symbol to draw");else{var l;k.dashed&&(l={mode:"dashed",on:4,off:4});var s=b.origin(p.origin,4,p.stk[p.level]);if(0!==s.xscl&&0!==s.yscl){var f=s.x1,m=s.y1,w=s.xmin,r=1/s.xscl,G=s.ymin,x=1/s.yscl;
k.noclip||b.clip(p,f,m,s.x2-f+1,s.y2-m+1);var J=Math.abs(s.xmax-s.xmin),U=Math.abs(s.ymax-s.ymin),H=Math.min(s.xmin,s.xmax),s=Math.min(s.ymin,s.ymax),t=H+J,ba=s+U,V=4*Math.ceil(2*d.length),Z=new Int32Array(new ArrayBuffer(V)),V=new Int32Array(new ArrayBuffer(V)),N=0;if(0===q&&0!==u)for(var Q=e-1;Q<C;Q+=e){var y=d[Q],O=v[Q],da=y>=H&&y<=t&&O>=s&&O<=ba;da&&(Z[0]=Math.round((y-w)*r)+f,V[0]=Math.round((O-G)*x)+m,b.draw_symbol(p,c,Z[0],V[0],u,h,g+Q))}else if(!0===k.vertsym&&0!==u)for(Q=e-1;Q<C;Q+=e)y=d[Q],
O=v[Q],y>=H&&y<=t&&(q=Math.round((y-w)*r)+f,b.draw_line(p,c,q,0,q,p.height),O>=s&&O<=ba&&(Z[0]=q,V[0]=Math.round((O-G)*x)+m,b.draw_symbol(p,c,Z[0],V[0],u,h,g+Q)));else if(!0===k.horzsym&&0!==u)for(Q=e-1;Q<C;Q+=e)y=d[Q],O=v[Q],O>=s&&O<=ba&&(q=Math.round((O-G)*x)+m,b.draw_line(p,c,0,q,p.width,q),y>=H&&y<=t&&(Z[0]=Math.round((y-w)*r)+f,V[0]=q,b.draw_symbol(p,c,Z[0],V[0],u,h,g+Q)));else if(0!==q){var S;if(k&&k.highlight){S=[];for(Q=0;Q<k.highlight.length;Q++)if(!(k.highlight[Q].xstart>=t||k.highlight[Q].xend<=
H)&&(y=Math.max(k.highlight[Q].xstart,H),O=Math.min(k.highlight[Q].xend,t),y<O)){y=Math.round((y-w)*r)+f;O=Math.round((O-w)*r)+f;for(J=S.length-1;0<=J;J--)y<=S[J].start&&O>=S[J].end?S.splice(J,1):(y>=S[J].start&&O<=S[J].end?(S.push({start:O,end:S[J].end,color:S[J].color}),S[J].end=y):y<=S[J].start&&O>=S[J].start?S[J].start=O:y<=S[J].end&&O>=S[J].end&&(S[J].end=y),S[J].end<=S[J].start&&S.splice(J,1));S.push({start:y,end:O,color:k.highlight[Q].color})}S.push({start:f,color:c});S.sort(function(b,a){return b.start-
a.start})}else S=c;var z,E=(p.stk[p.level].xmax+p.stk[p.level].xmin)/2,D=(p.stk[p.level].ymax+p.stk[p.level].ymin)/2,y=d[0],O=v[0];z=a(0,E,D,p.stk[p.level].xmin,p.stk[p.level].ymin,y,O);(da=y>=H&&y<=t&&O>=s&&O<=ba)?(Z[N]=Math.round((y-w)*r)+f,V[N]=Math.round((O-G)*x)+m,N+=1,0!==u&&b.draw_symbols(p,c,Z,V,1,u,h,g)):N=0;for(var L=0,T=!1,Q=e;Q<=e*(C-1);Q+=e)if(J=y,U=O,y=d[Q],O=v[Q],z=a(z,E,D,J,U,y,O),T=y>=H&&y<=t&&O>=s&&O<=ba,da&&T)Z[N]=Math.round((y-w)*r)+f,V[N]=Math.round((O-G)*x)+m,N+=1;else if(da=
T,J-=y,U-=O,0!==J||0!==U){var I={tL:1,tE:0};n(J,H-y,I)&&n(-J,y-t,I)&&n(U,s-O,I)&&n(-U,O-ba,I)&&(1>I.tL&&(Z[N]=Math.round((y-w+I.tL*J)*r)+f,V[N]=Math.round((O-G+I.tL*U)*x)+m,N+=1),0<I.tE?(Z[N]=Math.round((y-w+I.tE*J)*r)+f,V[N]=Math.round((O-G+I.tE*U)*x)+m,N+=1,b.draw_lines(p,S,Z.subarray(L,N),V.subarray(L,N),N-L,q,l),0!==u&&2<N-L&&b.draw_symbols(p,c,Z.subarray(L+1,N-1),V.subarray(L+1,N-1),N-L-2,u,h,g+Q-(N-L-2)),L=N):(Z[N]=Math.round((y-w)*r)+f,V[N]=Math.round((O-G)*x)+m,N+=1))}z=a(z,E,D,y,O,p.stk[p.level].xmax,
p.stk[p.level].ymin);z=a(z,E,D,p.stk[p.level].xmax,p.stk[p.level].ymin,p.stk[p.level].xmin,p.stk[p.level].ymin);0<N-L&&(b.draw_lines(p,S,Z.subarray(L,N),V.subarray(L,N),N-L,q,l),T&&(L+=1),0!==u&&1<N-L&&b.draw_symbols(p,c,Z.subarray(L-1,N),V.subarray(L-1,N),N-L-1,u,h,Q-N+g));k.fillStyle&&(1<N||0!==z)&&b.fill_trace(p,k.fillStyle,Z,V,N)}k.noclip||b.clip(p,0,0,0,0)}}};b.draw_mode=function(b,a,c){b.linewidth=void 0===a?1:a;b.style=c};b.draw_line=function(b,a,c,d,e,g,A,q){var u=b.active_canvas.getContext("2d");
void 0===A&&(A=b.linewidth);void 0===q&&(q=b.style);"number"===typeof a&&(b.pixel&&0!==b.pixel.length?(a=Math.max(0,Math.min(b.pixel.length,a)),a=D(b.pixel[a].red,b.pixel[a].green,b.pixel[a].blue)):(B.log.warn("COLORMAP not initialized, defaulting to foreground"),a=b.fg));f(u,c,d,e,g,q,a,A)};b.rubberline=function(b,a,c,d,e){b=b.active_canvas.getContext("2d");f(b,a,c,d,e,{mode:"xor"},"white",1)};b.fill_trace=function(a,c,d,v,e){var g=a.active_canvas.getContext("2d");Array.isArray(c)?g.fillStyle=b.linear_gradient(a,
0,0,0,a.b-a.t,c):g.fillStyle=c;if(1>e)g.fillRect(a.l,a.t,a.r-a.l,a.b-a.t);else if(c){c=d[0];var A=v[0];g.beginPath();A===a.t?g.lineTo(a.l,a.t):g.lineTo(a.l,a.b);g.lineTo(c,A);for(var q=1;q<e;q++)c=d[q],A=v[q],g.lineTo(c,A);A===a.t&&g.lineTo(a.r,a.t);g.lineTo(a.r,a.b);v[0]===a.t&&g.lineTo(a.l,a.b);g.closePath();g.fill()}};b.draw_lines=function(b,a,c,d,e,g,A){var q=b.active_canvas.getContext("2d");if(!(1>e)){var u=c[0],h=d[0];void 0===g&&(g=b.linewidth);void 0===A&&(A=b.style);A&&"dashed"===A.mode&&
($.dashOn(q,A.on,A.off)||B.log.warn("WARNING: Dashed lines aren't supported on your browser"));q.lineWidth=g;b=0;"string"===typeof a?a=[{start:0,color:a}]:a instanceof Array||(void 0===a.start&&(a.start=0),a=[a]);for(g=0;g<a.length;g++)null!=a[g].end&&a[g].end<u?a.remove(g):a[g].start<u&&(b=g);q.strokeStyle=a[b].color;q.beginPath();q.moveTo(u,h);for(g=0;g<e;g++)if(u!==c[g]||h!==d[g]){u=c[g];h=d[g];A=!1;if(0<b&&null!=a[b].end&&a[b].end<u)for(A=!0;null!=a[b].end&&a[b].end<u&&(a.remove(b),b-=1,0!==b););
if(b+1<a.length&&a[b+1].start<=u)for(A=!0;b+1<a.length&&a[b+1].start<=u;)b++;q.lineTo(u,h);A&&(q.stroke(),q.strokeStyle=a[b].color,q.beginPath(),q.lineTo(u,h))}q.stroke();$.dashOff(q);q.beginPath()}};b.clip=function(b,a,c,d,e){b=b.active_canvas.getContext("2d");0===a&&0===c&&0===d&&0===e?b.restore():(b.save(),b.beginPath(),b.rect(a,c,d,e),b.clip())};b.clear_window=function(b){var a=b.active_canvas.getContext("2d");a.fillStyle=b.bg;a.fillRect(0,0,b.width,b.height)};b.erase_window=function(b){b.active_canvas.getContext("2d").clearRect(0,
0,b.width,b.height)};b.rubberbox=function(a,c,d,v,e){b.warpbox(a,a.xpos,a.ypos,a.xpos,a.ypos,0,a.width,0,a.height,c,d,v,e)};b.warpbox=function(b,a,c,d,C,g,A,q,u,h,k,l,s){l||(l={});b.warpbox=new e;b.warpbox.xo=a;b.warpbox.yo=c;b.warpbox.xl=d;b.warpbox.yl=C;b.warpbox.xmin=g;b.warpbox.xmax=A;b.warpbox.ymin=q;b.warpbox.ymax=u;b.warpbox.func=h;b.warpbox.mode=k;b.warpbox.style=l;b.warpbox.def_style=l;b.warpbox.alt_style=s};b.origin=function(a,c,d){a=Math.max(1,a);c=Math.max(1,c);var v=new b.STKSTRUCT;v.xmin=
d.xmin;v.xmax=d.xmax;v.ymin=d.ymin;v.ymax=d.ymax;v.xscl=d.xscl;v.yscl=d.yscl;v.x1=d.x1;v.y1=d.y1;v.x2=d.x2;v.y2=d.y2;if(a!==c){var e=Math.abs(c-a);a=c+a;if(2===e||5!==a)v.xmin=d.xmax,v.xmax=d.xmin,v.xscl=-d.xscl;if(2===e||5===a)v.ymin=d.ymax,v.ymax=d.ymin,v.yscl=-d.yscl}return v};b.mult=function(b,a){var c=Math.max(Math.abs(b),Math.abs(a));if(0===c)return 1;var d=0.1447648*Math.log(c),d=d|d;1>c&&(d-=1);return 0>d?1/Math.pow(10,-3*d):Math.pow(10,3*d)};b.widget_callback=function(b,a){if(b.prompt&&3===
a.which)b.prompt.input.onsubmit();b.widget&&b.widget.callback(a)};b.prompt=function(a,c,d,v,e,g,A,q,u){if(void 0!==g&&(e=d(g),!e.valid))throw"Prompt default input value not valid due to '"+e.reason+"'";b.onWidgetLayer(a,function(){var e=a.active_canvas.getContext("2d"),k=e.font.indexOf("px"),l=k+3,k=e.font.substr(0,k),e=e.font.substr(l,e.font.length).toString(),e=new M({height:a.text_h,fontFamily:e,fontSize:new Number(k),backgroundColor:a.bg,fontColor:a.fg,borderWidth:0,borderRadius:0,padding:0,boxShadow:"none",
innerShadow:"none",width:30*a.text_w,value:void 0!==g?g.toString():"",disableBlur:!0,renderOnReturn:!1,tabToClear:!0}),s=function(c,k){return function(){var l=this.value(),F=d(l);F.valid?(a.prompt=void 0,this.cleanup(),b.onWidgetLayer(a,function(){b.erase_window(a)}),v(l)):(b.message(a,"Value: '"+l+"' isn't valid due to '"+F.reason+"' - RETRY",void 0,c,k),setTimeout(function(){b.onWidgetLayer(a,function(){b.erase_window(a)});a.widget=null},null!=u?u:4E3))}},l=function(a,c,p){return function(d,k){b.onWidgetLayer(a,
function(){var x=(p.length+2)*a.text_w,J=x+31*a.text_w+6,U=2*a.text_h+6;d||(d=a.xpos);k||(k=a.ypos);var H=Math.max(0,Math.min(d,a.width-J)),t=Math.max(0,Math.min(k,a.height-U)),l=H+3,V=t+3,F=V+1.5*a.text_h,g=l+a.text_w;b.widgetbox(a,H,t,J,U,l,V,0,"");b.text(a,g,F,p);J=F-1.15*a.text_h;c.x(l+a.text_w+x-a.text_w);c.y(J);c.onsubmit(s(H,J-75));c.canvas()?c.render():c.canvas(a.active_canvas)})}}(a,e,c);l(A,q);e.focus();a.prompt={redraw:l,input:e}})};b.floatValidator=function(b,a){return(void 0!==a&&!1!==
a||""!==b)&&isNaN(parseFloat(b))||!isFinite(b)?{valid:!1,reason:"Failed float validation: not a valid floating point number"}:{valid:!0,reason:""}};b.intValidator=function(b,a){return(void 0===a||!1===a)&&""===b||parseFloat(b)===parseInt(b,10)&&!isNaN(b)?{valid:!0,reason:""}:{valid:!1,reason:"Failed integer validation: not a valid integer"}};b.message=function(a,c,d,e,C,g){b.onWidgetLayer(a,function(){b.render_message_box(a,c,e,C);a.widget={type:g||"ONESHOT",callback:function(c){if("mousedown"===
c.type||"keydown"===c.type)a.widget=null,b.onWidgetLayer(a,function(){b.erase_window(a)})}}})};b.render_message_box=function(a,c,d,e,C){var g=c.split(/\r\n|\r|\n/g),h=0,q;if(1===g.length){h=Math.min((a.width-6)/a.text_w-2,c.length);if(0>=h)return;for(;40<h&&2.5*a.text_h*c.length<a.height*h;)h-=5;var u=0,f=0,k=0,l=0,s=0,n=0,g=[];for(q=!0;f<c.length;){for(var s=f+h-1,n=s=Math.min(s,c.length-1),m=!1,u=f;u<=s&&!m;u++)switch(c[u]){case ",":case ";":case " ":case ":":n=u;break;case "-":case "/":n!==u-1&&
(n=u);break;case "@":case "\n":case "\r":q=!1,m=!0,n=u}u===c.length&&(n=s);m?g.push(c.substring(f,n)):(u=c.substring(f,n+1).replace(/^\s+/,""),g.push(u));f=n+1;l=Math.max(l,g[k].length)}}else for(k=0;k<g.length;k++)h=Math.min((a.width-6)/a.text_w-2,Math.max(h,g[k].length));l=g.length;6<l&&(q=!1);u=0;k=Math.max(1,a.height/a.text_h);c=Math.min(l,u+k-1);h=(h+2)*a.text_w+6;l=(c-u+1)*a.text_h+6;d||(d=a.xpos);e||(e=a.ypos);d=Math.max(a.l,Math.min(d,a.r-h));k=Math.max(a.t,Math.min(e,a.b-l));e=d+3;n=k+3;
b.widgetbox(a,d,k,h,l,e,n,0,"");l=n+a.text_h/3;for(k=e+a.text_w;u<c;)l+=a.text_h,q&&(k=d+h/2-g[u].length*a.text_w/2),b.text(a,k,l,g[u],C),u++};b.draw_round_box=function(b,a,c,d,e,g,h,q,u){b=b.active_canvas.getContext("2d");u||(u=5);b.beginPath();b.moveTo(c+u,d);b.lineTo(c+e-u,d);b.quadraticCurveTo(c+e,d,c+e,d+u);b.lineTo(c+e,d+g-u);b.quadraticCurveTo(c+e,d+g,c+e-u,d+g);b.lineTo(c+u,d+g);b.quadraticCurveTo(c,d+g,c,d+g-u);b.lineTo(c,d+u);b.quadraticCurveTo(c,d,c+u,d);b.closePath();b.lineWidth=1;b.strokeStyle=
a;b.stroke();void 0!==h&&0<h&&(c=b.globalAlpha,b.globalAlpha=h,b.fillStyle=q?q:a,b.fill(),b.globalAlpha=c)};b.draw_box=function(b,a,c,d,e,g,h,q){var u=b.active_canvas.getContext("2d");if("xor"!==a)u.lineWidth=1,u.strokeStyle=a,u.strokeRect(c,d,e,g);else if("undefined"===typeof Uint8ClampedArray)u.lineWidth=1,u.strokeStyle=b.fg,u.strokeRect(c,d,e,g);else{c=Math.floor(c);d=Math.floor(d);e=Math.floor(e);g=Math.floor(g);b=b.canvas.getContext("2d");for(var f=b.getImageData(c,d,e,1),k=f.data,l=0;l<f.data.length;l++)k[4*
l]=255-k[4*l],k[4*l+1]=255-k[4*l+1],k[4*l+2]=255-k[4*l+2],k[4*l+3]=255;u.putImageData(f,c,d);f=b.getImageData(c,d+g,e,1);k=f.data;for(l=0;l<f.data.length;l++)k[4*l]=255-k[4*l],k[4*l+1]=255-k[4*l+1],k[4*l+2]=255-k[4*l+2],k[4*l+3]=255;u.putImageData(f,c,d+g);f=b.getImageData(c,d,1,g);k=f.data;for(l=0;l<g;l++)k[4*l]=255-k[4*l],k[4*l+1]=255-k[4*l+1],k[4*l+2]=255-k[4*l+2],k[4*l+3]=255;u.putImageData(f,c,d);f=b.getImageData(c+e,d,1,g);k=f.data;for(l=0;l<g;l++)k[4*l]=255-k[4*l],k[4*l+1]=255-k[4*l+1],k[4*
l+2]=255-k[4*l+2],k[4*l+3]=255;u.putImageData(f,c+e,d)}void 0!==h&&0<h&&(b=u.globalAlpha,u.globalAlpha=h,u.fillStyle=q?q:a,u.fillRect(c+1,d+1,e-1,g-1),u.globalAlpha=b)};b.set_font=function(b,a){var c=b.canvas.getContext("2d"),d=b.wid_canvas.getContext("2d");if(b.font&&b.font.width===a)c.font=b.font.font,d.font=b.font.font;else{var e=1;do{e+=1;c.font=e+"px "+b.font_family;d.font=e+"px "+b.font_family;var g=c.measureText("M");b.text_w=g.width;b.text_h=e}while(b.text_w<a);b.font={font:e+"px "+b.font_family,
width:a}}};b.textline=function(b,a,c,d,e,g){var h=b.active_canvas.getContext("2d");g||(g={});g.color||(g.color=b.fg);g.width||(g.width=1);f(h,a,c,d,e,g,g.color,g.width)};b.tics=function(b,a,c,d){var e=1,g=b;if(a===b)return{dtic:1,dtic1:b};e=Math.abs(a-b)/c;c=Math.max(e,1E-36);c=Math.log(c)/Math.log(10);0>c?(c=Math.ceil(c),c-=1):c=Math.floor(c);e*=Math.pow(10,-c);c=Math.pow(10,c);g=e*c;d&&5<=g&&5140800>=g?(d=17.5>g?5:37.5>g?15:270>g?60:1050>g?300:2250>g?900:7200>g?3600:16200>g?10800:32400>g?21600:
129600>g?43200:518400>g?86400:604800,e=Math.round(g/d)*d):e=1.75>e?c:2.25>e?2*c:3.5>e?2.5*c:7>e?5*c:10*c;0===e&&(e=1);a>=b?(d=Math.floor(0<=b?b/e+0.995:b/e-0.005),g=d*e):(d=Math.floor(0<=b?b/e+0.005:b/e-0.995),g=d*e,e*=-1);g+e===g&&(e=a-b);return{dtic:e,dtic1:g}};b.drawaxis=function(a,c,d,e,h,g,f){var q=b.origin(c.origin,1,c.stk[c.level]),u=0,n=0,k=0,l=0,s=0,m=0;h=void 0===h?30:h;g=void 0===g?30:g;f.exactbox?(u=Math.floor(q.x1),n=Math.floor(q.y1),k=Math.floor(q.x2),l=Math.floor(q.y2),s=k-u,m=l-n):
(u=Math.max(Math.floor(q.x1)-2,0),n=Math.max(Math.floor(q.y1)-2,0),k=Math.min(Math.floor(q.x2)+2,c.width),l=Math.min(Math.floor(q.y2)+2,c.height),s=k-u-4,m=l-n-4);var w=c.active_canvas.getContext("2d");f.fillStyle?Array.isArray(f.fillStyle)?w.fillStyle=b.linear_gradient(c,0,0,0,l-n,f.fillStyle):w.fillStyle=f.fillStyle:w.fillStyle=c.bg;w.fillRect(u,n,k-u,l-n);f.noaxisbox||(b.textline(c,u,n,k,n),b.textline(c,k,n,k,l),b.textline(c,k,l,u,l),b.textline(c,u,l,u,n));var r={dtic:0,dtic1:0},w={dtic:0,dtic1:0};
0>d?(r.dtic1=q.xmin,r.dtic=(q.xmin-q.xmax)/d):r=b.tics(q.xmin,q.xmax,d,f.xtimecode);var G=1;f.xmult?G=f.xmult:f.xtimecode||(G=b.mult(q.xmin,q.xmax));if(a.x_cut_press_on||a.y_cut_press_on)a=q.ymax,q.ymax=q.ymin,q.ymin=a;0>e?(w.dtic1=q.ymin,w.dtic=(q.ymin-q.ymax)/e):w=b.tics(q.ymin,q.ymax,e,f.ytimecode);a=1;f.ymult?a=f.ymult:f.ytimecode||(a=b.mult(q.ymin,q.ymax));d=!f.noxtlab;e=!f.noytlab;var z=Math.max(0,u-4*c.text_w),x=0,x=f.ontop?Math.min(c.height,Math.floor(l+1.5*c.text_h)):Math.max(c.text_h,Math.floor(n-
0.5*c.text_h)),J,U;0<x&&(f.noyplab||(U=f.ylabel instanceof Function?f.ylabel(g,a):void 0!==f.ylabel?f.ylabel:B.label(g,a)),f.noxplab||(J=f.xlabel instanceof Function?f.ylabel(h,G):void 0!==f.xlabel?f.xlabel:B.label(h,G)));J&&U?b.text(c,z,x,U+" vs "+J):J?b.text(c,z,x,J):U&&b.text(c,z,x,U);h=5.5*c.text_w;g=0;g=f.ontop?f.inside?n+1*c.text_h:n-0.2*c.text_h:f.inside?l-0.5*c.text_h:l+1*c.text_h+2;s=q.xmin!==q.xmax?s/(q.xmax-q.xmin):s/1;G=0!==G?1/G:1;J=Math.min(12,Math.round(s*r.dtic)/c.text_w);U=1;var H=
"";if(d)if(f.xtimecode)H=B.sec2tod(r.dtic1),U=H.length*c.text_w<(k-u)/2;else for(var t,x=r.dtic1;x<=q.xmax;x+=r.dtic){H=b.format_f(x*G,J,J/2);if(H===t){U=0;break}t=H}0===r.dtic&&(r.dtic=q.xmax-r.dtic1+1);z=0;H="";for(x=r.dtic1;x<=q.xmax;x+=r.dtic)if(t=u+Math.round(s*(x-q.xmin))+2,!(t<u)&&(f.grid&&"y"!==f.grid?(f.gridStyle||(f.gridStyle=b.LEGACY_RENDER?{mode:"dashed",on:1,off:3}:{color:c.xwms,mode:"dashed",on:1,off:3}),b.textline(c,t,l,t,n,f.gridStyle)):(b.textline(c,t,l-2,t,l+2),b.textline(c,t,n-
2,t,n+2)),d))if(U){if(H=null,f.xtimecode?t>z&&(H=B.sec2tod(x,!0),z=t+c.text_w*(H.length+1)):(H=b.format_f(x*G,J,J/2),H=y(H,!0)),H){var ba=Math.round(H.length/2)*c.text_w;f.inside&&(t=Math.max(u+ba,t),t=Math.min(k-ba,t));0<=t-ba&&b.text(c,t-ba,g,H)}}else x===r.dtic1&&(f.xtimecode?(H=B.sec2tod(x,!0),f.inside&&(t=Math.floor(Math.max(u+h,t))),b.text(c,t-h,g,H+" +\u0394 "+B.sec2tod(r.dtic))):(H=(r.dtic1*G).toString(),f.inside&&(t=Math.floor(Math.max(u+h,t))),b.text(c,t-h,g,H+" +\u0394 "+r.dtic*G)));h=
f.yonright?f.inside?Math.min(k-6*c.text_w,c.width-5*c.text_w):Math.min(k+c.text_w,c.width-5*c.text_w):f.inside?Math.max(0,u+c.text_w):Math.max(0,Math.floor(u-(c.l-0.5)*c.text_w));g=0.4*c.text_h;s=q.ymin!==q.ymax?-m/(q.ymax-q.ymin):-m/1;G=0!==a?1/a:1;m=q.ymax>=q.ymin?function(b){return b<=q.ymax}:function(b){return b>=q.ymax};for(a=w.dtic1;m(a);a+=w.dtic)t=l+Math.round(s*(a-q.ymin))-2,t>l||(f.grid&&"x"!==f.grid?(f.gridStyle||(f.gridStyle={mode:"dashed",on:1,off:3}),b.textline(c,u,t,k,t,f.gridStyle)):
(b.textline(c,u-2,t,u+2,t),b.textline(c,k-2,t,k+2,t)),!e||f.inside&&(t<n+c.text_h||t>l-2*c.text_h)||(f.ytimecode?(r=B.sec2tod(a),d=t+g-c.text_h,z=r.indexOf("::"),-1!==z&&(d>n&&d<l&&b.text(c,h,d,r.substring(0,z)),z+=1),b.text(c,h,Math.min(l,t+g),r.substring(z+1,z+6)),d=t+g+c.text_h,d>n&&d<l&&"00"!==r.substring(z+7,z+9)&&(r+=".00",b.text(c,h,d,r.substring(z+7,z+12)))):(r=b.format_f(a*G,12,6),r=y(r,f.inside),b.text(c,h,Math.min(l,t+g),r))))};b.inrect=function(b,a,c,d,e,g){return b>=c&&b<=c+e&&a>=d&&
a<=d+g};var I={GBorder:3,sidelab:0,toplab:1,n_show:0};b.menu=function(a,e){var f=1.5*a.text_h;I.n_show=e.items.length;if(e){if(!a.widget){e.x=a.xpos;e.y=a.ypos;e.val=0;e.h=2*I.GBorder+f*I.n_show+I.toplab*(f+I.GBorder)-1;e.y=e.y-((I.toplab+Math.max(1,e.val)-0.5)*f+(1+I.toplab)*I.GBorder)+1;for(var v=e.title.length,n=0,g=0;g<e.items.length;g++){var A=e.items[g],v=Math.max(v,A.text.length);"checkbox"===A.style&&(v+=2);"separator"===A.style&&(v+=2);A.checked&&"checkbox"!==A.style&&(n=f*g)}e.queue=[];
for(f=0;f<I.n_show;f++)e.queue.push(f);e.y-=n;v=(v+2)*a.text_w;e.w=2*I.GBorder+Math.abs(I.sidelab)+v-1;e.x-=e.w/2;a.menu=e;a.widget={type:"MENU",callback:function(g){var f=e,v=f.queue[0],k=f.queue[I.n_show-1];if(void 0===g)d(a,f);else if("mousemove"===g.type){void 0!==f.drag_x&&void 0!==f.drag_y&&2<Math.abs(a.xpos-f.drag_x)&&2<Math.abs(a.ypos-f.drag_y)&&(f.x+=a.xpos-f.drag_x,f.y+=a.ypos-f.drag_y,f.drag_x=a.xpos,f.drag_y=a.ypos);var l=f.x+I.GBorder+Math.max(0,I.sidelab),s=f.w-2*I.GBorder-Math.abs(I.sidelab),
K=1.5*a.text_h,n=f.y+I.GBorder+I.toplab*(K+I.GBorder);for(g=v;g<=k;g++){var v=n+K*g,C=f.items[g];C.selected=!1;b.inrect(a.xpos,a.ypos,l,v,s,K)&&(C.selected=!0)}d(a,f)}else if("mouseup"===g.type)1===g.which?void 0!==f.drag_x&&void 0!==f.drag_y?(f.drag_x=void 0,f.drag_y=void 0):c(a,f):3===g.which&&h(a,f);else if("mousedown"===g.type)g.preventDefault(),1===g.which&&a.xpos>f.x&&a.xpos<f.x+f.w&&a.ypos>f.y&&a.ypos<f.y+1.5*a.text_h&&(f.drag_x=a.xpos,f.drag_y=a.ypos);else if("keydown"===g.type&&a.menu)if(f=
a.menu,g.preventDefault(),g=$.getKeyCode(g),13===g)c(a,f);else if(38===g){for(g=v;g<k;g++)if(C=f.items[g],C.selected){C.selected=!1;void 0!==f.items[g-1]&&(f.items[g-1].selected=!0);break}else g===v&&0!==v?(f.queue.pop(),f.queue.unshift(v-1),d(a,f),f.items[k-1].selected=!0):0===v&&!0===f.items[v].selected&&(d(a,f),f.items[0].selected=!0);d(a,f)}else if(40===g){for(g=v;g<k;g++)if(C=f.items[g],C.selected){C.selected=!1;void 0!==f.items[g+1]&&(f.items[g+1].selected=!0);break}else g===k-1&&(v=k+1,k+1===
f.items.length&&(v=0),f.queue.shift(),f.queue.push(v),f.items[k].selected=!1,f.items[v].selected=!0,d(a,f));d(a,f)}else if(48<=g&&57>=g||65<=g&&90>=g){k=String.fromCharCode(g).toUpperCase();f.keypresses=void 0===f.keypresses?k:f.keypresses+k;for(g=k=0;g<f.items.length;g++)C=f.items[g],C.selected=!1,C.text&&0===C.text.toUpperCase().indexOf(f.keypresses)&&(0===k&&(C.selected=!0),k++);0===k?(f.keypresses=void 0,d(a,f)):1===k?c(a,f):d(a,f)}}}}d(a,e)}};b.widgetbox=function(a,c,d,e,f,g,h,q,u,n){b.shadowbox(a,
c,d,e,f,1,2,"",0.75);n&&(f=n.length,f=Math.min(f,e/a.text_w),f=Math.max(f,1),c+=(e-f*a.text_w)/2,d+=3,b.text(a,c,d+(h-d+0.7*a.text_h)/2,n,a.xwfg));0<q&&0<u&&(d=a.active_canvas.getContext("2d"),b.LEGACY_RENDER?(d.fillStyle=a.bg,d.fillRect(g,h,q,u)):(d.save(),d.globalAlpha=0.1,d.fillStyle=a.bg,d.fillRect(g,h,q,u),d.restore()))};b.text=function(b,a,c,d,e){var g=b.active_canvas.getContext("2d");a=Math.max(0,a);c=Math.max(0,c);if(0>a||0>c)throw"On No!";g.textBaseline="bottom";g.textAlign="left";g.font=
b.font.font;g.fillStyle=void 0===e?b.fg:e;g.fillText(d,a,c)};b.getcolor=function(b,a,c){for(b=0;6>b&&0===a[b+1].pos;b++);for(;c>a[b].pos&&6>b;)b++;if(0===b||c>=a[b].pos)return D(E(a[b].red),E(a[b].green),E(a[b].blue));c=E((c-a[b-1].pos)/(a[b].pos-a[b-1].pos)*100);var d=255-c;return D(a[b].red/100*c+a[b-1].red/100*d,a[b].green/100*c+a[b-1].green/100*d,a[b].blue/100*c+a[b-1].blue/100*d)};b.redraw_warpbox=function(b){b.warpbox&&(b._animationFrameHandle&&cancelAnimFrame(b._animationFrameHandle),b._animationFrameHandle=
requestAnimFrame(function(){w(b)}))};b.format_g=function(a,c,d,e){Math.min(c,d+7);c=Math.abs(a).toString();var f=c.indexOf(".");-1===f&&(c+=".",f=c.length);e=0;var g=c.indexOf("e");-1!==g&&(e=parseInt(c.slice(g+1,c.length),10),c=c.slice(0,g));for(var g=Math.min(d-(c.length-f)+1,d),h=0;h<g;h++)c+="0";if(0!==a)if(1>Math.abs(a))if("0."===c.slice(0,2))for(h=2;h<c.length;h++)if("0"===c[h])e-=1;else{c="0."+c.slice(h,h+d);break}else c=c.slice(0,d+2);else f>d?(e=Math.max(0,f-1),c=c[0]+"."+c.slice(1,d+1)):
c=c.slice(0,d+2);0===e?c+="    ":(d=b.pad(Math.abs(e).toString(),2,"0"),c=0>e?c+"E-"+d:c+"E+"+d);return 0>a?"-"+c:" "+c};b.format_f=function(a,c,d){d=Math.max(Math.min(d,20),0);a=a.toFixed(d).toString();return a=b.pad(a,c+d," ")};b.pad=function(b,a,c){for(;b.length<a;)b=c+b;return b};b.legacy_shadowbox=function(a,c,d,e,f,g,h,q){for(var n=q.length,m=0,k=0,m=0,k=[],l=0;11>l;l++)k[l]={x:0,y:0};l=!(1===h||-1===h);0!==h&&0<b.GBorder&&(m=B.trunc(Math.min(e,f)/3),m=Math.max(1,Math.min(m,b.GBorder)));if(0<
m){k[0].x=k[1].x=c;k[8].x=k[9].x=c+e;k[1].y=k[8].y=d;k[0].y=k[9].y=d+f;switch(g){case b.L_ArrowLeft:k[0].y=k[1].y=d+B.trunc(f/2);c+=2;--e;break;case b.L_ArrowRight:k[8].y=k[9].y=d+B.trunc(f/2);--c;--e;break;case b.L_ArrowUp:k[1].x=k[8].x=c+B.trunc(e/2);d+=2;--f;break;case b.L_ArrowDown:k[0].x=k[9].x=c+B.trunc(e/2),--d,--f}k[2]=k[8];k[10]=k[0];c+=m;d+=m;e-=2*m;f-=2*m}k[4].x=k[5].x=c;k[3].x=k[6].x=c+e;k[3].y=k[4].y=d;k[5].y=k[6].y=d+f;switch(g){case b.L_ArrowLeft:k[4].y=k[5].y=d+B.trunc(f/2);break;
case b.L_ArrowRight:k[3].y=k[6].y=d+B.trunc(f/2);break;case b.L_ArrowUp:k[3].x=k[4].x=c+B.trunc(e/2);break;case b.L_ArrowDown:k[5].x=k[6].x=c+B.trunc(e/2)}k[7]=k[3];g=a.active_canvas.getContext("2d");0<m&&(g.fillStyle=0<h?a.xwts:a.xwbs,z(g,k.slice(0,7)),g.fillStyle=0>h?a.xwts:a.xwbs,z(g,k.slice(5,11)));l&&(g.fillStyle=a.xwbg,z(g,k.slice(3,8)));g.fillStyle=a.xwfg;g.textBaseline="alphabetic";l&&0<n&&(n=Math.min(n,B.trunc(e/a.text_w)),n=Math.max(n,1),m=c+B.trunc((e-n*a.text_w)/2),k=d+B.trunc((f+0.7*
a.text_h)/2),g.fillText(q,m,k))};b.sigplot_shadowbox=function(a,c,d,e,f,g,h,q,n){var m=a.active_canvas.getContext("2d"),k=q.length,l=0>h?a.xwts:a.xwbs;n=n||1;for(var s=[],r=0;11>r;r++)s[r]={x:0,y:0};switch(g){case b.L_ArrowLeft:case b.L_ArrowRight:case b.L_ArrowUp:case b.L_ArrowDown:s=b.chevron(g,c,d,e,f);m.fillStyle=0<h?a.xwts:a.xwbs;z(m,s.slice(0,6));break;default:b.draw_round_box(a,l,c,d,e,f,n,a.xwbg,5,a.xwbs)}m.fillStyle=a.xwfg;m.textBaseline="alphabetic";1!==h&&-1!==h&&0<k&&(k=Math.min(k,B.trunc(e/
a.text_w)),k=Math.max(k,1),c+=B.trunc((e-k*a.text_w)/2),a=d+B.trunc((f+0.7*a.text_h)/2),m.fillText(q,c,a))};b.shadowbox=b.LEGACY_RENDER?b.legacy_shadowbox:b.sigplot_shadowbox;b.chevron=function(a,c,d,e,f,g){var h=Math.min(e,f);g||(g=0.25*h);for(var q=[],n=0;6>n;n++)q[n]={x:0,y:0};var n=B.trunc((e-h)/2+h/4-g/2.828),m=B.trunc((f-h)/2+h/4-g/2.828);switch(a){case b.L_ArrowLeft:q[0].x=c+n;q[0].y=d+B.trunc(h/2);q[1].x=c+n+B.trunc(h/2);q[1].y=d;q[2].x=c+n+B.trunc(h/2+g/1.414);q[2].y=d+B.trunc(g/1.414);q[3].x=
c+n+B.trunc(2*g/1.414);q[3].y=d+B.trunc(h/2);q[4].x=c+n+B.trunc(h/2+g/1.414);q[4].y=d+f-B.trunc(g/1.414);q[5].x=c+n+B.trunc(h/2);q[5].y=d+h;break;case b.L_ArrowRight:q[0].x=c+e-n;q[0].y=d+B.trunc(h/2);q[1].x=c+e-n-B.trunc(h/2);q[1].y=d;q[2].x=c+e-n-B.trunc(h/2+g/1.414);q[2].y=d+B.trunc(g/1.414);q[3].x=c+e-n-B.trunc(2*g/1.414);q[3].y=d+B.trunc(h/2);q[4].x=c+e-n-B.trunc(h/2+g/1.414);q[4].y=d+f-B.trunc(g/1.414);q[5].x=c+e-n-B.trunc(h/2);q[5].y=d+h;break;case b.L_ArrowUp:q[0].x=c+B.trunc(h/2);q[0].y=
d+m;q[1].x=c;q[1].y=d+m+B.trunc(h/2);q[2].x=c+B.trunc(g/1.414);q[2].y=d+m+B.trunc(h/2+g/1.414);q[3].x=c+B.trunc(h/2);q[3].y=d+m+B.trunc(2*g/1.414);q[4].x=c+e-B.trunc(g/1.414);q[4].y=d+m+B.trunc(h/2+g/1.414);q[5].x=c+h;q[5].y=d+m+B.trunc(h/2);break;case b.L_ArrowDown:q[0].x=c+B.trunc(h/2),q[0].y=d+f-m,q[1].x=c,q[1].y=d+f-m-B.trunc(h/2),q[2].x=c+B.trunc(g/1.414),q[2].y=d+f-m-B.trunc(h/2+g/1.414),q[3].x=c+B.trunc(h/2),q[3].y=d+f-m-B.trunc(2*g/1.414),q[4].x=c+e-B.trunc(g/1.414),q[4].y=d+f-m-B.trunc(h/
2+g/1.414),q[5].x=c+h,q[5].y=d+f-m-B.trunc(h/2)}return q};b.ifevent=function(b,a){b.button_press=0;b.button_release=0;b.state_mask=0;var c=a.target.getBoundingClientRect(),d=void 0===a.offsetX?a.pageX-c.left-window.scrollX:a.offsetX,c=void 0===a.offsetX?a.pageY-c.top-window.scrollY:a.offsetY;switch(a.type){case "mousedown":b.xpos=G(d,0,b.width);b.ypos=G(c,0,b.height);switch(a.which){case 1:b.button_press=1;break;case 2:b.button_press=2;break;case 3:b.button_press=3;break;case 4:b.button_press=4;break;
case 5:b.button_press=5}break;case "mouseup":switch(b.xpos=G(d,0,b.width),b.ypos=G(c,0,b.height),a.which){case 1:b.button_release=1;break;case 2:b.button_release=2;break;case 3:b.button_release=3;break;case 4:b.button_release=4;break;case 5:b.button_release=5}}};b.scroll_real2pix=function(b){if(0===b.range)return{s1:b.a1,sw:b.a2-b.a1};var a,c;a=(b.a2-b.a1)/b.trange;c=b.a1+Math.floor(0.5+(b.smin-b.tmin)*a);a=c+Math.floor(0.5+b.srange*a);c=c>b.a2-b.swmin?b.a2-b.swmin:Math.max(c,b.a1);a=a<b.a1+b.swmin?
b.a1+b.swmin:Math.min(a,b.a2);return{s1:c,sw:Math.max(a-c,b.swmin)}};b.redrawScrollbar=function(a,c,d){var e,f,g,h,q,n,m,k,l=c.active_canvas.getContext("2d");f=b.scroll_real2pix(a);m=f.s1;k=f.sw;n=m;f=a.x;g=a.y;h=a.w;q=a.h;a.origin&1?(e=g+q/2,a.origin&2&&(n=h-n-k),d===b.XW_DRAW&&(d=a.arrow,b.shadowbox(c,f,g,d,q-1,b.L_ArrowLeft,2,"",0),b.shadowbox(c,f+h-d,g,d-1,q,b.L_ArrowRight,2,"",0)),b.LEGACY_RENDER?(b.draw_line(c,c.fg,f+a.a1,e,f+a.a2,e),b.shadowbox(c,f+n,g,k+1,q,1,2,"",0)):(d=l.createLinearGradient(f+
a.a1,0,f+a.a2,0),d.addColorStop(0,c.xwbs),d.addColorStop(0.5,c.xwts),d.addColorStop(1,c.xwbs),b.draw_line(c,d,f+a.a1,e,f+a.a2,e,1),d=l.createLinearGradient(0,g,0,g+q),d.addColorStop(0.1,c.xwts),d.addColorStop(0.75,c.xwbs),b.draw_round_box(c,c.xwbg,f+n,g,k+1,q,1,d,8,c.xwbs))):(e=f+B.trunc(h/2),2>=a.origin&&(n=q-n-k),d===b.XW_DRAW&&(d=a.arrow,b.shadowbox(c,f,g,h-1,d,b.L_ArrowUp,2,"",0),b.shadowbox(c,f,g+q-d,h-1,d,b.L_ArrowDown,2,"",0)),b.LEGACY_RENDER?(b.draw_line(c,c.fg,e,g+a.a1,e,g+a.a2),b.shadowbox(c,
f,g+n,h,k+1,1,2,"",0)):(d=l.createLinearGradient(0,g+a.a1,0,g+a.a2),d.addColorStop(0,c.xwbs),d.addColorStop(0.5,c.xwts),d.addColorStop(1,c.xwbs),b.draw_line(c,d,e,g+a.a1,e,g+a.a2,1),d=l.createLinearGradient(f,0,f+h,0),d.addColorStop(0.1,c.xwts),d.addColorStop(0.75,c.xwbs),b.draw_round_box(c,c.xwbg,f-1,g+n,h,k+1,1,d,8,c.xwbs)));a.s1=m;a.sw=k};b.real_to_pixel=function(a,c,d,e){a=b.origin(a.origin,4,a.stk[a.level]);if(0===a.xscl||0===a.yscl)return{x:0,y:0};var f=a.x1,g=a.y1,h=a.xmin,q=1/a.xscl,n=a.ymin,
m=1/a.yscl,k=!1,l=!1;null!==c&&(k=c>a.xmax||c<a.xmin,e&&(c=Math.min(c,a.xmax),c=Math.max(c,a.xmin)),c=Math.round((c-h)*q)+f);null!==d&&(l=d>a.ymin||d<a.ymax,e&&(d=Math.min(d,a.ymin),d=Math.max(d,a.ymax)),d=Math.round((d-n)*m)+g);c=Math.round(c);d=Math.round(d);return{x:c,y:d,clipped_x:k,clipped_y:l,clipped:k||l}};b.pixel_to_real=function(b,a,c){a=Math.min(b.r,Math.max(b.l,a));c=Math.min(b.b,Math.max(b.t,c));var d=b.level;return{x:2!==b.origin&&3!==b.origin?b.stk[d].xmin+(a-b.stk[d].x1)*b.stk[d].xscl:
b.stk[d].xmin+(b.stk[d].x2-a)*b.stk[d].xscl,y:2<b.origin?b.stk[d].ymin+(c-b.stk[d].y1)*b.stk[d].yscl:b.stk[d].ymin+(b.stk[d].y2-c)*b.stk[d].yscl}};b.colormap=function(b,a,c){b.pixel=Array(c);for(var d=Array(c),e=100/(Math.max(2,c)-1),f=0;f<c;f++)d[f]=e*f+0.5;for(e=0;6>e&&0===a[e+1].pos;e++);for(f=0;f<c;f++){b.pixel[f]=0;for(var h=d[f];6>e&&Math.floor(h)>a[e].pos;)e++;if(0===e||h>=a[e].pos)b.pixel[f]={red:E(a[e].red),green:E(a[e].green),blue:E(a[e].blue)};else{var h=E((h-a[e-1].pos)/(a[e].pos-a[e-
1].pos)*100),q=255-h;b.pixel[f]={red:a[e].red/100*h+a[e-1].red/100*q,green:a[e].green/100*h+a[e-1].green/100*q,blue:a[e].blue/100*h+a[e-1].blue/100*q}}}};b.colorbar=function(a,c,d,e,f){for(var g=1;g<f;g++)b.draw_line(a,Math.floor(a.pixel.length*(g-1)/f),c,d+f-g,c+e,d+f-g);b.draw_box(a,a.fg,c+0.5,d,e,f)};var X="undefined"===typeof Uint8ClampedArray?L:T;b.shift_image_rows=function(b,a,c){b=new Uint32Array(a);0<c?(c*=a.width,b.set(b.subarray(0,b.length-c),c)):0>c&&(c=Math.abs(c)*a.width,b.set(b.subarray(c)));
return a};b.update_image_row=function(b,a,c,d,e,f,h){d=new Uint32Array(a,d*a.width*4,a.width);var q=1;f!==e&&(q=b.pixel.length/Math.abs(f-e));f=Math.max(1,c.length/a.width);for(var n=0;n<a.width;n++){var m=Math.floor(n*f),k=c[m];if(1<f)if(1===h){for(var l=1;l<f;l++)k+=c[m+l];k/=f}else if(2===h)for(l=1;l<f;l++)k=Math.min(k,c[m+l]);else if(3===h)for(l=1;l<f;l++)k=Math.max(k,c[m+l]);else if(4===h)k=c[n];else if(5===h)for(l=1;l<f;l++)k=Math.max(Math.abs(k),Math.abs(c[m+l]));m=Math.floor((k-e)*q);m=Math.max(0,
Math.min(b.pixel.length-1,m));(m=b.pixel[m])&&(d[n]=-16777216|m.blue<<16|m.green<<8|m.red)}return d};b.create_image=function(a,c,d,e,f,g,h,q){a.active_canvas.getContext("2d");a.pixel&&0!==a.pixel.length||(B.log.warn("COLORMAP not initialized, defaulting to foreground"),b.colormap(a,B.Mc.colormap[1].colors,16));var n=1;h!==g&&(n=a.pixel.length/Math.abs(h-g));e=Math.ceil(e);f=Math.ceil(f);h=new ArrayBuffer(e*f*4);h.width=e;h.height=f;var m=Math.max(1,d/e),k=new Uint32Array(h);if(c)for(var l=0;l<k.length;l++){var s=
(3===a.origin||4===a.origin?Math.floor(l/e):f-Math.floor(l/e)-1)*d+Math.floor((1===a.origin||4===a.origin?Math.floor(l%e):e-Math.floor(l%e)-1)*m),r=c[s];if(1<m)if(1===q){for(var w=1;w<m;w++)r+=c[s+w];r/=m}else if(2===q)for(w=1;w<m;w++)r=Math.min(r,c[s+w]);else if(3===q)for(w=1;w<m;w++)r=Math.max(r,c[s+w]);else if(4===q)r=c[s];else if(5===q)for(w=1;w<m;w++)r=Math.max(Math.abs(r),Math.abs(c[s+w]));s=Math.floor((r-g)*n);s=Math.max(0,Math.min(a.pixel.length-1,s));(s=a.pixel[s])&&(k[l]=-16777216|s.blue<<
16|s.green<<8|s.red)}return h};b.put_image=function(a,c,d,e,f,g,h,q,n,m,k){n=a.active_canvas.getContext("2d");a.pixel&&0!==a.pixel.length||(B.log.warn("COLORMAP not initialized, defaulting to foreground"),b.colormap(a,B.Mc.colormap[1].colors,16));d=Math.floor(0<f?d*f:-f);e=Math.floor(e*g);g=new ArrayBuffer(d*e*4);g.width=d;g.height=e;f=new Uint32Array(g);for(var l=0;l<f.length;l++){var s=Math.max(0,c[l]),s=Math.min(a.pixel.length-1,s);(s=a.pixel[s])&&(f[l]=-16777216|s.blue<<16|s.green<<8|s.red)}X(a,
n,g,m,k,h,q,d,e);return g};b.draw_image=function(a,c,d,e,f,g,h,q){var n=Math.max(d,a.stk[a.level].xmin),m=Math.min(f,a.stk[a.level].xmax),k=Math.max(e,a.stk[a.level].ymin),l=Math.min(g,a.stk[a.level].ymax);if(!(1>=c.width||0===Math.abs(f-d)||1>=c.height||0===Math.abs(g-e))){f=c.width/(f-d);var s=c.height/(g-e),n=Math.floor(n*f)/f,m=Math.ceil(m*f)/f,k=Math.floor(k*s)/s,l=Math.ceil(l*s)/s,r,w,y,G,z,x;1===a.origin?(y=Math.max(0,Math.floor((g-l)*s)),x=Math.min(c.height-y,Math.floor((l-k)*s)),G=Math.max(0,
Math.floor((n-d)*f)),z=Math.min(c.width-G,Math.floor((m-n)*f)),r=b.real_to_pixel(a,n,l),w=b.real_to_pixel(a,m,k)):2===a.origin?(y=Math.max(0,Math.floor((g-l)*s)),x=Math.min(c.height-y,Math.floor((l-k)*s)),G=Math.max(0,Math.ceil((n-d)*f)),z=Math.min(c.width-G,Math.floor((m-n)*f)),r=b.real_to_pixel(a,m,l),w=b.real_to_pixel(a,n,k)):3===a.origin?(y=Math.max(0,Math.ceil((k-e)*s)),x=Math.min(c.height-y,Math.floor((l-k)*s)),G=Math.max(0,Math.ceil((n-d)*f)),z=Math.min(c.width-G,Math.floor((m-n)*f)),r=b.real_to_pixel(a,
m,k),w=b.real_to_pixel(a,n,l)):4===a.origin&&(y=Math.max(0,Math.ceil((k-e)*s)),x=Math.min(c.height-y,Math.floor((l-k)*s)),G=Math.max(0,Math.floor((n-d)*f)),z=Math.min(c.width-G,Math.floor((m-n)*f)),r=b.real_to_pixel(a,n,k),w=b.real_to_pixel(a,m,l));d=w.x-r.x;w=w.y-r.y;z=Math.max(1,z);x=Math.max(1,x);"number"===typeof q&&(q=(a.r-a.l)/z<=q);e=a.active_canvas.getContext("2d");e.save();e.beginPath();e.rect(a.l,a.t,a.r-a.l,a.b-a.t);e.clip();X(a,e,c,h,q,r.x,r.y,d,w,G,y,z,x);e.restore()}};P.exports=b})()},
{"./CanvasInput":1,"./common":3,"./m":4,tinycolor2:11}],6:[function(R,P,W){(function(){function b(a,c){if(!(this instanceof b))return new b.Plot(a,c)}function e(){this.yptr=this.xptr=void 0;this.xmax=this.xmin=this.panymax=this.panymin=this.panxmax=this.panxmin=this.xdelta=this.xstart=this.arety=this.aretx=this.ymrk=this.xmrk=this.rety=this.retx=0;this.xmult=void 0;this.ymax=this.ymin=0;this.zmax=this.zmin=this.ymult=void 0;this.pmt=this.pyscl=this.pxscl=this.dbmin=this.zoff=0;this.format=this.note=
"";this.modsource=this.modlayer=this.pthk=this.pyl=this.py2=this.py1=this.px2=this.px1=this.pb=this.pt=this.pr=this.pl=0;this.modified=!1;this.ydiv=this.xdiv=this.modmode=0;this.cross=this.expand=this.all=!1;this.grid=!0;this.gridBackground=void 0;this.index=!1;this.legend=this.specs=this.pan=!0;this.xdata=!1;this.show_readout=this.show_y_axis=this.show_x_axis=!0;this.autohide_panbars=this.autohide_readout=this.hide_note=!1;this.panning=void 0;this.panmode=0;this.hold=!1;this.isec=this.nsec=this.iysec=
this.sections=0;this.ylabel=this.ylab=this.xlabel=this.xlab=void 0;this.xcompression=0;this.default_rubberbox_action="zoom";this.default_rubberbox_mode="box";this.wheelscroll_mode_natural=!0;this.scroll_time_interval=10;this.stillPanning=this.repeatPanning=void 0;this.autol=-1;this.wheelZoom=this.rasterSmoothing=this.lineSmoothing=!1;this.wheelZoomPercent=0.2;this.inContinuousZoom=!1;this.lyr=[];this.HCB=[];this.plugins=[];this.plotData=document.createElement("canvas");this.lg_colorbar=this.plotData.valid=
!1;this.cbb_height=this.cbb_width=this.cbb_bot_y1=this.cbb_bot_x1=this.cbb_top_y1=this.cbb_top_x1=0;this.p_cuts=!1;this.y_box_w=this.y_box_h=this.y_box_y=this.y_box_x=this.x_box_w=this.x_box_h=this.x_box_y=this.x_box_x=0;this.p_cuts_ypos=this.p_cuts_xpos=void 0;this.x_cut_data=[];this.y_cut_data=[];this.xcut_layer=this.xcut=void 0;this.xcut_now=this.x_cut_press_on=!1;this.ycut_layer=this.ycut=void 0;this.ycut_now=this.y_cut_press_on=!1;this.element2=this.element1=this.xlabel_stash=this.ylabel_stash=
void 0;this.p_press=!1;this.xyKeys="automatic";this.y_pop_now=this.x_pop_now=!1}function m(b,a){var c=b._Gx,d=b._Mx;if(Array.isArray(a)){var t={name:"Custom",colors:a};"Custom"===k.Mc.colormap[k.Mc.colormap.length-1].name?k.Mc.colormap[k.Mc.colormap.length-1].colors=a:k.Mc.colormap.push(t);c.cmap=k.Mc.colormap.length-1}else if("string"===typeof a)for(c.cmap=-1,t=0;t<k.Mc.colormap.length;t++){if(k.Mc.colormap[t].name===a){c.cmap=t;break}}else c.cmap=a;0>c.ncolors&&(c.ncolors*=-1,c.cmap=Math.max(1,
c.cmap));if(0>c.cmap||c.cmap>k.Mc.colormap.length)c.cmap=2===c.cmode?2:1;l.colormap(d,k.Mc.colormap[c.cmap].colors,c.ncolors)}function a(b){var a=b._Gx;b=b._Mx;var c=a.aretx.toString();1===a.iabsc?l.message(b,"INDEX = "+c):2===a.iabsc?l.message(b,"1/X = "+c):l.message(b,"X = "+c)}function d(b){var a=b._Gx;b=b._Mx;var c=a.arety.toString();2===a.iabsc?l.message(b,"1/Y = "+c):l.message(b,"Y = "+c)}function c(b,a){var c=b._Mx;l.removeEventListener(c,"mousedown",b.onmousedown,!1);l.menu(c,{title:"SCROLLBAR",
refresh:function(){b.refresh()},finalize:function(){l.addEventListener(c,"mousedown",b.onmousedown,!1);b.refresh()},items:[{text:"Expand Range",handler:function(){g(b,l.SB_EXPAND,a)}},{text:"Shrink Range",handler:function(){g(b,l.SB_SHRINK,a)}},{text:"Expand Full",handler:function(){g(b,l.SB_FULL,a)}}]})}function h(b){var a=b._Gx,c=b._Mx;l.removeEventListener(c,"mousedown",b.onmousedown,!1);for(var d={text:"Cntrls...",menu:{title:"CONTROLS OPTIONS",items:[{text:"Continuous (Disabled)",checked:-2===
a.cntrls,handler:function(){b.change_settings({xcnt:-2})}},{text:"LM Click (Disabled)",checked:-1===a.cntrls,handler:function(){b.change_settings({xcnt:-1})}},{text:"Off",checked:0===a.cntrls,handler:function(){b.change_settings({xcnt:0})}},{text:"LM Click",checked:1===a.cntrls,handler:function(){b.change_settings({xcnt:1})}},{text:"Continuous",checked:2===a.cntrls,handler:function(){b.change_settings({xcnt:2})}}]}},t={text:"CX Mode...",menu:{title:"COMPLEX MODE",items:[{text:"Magnitude",checked:1===
a.cmode,handler:function(){b.change_settings({cmode:1})}},{text:"Phase",checked:2===a.cmode,handler:function(){b.change_settings({cmode:2})}},{text:"Real",checked:3===a.cmode,handler:function(){b.change_settings({cmode:3})}},{text:"Imaginary",checked:4===a.cmode,handler:function(){b.change_settings({cmode:4})}},{text:"IR: Imag/Real",checked:5===a.cmode,handler:function(){b.change_settings({cmode:5})}},{text:"10*Log10",checked:6===a.cmode,handler:function(){b.change_settings({cmode:6})}},{text:"20*Log10",
checked:7===a.cmode,handler:function(){b.change_settings({cmode:7})}}]}},e={text:"Scaling...",menu:{title:"SCALING",items:[{text:"Y Axis",style:"separator"},{text:"Parameters...",checked:0===a.autoy,handler:function(){a.autoy=0;M(b,"Y Axis Min:",l.floatValidator,function(a){parseFloat(a)!==c.stk[c.level].ymin?(""===a&&(a=0),A(b,parseFloat(a),c.stk[c.level].ymax,"Y")):b.refresh()},c.stk[c.level].ymin,void 0,void 0,function(){M(b,"Y Axis Max:",l.floatValidator,function(a){parseFloat(a)!==c.stk[c.level].ymax?
(""===a&&(a=0),A(b,c.stk[c.level].ymin,parseFloat(a),"Y")):b.refresh()},c.stk[c.level].ymax,void 0,void 0,void 0)})}},{text:"Min Auto",checked:1===a.autoy,handler:function(){a.autoy=1}},{text:"Max Auto",checked:2===a.autoy,handler:function(){a.autoy=2}},{text:"Full Auto",checked:3===a.autoy,handler:function(){a.autoy=3}},{text:"X Axis",style:"separator"},{text:"Parameters...",checked:0===a.autox,handler:function(){a.autox=0;M(b,"X Axis Min:",l.floatValidator,function(a){parseFloat(a)!==c.stk[c.level].xmin?
(""===a&&(a=0),A(b,parseFloat(a),c.stk[c.level].xmax,"X")):b.refresh()},c.stk[c.level].xmin,void 0,void 0,function(){M(b,"X Axis Max:",l.floatValidator,function(a){parseFloat(a)!==c.stk[c.level].xmax?(""===a&&(a=0),A(b,c.stk[c.level].xmin,parseFloat(a),"X")):b.refresh()},c.stk[c.level].xmax,void 0,void 0,void 0)})}},{text:"Min Auto",checked:1===a.autox,handler:function(){a.autox=1}},{text:"Max Auto",checked:2===a.autox,handler:function(){a.autox=2}},{text:"Full Auto",checked:3===a.autox,handler:function(){a.autox=
3}},{text:"Z Axis",style:"separator"},{text:"Parameters...",checked:0===a.autoz,handler:function(){a.autoz=0;M(b,"Z Axis Min:",l.floatValidator,function(c){parseFloat(c)!==a.zmin&&(""===c&&(c=0),b.change_settings({zmin:c}))},a.zmin,void 0,void 0,function(){M(b,"Z Axis Max:",l.floatValidator,function(c){parseFloat(c)!==a.zmax&&(""===c&&(c=0),b.change_settings({zmax:c}))},a.zmax,void 0,void 0,void 0)})}},{text:"Min Auto",checked:1===a.autoz,handler:function(){b.change_settings({autoz:1})}},{text:"Max Auto",
checked:2===a.autoz,handler:function(){b.change_settings({autoz:2})}},{text:"Full Auto",checked:3===a.autoz,handler:function(){b.change_settings({autoz:3})}}]}},f={text:"Settings...",menu:{title:"SETTINGS",items:[{text:"ALL Mode",checked:a.all,style:"checkbox",handler:function(){b.change_settings({all:!a.all})}},{text:"Controls...",menu:{title:"CONTROLS OPTIONS",items:[{text:"Continuous (Disabled)",checked:-2===a.cntrls,handler:function(){b.change_settings({xcnt:-2})}},{text:"LM Click (Disabled)",
checked:-1===a.cntrls,handler:function(){b.change_settings({xcnt:-1})}},{text:"Off",checked:0===a.cntrls,handler:function(){b.change_settings({xcnt:0})}},{text:"LM Click",checked:1===a.cntrls,handler:function(){b.change_settings({xcnt:1})}},{text:"Continuous",checked:2===a.cntrls,handler:function(){b.change_settings({xcnt:2})}}]}},{text:"Mouse...",menu:{title:"MOUSE OPTIONS",items:[{text:"LM Drag (Zoom)",checked:"zoom"===a.default_rubberbox_action,handler:function(){a.default_rubberbox_action="zoom"}},
{text:"LM Drag (Select)",checked:"select"===a.default_rubberbox_action,handler:function(){a.default_rubberbox_action="select"}},{text:"LM Drag (Disabled)",checked:null===a.default_rubberbox_action,handler:function(){a.default_rubberbox_action=null}},{text:"RM Drag (Zoom)",checked:"zoom"===a.default_rightclick_rubberbox_action,handler:function(){a.default_rightclick_rubberbox_action="zoom"}},{text:"RM Drag (Select)",checked:"select"===a.default_rightclick_rubberbox_action,handler:function(){a.default_rightclick_rubberbox_action=
"select"}},{text:"RM Drag (Disabled)",checked:null===a.default_rightclick_rubberbox_action,handler:function(){a.default_rightclick_rubberbox_action=null}},{text:"Mode...",menu:{title:"MOUSE Mode",items:[{text:"Box",checked:"box"===a.default_rubberbox_mode,handler:function(){a.default_rubberbox_mode="box"}},{text:"Horizontal",checked:"horizontal"===a.default_rubberbox_mode,handler:function(){a.default_rubberbox_mode="horizontal"}},{text:"Vertical",checked:"vertical"===a.default_rubberbox_mode,handler:function(){a.default_rubberbox_mode=
"vertical"}}]}},{text:"CROSShairs...",menu:{title:"Crosshairs Mode",items:[{text:"Off",checked:!a.cross,handler:function(){a.cross=!1}},{text:"On",checked:!0===a.cross,handler:function(){a.cross=!0}},{text:"Horizontal",checked:"horizontal"===a.cross,handler:function(){a.cross="horizontal"}},{text:"Vertical",checked:"vertical"===a.cross,handler:function(){a.cross="vertical"}}]}},{text:"Mousewheel Natural Mode",checked:a.wheelscroll_mode_natural,style:"checkbox",handler:function(){b.change_settings({wheelscroll_mode_natural:!a.wheelscroll_mode_natural})}}]}},
{text:"CROSShairs",checked:a.cross,style:"checkbox",handler:function(){b.change_settings({cross:!a.cross})}},{text:"GRID",checked:a.grid,style:"checkbox",handler:function(){b.change_settings({grid:!a.grid})}},{text:"INDEX Mode",checked:a.index,style:"checkbox",handler:function(){b.change_settings({index:!a.index})}},{text:"LEGEND",checked:a.legend,style:"checkbox",handler:function(){b.change_settings({legend:!a.legend})}},{text:"PAN Scrollbars",checked:a.pan,style:"checkbox",handler:function(){b.change_settings({pan:!a.pan})}},
{text:"PHase UNITS...",menu:{title:"PHASE UNITS",items:[{text:"Radians",checked:23===a.plab,handler:function(){b.change_settings({phunits:"R"})}},{text:"Degrees",checked:24===a.plab,handler:function(){b.change_settings({phunits:"D"})}},{text:"Cycles",checked:25===a.plab,handler:function(){b.change_settings({phunits:"C"})}}]}},{text:"SPECS",checked:a.specs,style:"checkbox",handler:function(){b.change_settings({specs:!a.specs})}},{text:"P-Cuts",checked:a.p_cuts,style:"checkbox",handler:function(){1!==
a.lyr[0].hcb["class"]&&(b.change_settings({p_cuts:!a.p_cuts}),!1===a.p_cuts&&(w(b),a.element1.parentNode.removeChild(a.element1),a.element2.parentNode.removeChild(a.element2),a.ycut=void 0,a.xcut=void 0),a.parent.setAttribute("style","position:relative"))}},{text:"Large Colorbar",checked:a.lg_colorbar,style:"checkbox",handler:function(){b.change_settings({lg_colorbar:!a.lg_colorbar})}},{text:"XDIVisions...",handler:function(){M(b,"X Divisions:",function(b){var a=l.intValidator(b),d=k.trunc(c.width/
2);return a.valid&&b>d?{valid:!1,reason:"Exceeds maximum number of divisions ("+d+")."}:a},function(c){parseFloat(c)!==a.xdiv&&(""===c&&(c=1),a.xdiv=parseFloat(c));b.refresh()},a.xdiv,void 0,void 0,void 0)}},{text:"XLABel...",handler:function(){M(b,"X Units:",function(b){console.log("The value is "+b);return l.intValidator(b)},function(c){parseFloat(c)!==a.xlab&&(0>c&&(c=0),a.xlab=parseFloat(c));b.refresh()},a.xlab,void 0,void 0,void 0)}},{text:"YDIVisions...",handler:function(){M(b,"Y Divisions:",
function(b){var a=l.intValidator(b),d=k.trunc(c.height/2);return a.valid&&b>d?{valid:!1,reason:"Exceeds maximum number of divisions ("+d+")."}:a},function(c){parseFloat(c)!==a.ydiv&&(""===c&&(c=1),a.ydiv=parseFloat(c));b.refresh()},a.ydiv,void 0,void 0,void 0)}},{text:"YINVersion",checked:4===c.origin,style:"checkbox",handler:function(){b.change_settings({yinv:4!==c.origin})}},{text:"YLABel...",handler:function(){M(b,"Y Units:",function(b){return l.intValidator(b)},function(c){parseFloat(c)!==a.ylab&&
(0>c&&(c=0),a.ylab=parseFloat(c));b.refresh()},a.ylab,void 0,void 0,void 0)}},{text:"X-axis",checked:a.show_x_axis,style:"checkbox",handler:function(){b.change_settings({show_x_axis:!a.show_x_axis})}},{text:"Y-axis",checked:a.show_y_axis,style:"checkbox",handler:function(){b.change_settings({show_y_axis:!a.show_y_axis})}},{text:"Readout",checked:a.show_readout,style:"checkbox",handler:function(){b.change_settings({show_readout:!a.show_readout})}},{text:"Invert Colors",checked:c.xi,style:"checkbox",
handler:function(){l.invertbgfg(c)}}]}},h={text:"Colormap...",menu:{title:"COLORMAP",items:[]}},s=function(b){},p=0;p<k.Mc.colormap.length;p++)h.menu.items.push({text:k.Mc.colormap[p].name,cmap:p,checked:a.cmap===p,handler:s});var n=function(c){return{title:"TRACE OPTIONS",items:[{text:"Dashed...",handler:function(){var d=1;if(void 0!==c)d=Math.abs(b._Gx.lyr[c].thick);else{if(0===a.lyr.length)return;for(var d=Math.abs(b._Gx.lyr[0].thick),H=0;H<a.lyr.length;H++)if(d!==Math.abs(b._Gx.lyr[H].thick)){d=
1;break}}M(b,"Line thickness:",l.intValidator,function(c){if(void 0!==d)b._Gx.lyr[d].line=3,b._Gx.lyr[d].thick=-1*c,b._Gx.lyr[d].symbol=0;else for(var d=0;d<a.lyr.length;d++)b._Gx.lyr[d].line=3,b._Gx.lyr[d].thick=-1*c,b._Gx.lyr[d].symbol=0},d)}},{text:"Dots...",handler:function(){var d=3;if(void 0!==c)d=Math.abs(b._Gx.lyr[c].radius);else{if(0===a.lyr.length)return;for(var H=0;H<a.lyr.length;H++)if(d!==Math.abs(b._Gx.lyr[H].radius)){d=3;break}}M(b,"Radius/Shape:",l.intValidator,function(d){var H;0>
d?(H=3,d=Math.abs(d)):0<d?H=2:(H=1,d=0);if(void 0!==c)b._Gx.lyr[c].line=0,b._Gx.lyr[c].radius=d,b._Gx.lyr[c].symbol=H;else for(var t=0;t<a.lyr.length;t++)b._Gx.lyr[t].line=0,b._Gx.lyr[t].radius=d,b._Gx.lyr[t].symbol=H},d)}},{text:"Solid...",handler:function(){var d=1;if(void 0!==c)d=Math.abs(b._Gx.lyr[c].thick);else{if(0===a.lyr.length)return;for(var d=Math.abs(b._Gx.lyr[0].thick),H=0;H<a.lyr.length;H++)if(d!==Math.abs(b._Gx.lyr[H].thick)){d=1;break}}M(b,"Line thickness:",l.intValidator,function(d){if(void 0!==
c)b._Gx.lyr[c].line=3,b._Gx.lyr[c].thick=d,b._Gx.lyr[c].symbol=0;else for(var H=0;H<a.lyr.length;H++)b._Gx.lyr[H].line=3,b._Gx.lyr[H].thick=d,b._Gx.lyr[H].symbol=0},d)}},{text:"Toggle",style:void 0!==c?"checkbox":void 0,checked:void 0!==c?b._Gx.lyr[c].display:void 0,handler:function(){if(void 0!==c)b._Gx.lyr[c].display=!b._Gx.lyr[c].display;else for(var d=0;d<a.lyr.length;d++)b._Gx.lyr[d].display=!b._Gx.lyr[d].display}},{text:"Symbols...",menu:{title:"SYMBOLS",items:[{text:"Retain Current"},{text:"None",
checked:void 0!==c?0===b._Gx.lyr[c].symbol:void 0,handler:function(){if(void 0!==c)b._Gx.lyr[c].radius=0,b._Gx.lyr[c].symbol=0;else for(var d=0;d<a.lyr.length;d++)b._Gx.lyr[d].radius=0,b._Gx.lyr[d].symbol=0}},{text:"Pixels",checked:void 0!==c?1===b._Gx.lyr[c].symbol:void 0,handler:function(){if(void 0!==c)b._Gx.lyr[c].radius=1,b._Gx.lyr[c].symbol=1;else for(var d=0;d<a.lyr.length;d++)b._Gx.lyr[d].radius=1,b._Gx.lyr[d].symbol=1}},{text:"Circles",checked:void 0!==c?2===b._Gx.lyr[c].symbol:void 0,handler:function(){if(void 0!==
c)b._Gx.lyr[c].radius=4,b._Gx.lyr[c].symbol=2;else for(var d=0;d<a.lyr.length;d++)b._Gx.lyr[d].radius=4,b._Gx.lyr[d].symbol=2}},{text:"Squares",checked:void 0!==c?3===b._Gx.lyr[c].symbol:void 0,handler:function(){if(void 0!==c)b._Gx.lyr[c].radius=4,b._Gx.lyr[c].symbol=3;else for(var d=0;d<a.lyr.length;d++)b._Gx.lyr[d].radius=4,b._Gx.lyr[d].symbol=3}},{text:"Plusses",checked:void 0!==c?4===b._Gx.lyr[c].symbol:void 0,handler:function(){if(void 0!==c)b._Gx.lyr[c].radius=4,b._Gx.lyr[c].symbol=4;else for(var d=
0;d<a.lyr.length;d++)b._Gx.lyr[d].radius=4,b._Gx.lyr[d].symbol=4}},{text:"X's",checked:void 0!==c?5===b._Gx.lyr[c].symbol:void 0,handler:function(){if(void 0!==c)b._Gx.lyr[c].radius=4,b._Gx.lyr[c].symbol=5;else for(var d=0;d<a.lyr.length;d++)b._Gx.lyr[d].radius=4,b._Gx.lyr[d].symbol=5}},{text:"Triangles",checked:void 0!==c?6===b._Gx.lyr[c].symbol:void 0,handler:function(){if(void 0!==c)b._Gx.lyr[c].radius=6,b._Gx.lyr[c].symbol=6;else for(var d=0;d<a.lyr.length;d++)b._Gx.lyr[d].radius=6,b._Gx.lyr[d].symbol=
6}},{text:"Downward Triangles",checked:void 0!==c?7===b._Gx.lyr[c].symbol:void 0,handler:function(){if(void 0!==c)b._Gx.lyr[c].radius=6,b._Gx.lyr[c].symbol=7;else for(var d=0;d<a.lyr.length;d++)b._Gx.lyr[d].radius=6,b._Gx.lyr[d].symbol=7}}]}},{text:"Line Type...",menu:{title:"LINE TYPE",items:[{text:"Retain Current"},{text:"None",checked:void 0!==c?0===b._Gx.lyr[c].line:void 0,handler:function(){if(void 0!==c)b._Gx.lyr[c].line=0;else for(var d=0;d<a.lyr.length;d++)b._Gx.lyr[d].line=0}},{text:"Verticals",
checked:void 0!==c?1===b._Gx.lyr[c].line:void 0,handler:function(){if(void 0!==c)b._Gx.lyr[c].line=1;else for(var d=0;d<a.lyr.length;d++)b._Gx.lyr[d].line=1}},{text:"Horizontals",checked:void 0!==c?2===b._Gx.lyr[c].line:void 0,handler:function(){if(void 0!==c)b._Gx.lyr[c].line=2;else for(var d=0;d<a.lyr.length;d++)b._Gx.lyr[d].line=2}},{text:"Connecting",checked:void 0!==c?3===b._Gx.lyr[c].line:void 0,handler:function(){if(void 0!==c)b._Gx.lyr[c].line=3;else for(var d=0;d<a.lyr.length;d++)b._Gx.lyr[d].line=
3}}]}},{text:"Thickness...",handler:function(){var d=1;void 0!==c&&(d=b._Gx.lyr[c].thick);M(b,"Thickness",l.intValidator,function(d){""===d&&(d=1);d=Math.max(0,d);if(void 0!==c)b._Gx.lyr[c].thick=d;else for(var H=0;H<a.lyr.length;H++)b._Gx.lyr[H].thick=d},d,void 0,void 0,void 0)}},{text:"Opacity...",handler:function(){var d=1;void 0!==c&&(d=b._Gx.lyr[c].opacity);M(b,"Opacity:",l.floatValidator,function(d){""===d&&(d=1);d=Math.max(0,d);d=Math.min(1,d);if(void 0!==c)b._Gx.lyr[c].opacity=d;else for(var H=
0;H<a.lyr.length;H++)b._Gx.lyr[H].opacity=d},d,void 0,void 0,void 0)}}]}},s={text:"Plugins...",menu:{title:"PLUGINS",items:function(){for(var b=[],c=0;c<a.plugins.length;c++){var d=a.plugins[c];d.impl.menu&&("function"===typeof d.impl.menu?b.push(d.impl.menu()):b.push(d.impl.menu))}return b}()}};l.menu(c,{title:"SIG-PLOT",finalize:function(){c.prompt||l.addEventListener(c,"mousedown",b.onmousedown,!1);b.refresh()},items:[{text:"Refresh"},d,t,e,{text:"View...",menu:{title:"VIEW",items:[{text:"Reset",
handler:function(){b.unzoom()}},{text:"Y Axis",style:"separator"},{text:"Expand Range",handler:function(){g(b,l.SB_EXPAND,"YPAN")}},{text:"Shrink Range",handler:function(){g(b,l.SB_SHRINK,"YPAN")}},{text:"Expand Full",handler:function(){g(b,l.SB_FULL,"YPAN")}},{text:"X Axis",style:"separator"},{text:"Expand Range",handler:function(){g(b,l.SB_EXPAND,"XPAN")}},{text:"Shrink Range",handler:function(){g(b,l.SB_SHRINK,"XPAN")}},{text:"Expand Full",handler:function(){g(b,l.SB_FULL,"XPAN")}}]}},{text:"Grid",
handler:function(){b.change_settings({grid:!a.grid})}},f,h,{text:"Traces...",menu:function(){var a=b._Gx,c={title:"TRACE",items:[]};c.items.push({text:"All",menu:n()});for(var d=0;d<a.lyr.length;d++)c.items.push({text:a.lyr[d].name,menu:n(d)});return c}},{text:"Files...",menu:{title:"FILES OPTIONS",items:[{text:"Deoverlay File...",menu:function(){var a=b._Gx,c={title:"DEOVERLAY",items:[]};c.items.push({text:"Deoverlay All",handler:function(){b.deoverlay()}});for(var d=0;d<a.lyr.length;d++){var H=
function(a){return function(){b.deoverlay(a)}}(d);c.items.push({text:a.lyr[d].name,handler:H})}return c}}]}},s,{text:"Keypress Info",handler:function(){l.message(c,ha)}},{text:"Save as...",menu:{title:"SAVE AS",items:[{text:"PNG",handler:function(){var a=b._Mx.active_canvas.toDataURL("image/png"),c=document.createElement("a");c.href=a;c.download="SigPlot."+(new Date).getTime()+".png";c.display="none";document.body.appendChild(c);c.click();document.body.removeChild(c)}},{text:"JPG",handler:function(){var a=
b._Mx.active_canvas.toDataURL("image/jpg"),c=document.createElement("a");c.href=a;c.download="SigPlot."+(new Date).getTime()+".jpg";c.display="none";document.body.appendChild(c);c.click();document.body.removeChild(c)}},{text:"SVG",handler:function(){var a=b._Mx.active_canvas.toDataURL("image/svg"),c=document.createElement("a");c.href=a;c.download="SigPlot."+(new Date).getTime()+".svg";c.display="none";document.body.appendChild(c);c.click();document.body.removeChild(c)}}]}},{text:"Exit",handler:function(){var b=
document.createEvent("Event");b.initEvent("sigplotexit",!0,!0);l.dispatchEvent(c,b)}}]})}function n(b,a){return function(c,d,t,e,k,f,g){var h=b._Mx,s=Math.min(d,e),p=Math.min(t,k),n=Math.abs(e-d),q=Math.abs(k-t),m=!1;c.which===a&&(m="horizontal"===g?2<n:"vertical"===g?2<q:2<n&&2<q);m?void 0===f||"zoom"===f?(b.pixel_zoom(d,t,e,k),b.refresh()):"select"===f&&(d=document.createEvent("Event"),d.initEvent("mtag",!0,!0),t=X(b,s,p),e=X(b,s+n,p+q),d.x=t.x,d.y=t.y,d.xpos=s,d.ypos=p,d.w=Math.abs(e.x-t.x),d.h=
Math.abs(e.y-t.y),d.wpxl=n,d.hpxl=q,d.shift=c.shiftKey,l.dispatchEvent(h,d)):b.mouseup(c)}}function f(b,a){var c=b._Mx,d=b._Gx;d.xmin=void 0===a.xmin?0:a.xmin;d.xmax=void 0===a.xmax?0:a.xmax;var t=void 0!==a.xmin,e=void 0!==a.xmax,f=void 0===a.cmode?"":a.cmode.toUpperCase();d.ylab=a.ylab;d.ylabel=a.ylabel;d.ymin=void 0===a.ymin?0:a.ymin;d.ymax=void 0===a.ymax?0:a.ymax;var g=void 0!==a.ymin,h=void 0!==a.ymax;d.zmin=a.zmin;d.zmax=a.zmax;var s=void 0!==a.zmin,p=void 0!==a.zmax;void 0!==a.colors&&l.setbgfg(c,
a.colors.bg,a.colors.fg,c.xi);void 0!==a.xi&&l.invertbgfg(c);d.forcelab=void 0===a.forcelab?!0:a.forcelab;d.all=void 0===a.all?!1:a.all;d.expand=void 0===a.expand?!1:a.expand;d.xlab=a.xlab;d.xlabel=a.xlabel;d.segment=void 0===a.segment?!1:a.segment;d.plab=24;var n=void 0===a.phunits?"D":a.phunits;"R"===n[0]?d.plab=23:"C"===n[0]&&(d.plab=25);d.xdiv=void 0===a.xdiv?5:a.xdiv;d.ydiv=void 0===a.ydiv?5:a.ydiv;d.xcompression=a.xcmp||0;d.rasterSmoothing=a.smoothing||!1;c.origin=1;a.yinv&&(c.origin=4);d.pmt=
void 0===a.pmt?1:a.pmt;d.bufmax=void 0===a.bufmax?32768:a.bufmax;d.sections=void 0===a.nsec?0:a.nsec;d.anno_type=void 0===a.anno_type?0:a.anno_type;d.xfmt=void 0===a.xfmt?"":a.xfmt;d.yfmt=void 0===a.yfmt?"":a.yfmt;d.index=void 0===a.index?!1:a.index;if(n=d.index||"IN"===f.slice(0,2))t&&1===d.xmin&&(t=!1),e&&1===d.xmin&&(e=!1);d.xdata=!1;d.note="";d.hold=0;d.always_show_marker=a.always_show_marker||!1;k.vstype("D");a.inputs||z(b,!1);var q=f.slice(0,2);if("IN"===q||"AB"===q||"__"===q)q=f.slice(2,4);
d.cmode=0<d.lyr.length&&d.lyr[0].cx?1:3;"MA"===q&&(d.cmode=1);"PH"===q&&(d.cmode=2);"RE"===q&&(d.cmode=3);"IM"===q&&(d.cmode=4);if("LO"===q||"D1"===q)d.cmode=6;if("L2"===q||"D2"===q)d.cmode=7;if("RI"===q||"IR"===q)d.index?alert("Imag/Real mode not permitted in INDEX mode"):d.cmode=5;d.basemode=d.cmode;b.change_settings({cmode:d.cmode});d.dbmin=1E-20;6<=d.cmode&&(f=10,7===d.cmode&&(f=20),"L"===q[0]?(0<d.lyr.length&&d.lyr[0].cx?(d.ymin=Math.max(d.ymin,1E-10),d.ymax=Math.max(d.ymax,1E-10)):(d.ymin=Math.max(d.ymin,
1E-20),d.ymax=Math.max(d.ymax,1E-20)),d.ymin=k.log10(d.ymin)*f,d.ymax=k.log10(d.ymax)*f):0<d.lyr.length&&d.lyr[0].cx?(d.ymin=Math.max(-18*f,d.ymin),d.ymax=Math.max(-18*f,d.ymax),d.dbmin=1E-37):Math.min(d.ymin,d.ymax)<-20*f&&(d.ymin=Math.max(-37*f,d.ymin),d.ymax=Math.max(-37*f,d.ymax),d.dbmin=Math.pow(10,Math.min(d.ymin,d.ymax)/f)));c.level=0;n&&!d.index&&(t&&(d.xmin=d.xstart+d.xdelta*(d.xmin-1)),t&&(d.xmax=d.xstart+d.xdelta*(d.xmax-1)));d.xmult=a.xmult;d.ymult=a.xmult;switch(a.autox){case "none":a.autox=
-1;break;case "min":a.autox=1;break;case "max":a.autox=2;break;case "full":a.autox=3}d.autox=void 0===a.autox?-1:a.autox;0>d.autox&&(d.autox=0,t||(d.autox+=1),e||(d.autox+=2));switch(a.autoy){case "none":a.autoy=-1;break;case "min":a.autoy=1;break;case "max":a.autoy=2;break;case "full":a.autoy=3}d.autoy=void 0===a.autoy?-1:a.autoy;0>d.autoy&&(d.autoy=0,g||(d.autoy+=1),h||(d.autoy+=2));switch(a.autoz){case "none":a.autoz=-1;break;case "min":a.autoz=1;break;case "max":a.autoz=2;break;case "full":a.autoz=
3}d.autoz=void 0===a.autoz?-1:a.autoz;0>d.autoz&&(d.autoz=0,s||(d.autoz+=1),p||(d.autoz+=2));d.autol=void 0===a.autol?-1:a.autol;t||(d.xmin=void 0);e||(d.xmax=void 0);I(b,{get_data:!0},d.xmin,d.xmax,d.xlab,d.ylab);t||(d.xmin=c.stk[0].xmin);e||(d.xmax=c.stk[0].xmax);g||(d.ymin=c.stk[0].ymin);h||(d.ymax=c.stk[0].ymax);d.xmin>d.xmax&&(c.stk[0].xmin=d.xmax,d.xmax=d.xmin,d.xmin=c.stk[0].xmin);d.ymin>d.ymax&&(c.stk[0].ymin=d.ymax,d.ymax=d.ymin,d.ymin=c.stk[0].ymin);c.stk[0].xmin=d.xmin;c.stk[0].xmax=d.xmax;
c.stk[0].ymin=d.ymin;c.stk[0].ymax=d.ymax;d.panxmin=Math.min(d.panxmin,d.xmin);d.panxmax=Math.max(d.panxmax,d.xmax);d.panymin=Math.min(d.panymin,d.ymin);d.panymax=Math.max(d.panymax,d.ymax);d.xmin=c.stk[0].xmin;d.ymin=c.stk[0].ymin;a.font_family&&(c.font_family=a.font_family);l.set_font(c,Math.min(7,c.width/64));d.ncolors=void 0===a.ncolors?16:a.ncolors;d.cmap=null;d.cmap=a.cmap?a.cmap:void 0===a.xc?-1:a.xc;m(b,d.cmap);d.cntrls="leftmouse"===a.xcnt?1:"continuous"===a.xcnt?2:void 0===a.xcnt?1:a.xcnt;
d.default_rubberbox_mode=void 0===a.rubberbox_mode?"box":a.rubberbox_mode;d.default_rubberbox_action=void 0===a.rubberbox_action?"zoom":a.rubberbox_action;d.default_rightclick_rubberbox_mode=void 0===a.rightclick_rubberbox_mode?"box":a.rightclick_rubberbox_mode;d.default_rightclick_rubberbox_action=void 0===a.rightclick_rubberbox_action?null:a.rightclick_rubberbox_action;d.cross=void 0===a.cross?!1:a.cross;d.grid=void 0===a.nogrid?!0:!a.nogrid;d.fillStyle=a.fillStyle;d.gridBackground=a.gridBackground;
d.gridStyle=a.gridStyle;d.wheelZoom=a.wheelZoom;d.wheelZoomPercent=a.wheelZoomPercent;d.legend=void 0===a.legend?!1:a.legend;d.no_legend_button=void 0===a.no_legend_button?!1:a.no_legend_button;d.legendBtnLocation=null;d.pan=void 0===a.nopan?!0:!a.nopan;d.nomenu=void 0===a.nomenu?!1:a.nomenu;d.modmode=0;d.modlayer=-1;d.modsource=0;d.modified=a.mod&&0<d.lyr.length;d.nmark=0;d.iabsc=0;d.index&&(d.iabsc=1);d.specs=!a.nospecs;d.scroll_time_interval=void 0===a.scroll_time_interval?d.scroll_time_interval:
a.scroll_time_interval;d.autohide_readout=a.autohide_readout;d.autohide_panbars=a.autohide_panbars;d.x_scrollbar_location=a.x_scrollbar_location;d.specs?(d.show_x_axis=!a.noxaxis,d.show_y_axis=!a.noyaxis,d.show_readout=!a.noreadout,d.specs=d.show_x_axis||d.show_y_axis||d.show_readout?!0:!1):(d.show_x_axis=!1,d.show_y_axis=!1,d.show_readout=!1);d.hide_note=a.hide_note||!1;d.xmrk=0;d.ymrk=0;a.nodragdrop||(l.addEventListener(c,"dragover",function(a){a.preventDefault()},!1),l.addEventListener(c,"drop",
function(a){return function(b){var c=b.dataTransfer.files;0<c.length&&(b.preventDefault(),a.load_files(c))}}(b),!1))}function z(a,b){var c=a._Gx,d=a._Mx;if(b){var t=c.HCB[0];c.xstart=t.xstart;c.xdelta=t.xdelta}else c.xstart=0,c.xdelta=1,c.autol=-1;d.origin=1}function r(a){for(var b=a._Gx,c=a._Mx.canvas.getContext("2d"),d,t=0;t<b.plugins.length;)b.plugins[t].impl.refresh&&(d=b.plugins[t].canvas,d.width!==a._Mx.canvas.width&&(d.width=a._Mx.canvas.width),d.height!==a._Mx.canvas.height&&(d.height=a._Mx.canvas.height),
0!==d.height&&0!==d.width&&(d.width!==a._Mx.canvas.width&&(d.width=a._Mx.canvas.width),d.height!==a._Mx.canvas.height&&(d.height=a._Mx.canvas.height),d.getContext("2d").clearRect(0,0,d.width,d.height),b.plugins[t].impl.refresh(d),c.drawImage(d,0,0))),t+=1}function E(a){a=a._Gx;if(0===a.HCB.length)a.note="";else if(void 0===a.HCB[0].plotnote){for(var b=[],c=0;c<a.HCB.length;c++)a.HCB[c].file_name&&b.push(a.HCB[c].file_name);a.note=b.join("|").toUpperCase()}}function D(a,b){var c=a._Mx,d=a._Gx;if(!(b>=
d.lyr.length)&&d.lyr[b].display&&0===d.hold){d.lyr[b].draw();var t=document.createEvent("Event");t.initEvent("lyrdraw",!0,!0);t.index=b;t.name=d.lyr[b].name;t.layer=d.lyr[b];l.dispatchEvent(c,t)}}function y(a,b){var c=a._Gx,d=a._Mx,t=document.createEvent("Event");t.initEvent("lyrdel",!0,!0);t.index=b;t.name=c.lyr[b].name;t.layer=c.lyr[b];if(l.dispatchEvent(d,t)){c.lyr[b].ybufn=0;c.lyr[b].ybuf=null;if(b<c.lyr.length-1)for(d=b;d<c.lyr.length-1;d++)c.lyr[d]=c.lyr[d+1];c.lyr.length-=1;0<c.HCB.length&&
(c.panxmin=1,c.panxmax=-1,c.panymin=1,c.panymax=-1)}}function w(a){var c=a._Gx,d=a._Mx;if(2===c.lyr[0].hcb["class"]){var H=document.createEvent("Event");H.initEvent("x-cut",!1,!1);a.addListener("x-cut",function(){if(void 0===a._Gx.xcut){a._Gx.element1=document.createElement("div");document.getElementById(a._Gx.parent.id).appendChild(a._Gx.element1);a._Gx.xcut=new b.Plot(a._Gx.element1,{});var d=a._Gx.xcut.overlay_array(a._Gx.x_cut_data,null,{name:"x_cut_data",line:3});a._Gx.xcut.change_settings({specs:!c.specs});
a._Gx.xcut.change_settings({grid:!c.grid});a._Gx.xcut.change_settings({pan:!c.pan});a._Gx.xcut._Gx.x_box_x=a._Gx.x_box_x;a._Gx.xcut._Gx.x_box_y=a._Gx.x_box_y;a._Gx.xcut._Gx.x_box_h=a._Gx.x_box_h;a._Gx.xcut._Gx.x_box_w=a._Gx.x_box_w;a._Gx.xcut.change_settings({xcut_now:!c.xcut_now});a._Gx.xcut.get_layer(d).color=a._Mx.fg;a._Gx.element1.setAttribute("style","width:"+a._Gx.x_box_w+"px;height:"+a._Gx.x_box_h+"px;position:absolute;left:"+a._Gx.x_box_x+"px;top:"+a._Gx.x_box_y+"px")}else a._Gx.xcut.reload(0,
a._Gx.x_cut_data)});var t=document.createEvent("Event");t.initEvent("y-cut",!1,!1);a.addListener("y-cut",function(){if(void 0===a._Gx.ycut){a._Gx.element2=document.createElement("div");document.getElementById(a._Gx.parent.id).appendChild(a._Gx.element2);a._Gx.ycut=new b.Plot(a._Gx.element2,{});var d=a._Gx.ycut.overlay_array(a._Gx.y_cut_data,null,{name:"y_cut_data",line:3});a._Gx.ycut.change_settings({specs:!c.specs});a._Gx.ycut.change_settings({grid:!c.grid});a._Gx.ycut.change_settings({pan:!c.pan});
a._Gx.ycut._Gx.y_box_x=a._Gx.y_box_x;a._Gx.ycut._Gx.y_box_y=a._Gx.y_box_y;a._Gx.ycut._Gx.y_box_h=a._Gx.y_box_h;a._Gx.ycut._Gx.y_box_w=a._Gx.y_box_w;a._Gx.ycut.change_settings({ycut_now:!c.ycut_now});a._Gx.ycut.get_layer(d).color=a._Mx.fg;a._Gx.element2.setAttribute("style","width:"+a._Gx.y_box_h+"px;height:"+a._Gx.y_box_w+"px;position:absolute;left:"+(a._Gx.y_box_x+0.5*a._Gx.y_box_w-0.5*a._Gx.y_box_h)+"px;top:"+(a._Gx.y_box_y+0.5*a._Gx.y_box_h-0.5*a._Gx.y_box_w)+"px");a._Gx.element2.style.transform=
"rotate(90deg)"}else a._Gx.ycut.reload(0,a._Gx.y_cut_data)});var e=d.b-d.t,f=d.r-d.l,k=c.lyr[0].yframe,g=c.lyr[0].xframe;if(c.p_cuts){if(d.xpos>=d.l&&d.xpos<=d.r&&c.p_cuts_xpos!==d.xpos||c.p_press){var h=0,h=0;if(void 0!==c.p_cuts_xpos){c.y_cut_data=[];for(h=Math.floor(g*(c.p_cuts_xpos-d.l)/f);h<g*k;h+=g)c.y_cut_data.push(c.lyr[0].zbuf[h]);l.dispatchEvent(d,t)}c.y_cut_data=[];for(h=Math.floor(g*(d.xpos-d.l)/f);h<g*k;h+=g)c.y_cut_data.push(c.lyr[0].zbuf[h]);l.dispatchEvent(d,t);c.p_cuts_xpos=d.xpos}if(d.ypos>=
d.t&&d.ypos<=d.b&&c.p_cuts_ypos!==d.ypos||c.p_press)h=t=t=0,void 0!==c.p_cuts_ypos&&(t=Math.floor(k*(c.p_cuts_ypos-d.t)/e),t*=g,c.x_cut_data=c.lyr[0].zbuf.slice(t,t+g),l.dispatchEvent(d,H)),t=Math.floor(k*(d.ypos-d.t)/e),t*=g,c.x_cut_data=c.lyr[0].zbuf.slice(t,t+g),l.dispatchEvent(d,H),c.p_cuts_ypos=d.ypos;c.p_press=!1}}}function G(a){var b=a._Gx;a=a._Mx;b.cross&&(("vertical"===b.cross||!0===b.cross)&&a.xpos>=a.l&&a.xpos<=a.r&&b.cross_xpos!==a.xpos&&(void 0!==b.cross_xpos&&l.rubberline(a,b.cross_xpos,
a.t,b.cross_xpos,a.b),l.rubberline(a,a.xpos,a.t,a.xpos,a.b),b.cross_xpos=a.xpos),("horizontal"===b.cross||!0===b.cross)&&a.ypos>=a.t&&a.ypos<=a.b&&b.cross_ypos!==a.ypos&&(void 0!==b.cross_ypos&&l.rubberline(a,a.l,b.cross_ypos,a.r,b.cross_ypos),l.rubberline(a,a.l,a.ypos,a.r,a.ypos),b.cross_ypos=a.ypos))}function L(a){var b=a._Gx;a=a._Mx;if(null!==b.xmrk&&null!==b.ymrk){var c=l.real_to_pixel(a,b.xmrk,b.ymrk);if(1===b.lyr[0].hcb["class"]){if(c.clipped)return}else if(2===b.lyr[0].hcb["class"]&&(c.clipped_x||
!c.clipped_y))return;var d=a.active_canvas.getContext("2d");d.beginPath();d.strokeStyle=a.xwfg;d.fillStyle=a.xwfg;d.arc(c.x,c.y,2,0,360);d.stroke();d.textBaseline="alphabetic";d.textAlign="left";d.fillStyle=a.fg;d.font=a.font.font;var t="x:"+l.format_g(b.xmrk,6,3,!0);d.fillText(t,c.x+5,c.y-5);t="y:"+l.format_g(b.ymrk,6,3,!0);d.fillText(t,c.x+5,c.y-5+a.text_h)}}function T(a,b){var c=a._Mx,d=a._Gx;d.xdata=!1;for(var t=0;t<d.lyr.length;t++)d.lyr[t].xdata=5===b?!0:!1,d.lyr[t].xdata&&(d.xdata=!0);if(b!==
d.cmode)if(5===b&&d.index)alert("Imag/Real mode not permitted in INDEX mode");else if(0>=d.lyr.length)d.cmode=b,B(a);else if(0<b){t=d.cmode;d.cmode=b;var e=d.autox,f=d.autoy;d.autox=3;d.autoy=3;if(5===b||5===t)d.panxmin=1,d.panxmax=-1,d.panymin=1,d.panymax=-1,c.level=0,b===d.basemode?(c.stk[0].xmin=d.xmin,c.stk[0].xmax=d.xmax,c.stk[0].ymin=d.ymin,c.stk[0].ymax=d.ymax):5===b||5===d.basemode?I(a,{get_data:!0}):(c.stk[0].xmin=d.xmin,c.stk[0].xmax=d.xmax,I(a,{get_data:!0},d.xmin,d.xmax));else for(b===
d.basemode?(d.panymin=1,d.panymax=-1,c.stk[0].ymin=d.ymin,c.stk[0].ymax=d.ymax):I(a,{},c.stk[c.level].xmin,c.stk[c.level].xmax),t=1;t<=c.level;t++)c.stk[t].ymin=c.stk[0].ymin,c.stk[t].ymax=c.stk[0].ymax;d.autox=e;d.autoy=f;a.refresh()}}function ca(a){var b,c=a._Mx,d=a._Gx;if(d.pan&&!c.widget){b=c.level;var t={ps:c.stk[b].ymin,pe:c.stk[b].ymax},e=t.ps!==d.panymin||t.pe!==d.panymax,e=e&&0<c.level;!d.autohide_panbars||e&&a.mouseOnCanvas||d.panning?(l.scrollbar(c,0,d.pyl,d.pyl+d.pthk,c.t,c.b,t,d.panymin,
d.panymax,void 0,c.scrollbar_y),c.stk[b].ymin=t.ps,c.stk[b].ymax=t.pe):(t=c.canvas.getContext("2d"),t.fillStyle=c.bg,t.fillRect(d.pyl,c.t,d.pyl+d.pthk,c.b-c.t));d.pl<c.width&&(t={ps:c.stk[b].xmin,pe:c.stk[b].xmax},e=(e=t.ps!==d.panxmin||t.pe!==d.panxmax)&&(!d.all||0<c.level),!d.autohide_panbars||e&&a.mouseOnCanvas||d.panning?(l.scrollbar(c,0,d.pl,d.pr,d.pt,d.pt+d.pthk,t,d.panxmin,d.panxmax,void 0,c.scrollbar_x),c.stk[b].xmin=t.ps,c.stk[b].xmax=t.pe):(t=c.canvas.getContext("2d"),t.fillStyle=c.bg,t.fillRect(d.pl,
d.pt-1,d.pr-d.pl,d.pthk+4)))}}function Y(a,b,c,d){var t=a._Mx,e=a._Gx,f,k,g,h;h=new l.SCROLLBAR;k=new l.SCROLLBAR;var s=!1;f=t.level;0<e.panmode?(h.flag=11,k.flag=11):(h.flag=-12,k.flag=-12);0===c&&(h.action=0,k.action=0);if("Y"===b.substring(0,1)){if(h=t.stk[f].ymin,c=t.stk[f].ymax,g=c-h,"YPAN"===b?(b=t.scrollbar_y,c={ps:h,pe:c},l.scrollbar(t,k,e.pyl,e.pyl+e.pthk,t.t,t.b,c,e.panymin,e.panymax,d,b),h=c.ps,c=c.pe,0!==k.action&&l.scroll(t,k,l.XW_UPDATE,void 0,b)):"YCENTER"===b&&(h-=g*(t.ypos-(t.t+t.b)/
2)/(t.b-t.t),c=h+g),h!==t.stk[f].ymin||c!==t.stk[f].ymax)t.stk[f].ymin=h,t.stk[f].ymax=c,e.cmode===e.basemode&&1===t.level&&(e.ymin=Math.min(e.ymin,h),e.ymax=Math.max(e.ymax,c)),this.inPan=!0,d=document.createEvent("Event"),d.initEvent("ypan",!0,!0),d.level=t.level,d.xmin=t.stk[t.level].xmin,d.ymin=t.stk[t.level].ymin,d.xmax=t.stk[t.level].xmax,d.ymax=t.stk[t.level].ymax,l.dispatchEvent(t,d),this.inPan=!1,a.refresh(),s=!0}else if(k=t.stk[f].xmin,c=t.stk[f].xmax,g=c-k,"XPAN"===b?(b=t.scrollbar_x,c=
{ps:k,pe:c},l.scrollbar(t,h,e.pl,e.pr,e.pt,e.pt+e.pthk,c,e.panxmin,e.panxmax,d,b),k=c.ps,c=c.pe,0!==h.action&&l.scroll(t,h,l.XW_UPDATE,void 0,b)):"XCENTER"===b&&(k+=g*(t.xpos-(t.l+t.r)/2)/(t.r-t.l),k!==t.stk[f].xmin&&(c=k+g)),t.stk[f].xmin!==k||t.stk[f].xmax!==c)t.stk[f].xmin=k,t.stk[f].xmax=c,e.xdata||1!==t.level||(e.xmin=t.stk[1].xmin,e.xmax=t.stk[1].xmax),this.inPan=!0,d=document.createEvent("Event"),d.initEvent("xpan",!0,!0),d.level=t.level,d.xmin=t.stk[t.level].xmin,d.ymin=t.stk[t.level].ymin,
d.xmax=t.stk[t.level].xmax,d.ymax=t.stk[t.level].ymax,l.dispatchEvent(t,d),this.inPan=!1,a.refresh(),s=!0;return s}function $(a,b,c){var d=a._Mx,e=a._Gx,k,f,h;if("XPAN"===b)h=a._Mx.scrollbar_x;else if("YPAN"===b)h=a._Mx.scrollbar_y;else throw"Unable to drag scrollbar - scrollAction is not 'XPAN' or 'YPAN'!!";h.flag=-12;f=d.level;"XPAN"===b?(k=d.stk[f].xmin,f=d.stk[f].xmax):"YPAN"===b?(k=d.stk[f].ymin,f=d.stk[f].ymax):f=k=void 0;var g=h;g.action=l.SB_DRAG;if("YPAN"===b){var s=d.scrollbar_y.trange/
d.scrollbar_y.h;4===g.origin&&(s*=-1);c=c.screenY-e.panning.ypos;c*=s;e.panning.ymin-c<e.panymin?(f=e.panymin+(f-k),k=e.panymin):e.panning.ymax-c>e.panymax?(k=e.panymax-(f-k),f=e.panymax):(k=e.panning.ymin-c,f=e.panning.ymax-c)}else"XPAN"===b&&(s=d.scrollbar_x.trange/d.scrollbar_x.w,3===g.origin&&(s*=-1),c=c.screenX-e.panning.xpos,c*=s,e.panning.xmin+c<e.panxmin?(f=e.panxmin+(f-k),k=e.panxmin):e.panning.xmax+c>e.panxmax?(k=e.panxmax-(f-k),f=e.panxmax):(k=e.panning.xmin+c,f=e.panning.xmax+c));h.smin=
k;h.srange=f-k;l.redrawScrollbar(h,d,void 0);A(a,h.smin,h.smin+h.srange,b.slice(0,1));this.inPan=!0;e=document.createEvent("Event");"XPAN"===b?e.initEvent("xpan",!0,!0):"YPAN"===b&&e.initEvent("ypan",!0,!0);e.level=d.level;e.xmin=d.stk[d.level].xmin;e.ymin=d.stk[d.level].ymin;e.xmax=d.stk[d.level].xmax;e.ymax=d.stk[d.level].ymax;l.dispatchEvent(d,e);this.inPan=!1;h.action=0;a.refresh()}function M(a,b,c,d,e,f,k,h){var g=a._Mx;if(g.prompt)throw"Prompt already exists! Can only have one prompt at a time!";
l.disableListeners(g);a.disable_listeners();var s=function(a,b){return function(c){b(c);l.enableListeners(g);a.enable_listeners();a.refresh();void 0!==h&&h()}},p=function(){a.refresh()};try{l.prompt(g,b,c,s(a,d),p,e,f,k,5E3)}catch(n){console.log("ERROR: Failed to set up prompt due to: "+n)}}function B(a){var b=a._Mx,c=a._Gx,d=b.canvas.getContext("2d");0===c.sections&&(c.isec=0);if(b.warpbox){var e=X(a,b.warpbox.xo,b.warpbox.yo),f=X(a,b.warpbox.xl,b.warpbox.yl);c.aretx=e.x;c.arety=e.y;c.dretx=f.x-
e.x;c.drety=f.y-e.y}else c.aretx=c.retx,c.arety=c.rety,c.dretx=c.retx-c.xmrk,c.drety=c.rety-c.ymrk;5===c.cmode&&1===c.iabsc&&(c.iabsc=2);1===c.iabsc?(c.aretx=Math.round((c.aretx-c.xstart)/c.xdelta),c.index||(c.aretx+=1),c.dretx=Math.round(c.dretx/c.xdelta)):2===c.iabsc&&(0!==c.aretx&&(c.aretx=1/c.aretx),0!==c.arety&&(c.arety=1/c.arety),0!==c.dretx&&(c.dretx=1/c.dretx),0!==c.drety&&(c.drety=1/c.drety));if(c.show_readout&&!b.widget&&(d.fillStyle=b.bg,f=Math.floor(b.height-2.5*b.text_h),d.fillRect(b.text_w,
f-1,49*b.text_w,f+1.5*b.text_h),f=Math.floor(b.height-0.5*b.text_h),e=Math.max(c.pr+b.text_w,b.width-2*b.text_w),d.fillStyle=b.bg,d.fillRect(e,f-b.text_h,b.text_w,b.text_h),!c.autohide_readout||a.mouseOnCanvas||c.panning)){var h;0===c.iabsc&&4===c.ylab?(f=(k.sec2tspec(c.arety)+"                ").substring(0,16),h=(k.sec2tspec(c.drety,"delta")+"                ").substring(0,16)):(f=l.format_g(c.arety,16,9,!0),h=l.format_g(c.drety,16,9));0===c.iabsc&&4===c.xlab?(d=(k.sec2tspec(c.aretx)+"                ").substring(0,
16),a=(k.sec2tspec(c.dretx,"delta")+"                ").substring(0,16)):(d=l.format_g(c.aretx,16,9,!0),a=l.format_g(c.dretx,16,9));h="y: "+f+" dy: "+h+" L="+b.level+" "+ia[c.cmode-1];d="x: "+d+" dx: "+a+" "+ja[c.iabsc];3===c.iabsc&&(h=0===c.dretx?h.substr(0,20)+"sl: Inf             "+h.substr(40,h.length):h.substr(0,20)+"sl: "+l.format_g(c.drety/c.dretx,16,9)+h.substr(40,h.length));f=Math.floor(b.height-1.5*b.text_h);l.text(b,b.text_w,f,h);f=Math.floor(b.height-0.5*b.text_h);l.text(b,b.text_w,f,
d);l.LEGACY_RENDER&&e<b.width&&(0<c.cntrls?l.text(b,e,f,"C"):l.text(b,e,f," "));h=f=a=e=0;if(c.lg_colorbar&&2===c.lyr[0].hcb["class"]){d=b.b-b.t;e=b.r+35;a=b.t+0.125*d;f=5*b.text_w;h=0.75*d;d=b.active_canvas.getContext("2d");d.strokeStyle="rgba(124, 123, 121, 0.8)";d.fillStyle=" rgba(124, 123, 121, 0.8)";var g=f,s=h,p=g-2,n=p/2,g=e+(g-p)/2,q=a-10;d.beginPath();d.moveTo(g,q);d.lineTo(g+p,q);d.lineTo(g+0.5*p,q-n);d.lineTo(g,q);d.stroke();d.fill();s=q+s+20;d.beginPath();d.moveTo(g,s);d.lineTo(g+p,s);
d.lineTo(g+0.5*p,s+n);d.lineTo(g,s);d.stroke();d.fill();c.cbb_top_x1=g;c.cbb_top_y1=q;c.cbb_bot_x1=g;c.cbb_bot_y1=s;c.cbb_width=p;c.cbb_height=n}else e=49*b.text_w-3,a=b.height-2.5*b.text_h,f=b.text_w,h=2*b.text_h;l.colorbar(b,e,a,f,h);c.p_cuts&&2===c.lyr[0].hcb["class"]&&(d=b.b-b.t,e=b.r-b.l,c.y_box_x=b.r+25,c.y_box_y=b.t,c.y_box_w=5*b.text_w+20,c.y_box_h=d,c.lg_colorbar&&(c.y_box_x+=100),l.draw_box(b,b.fg,c.y_box_x+0.5,c.y_box_y,c.y_box_w,c.y_box_h),c.x_box_x=b.l,c.x_box_y=b.b+25,c.x_box_w=e,c.x_box_h=
5*b.text_h+20,l.draw_box(b,b.fg,c.x_box_x+0.5,c.x_box_y,c.x_box_w,c.x_box_h))}}function I(a,b,c,d,e,f){var k=a._Mx;a=a._Gx;b=!0===b.get_data;a.panxmin=1;a.panxmax=-1;a.panymin=1;a.panymax=-1;var l=void 0===c,h=void 0===d;if(0===a.lyr.length)a.panxmin=-1,a.panxmax=1,a.panymin=-1,a.panymax=1;else for(void 0===e&&(a.xlab=a.lyr[0].xlab),void 0===f&&(a.ylab=a.lyr[0].ylab),e=0;e<a.lyr.length;e++)if(l&&(c=a.lyr[e].xmin),h&&(d=a.lyr[e].xmax),a.xlab!==a.lyr[e].xlab&&(a.xlab=0),a.ylab!==a.lyr[e].ylab&&(a.ylab=
0),b&&a.lyr[e].get_data(c,d),0<a.autox||0<a.autoy)for(;c<d;)a.lyr[e].get_data(c,d),f=a.lyr[e].prep(c,d),a.all&&a.expand?0===a.lyr[e].size?c=d:a.index?c+=f:0<=a.lyr[e].xdelta?c+=a.lyr[e].size*a.lyr[e].xdelta:d+=a.lyr[e].size*a.lyr[e].xdelta:c=d;else a.lyr[e].prep(1,-1);e=a.panxmax-a.panxmin;0>e&&(a.panxmax=a.panxmin,a.panxmin=a.panxmax+e,e=-e);1E-20>=e&&(a.panxmin-=1,a.panxmax+=1);0!==(a.autox&1)&&l&&(k.stk[0].xmin=a.panxmin);if(0!==(a.autox&2)&&h&&(k.stk[0].xmax=a.panxmax,!a.all&&!a.xdata))for(e=
0;e<a.lyr.length;e++)d=Math.min(a.lyr[e].xmax,k.stk[0].xmax),f=Math.abs((d-a.lyr[e].xmin)/a.lyr[e].xdelta)-a.bufmax+1,0<f&&(k.stk[0].xmax=d-f*Math.abs(a.lyr[e].xdelta));0!==(a.autoy&1)&&(k.stk[0].ymin=a.panymin);0!==(a.autoy&2)&&(k.stk[0].ymax=a.panymax)}function X(a,b,c){var d=a._Gx;a=l.pixel_to_real(a._Mx,b,c);d.index&&(a.x*=d.xdelta);return a}function p(a,b,c,d,e,f){return a>=c&&a<=c+e&&b>=d&&b<=d+f}function F(a,b,c,d,e,f,k,l){k=[k-c,l-d];e=[e-c,f-d];d=[a-c,b-d];a=k[0]*k[0]+k[1]*k[1];b=k[0]*e[0]+
k[1]*e[1];k=k[0]*d[0]+k[1]*d[1];c=e[0]*e[0]+e[1]*e[1];e=e[0]*d[0]+e[1]*d[1];d=1/(a*c-b*b);c=(c*k-b*e)*d;k=(a*e-b*k)*d;return 0<=c&&0<=k&&1>c+k}function K(a,b){var c=!1,d=a._Gx,e=a._Mx,f=0,l=0;if(void 0===b){if(f=e.xpos,l=e.ypos,!a.mouseOnCanvas)return!1}else f=b.x,l=b.y;var h=" ";if(!d.pan)return!1;var g=l<=d.pt+d.pthk+2,s=l>d.pt-2,l=l>=e.t&&l<=e.b,p=f>=d.pl&&f<=d.pr,n=d.show_readout||"bottom"===d.x_scrollbar_location;f>e.r&&l?(h="YPAN",d.lg_colorbar&&2===d.lyr[0].hcb["class"]?c=f>e.r+100?!0:!1:(e.xpos=
d.pyl+k.trunc(d.pthk/2),c=!0)):n&&p&&s?(h="XPAN",e.ypos=d.pt+k.trunc(d.pthk/2),c=!0):!n&&p&&g&&(h="XPAN",e.ypos=d.pt+k.trunc(d.pthk/2),c=!0);return{inPanRegion:c,command:h}}function v(a){var b=!1;a=a._Mx;var c=a.xpos,d=a.ypos,e=a.text_h,f=a.text_w,l=" ";c<a.l-f&&d<=a.b&&d>=a.t?(l="YCENTER",b=!0):d>a.b+k.trunc(0.5*f)&&d<=a.b+k.trunc(k.trunc(3*e)/2)&&c>=a.l&&c<=a.r&&(l="XCENTER",b=!0);return{inCenterRegion:b,command:l}}function C(a,b){var c,d,e;b.origin&1?(e=a.x-b.x,b.origin&2&&(e=b.w-e)):(e=a.y-b.y,
2>=b.origin&&(e=b.h-e));d=l.scroll_real2pix(b);c=d.s1;d=d.sw;return e>=c&&e<=c+d?!0:!1}function g(a,b,c){var d=a._Mx,e;"XPAN"===c?e=d.scrollbar_x:"YPAN"===c&&(e=d.scrollbar_y);e.action=b;e.step=0.1*e.srange;e.page=9*e.step;e.scale=2;l.scroll(d,e,l.XW_COMMAND,void 0,e);A(a,e.smin,e.smin+e.srange,c.slice(0,1));this.inPan=!0;a=document.createEvent("Event");"XPAN"===c?a.initEvent("xpan",!0,!0):"YPAN"===c&&a.initEvent("ypan",!0,!0);a.level=d.level;a.xmin=d.stk[d.level].xmin;a.ymin=d.stk[d.level].ymin;
a.xmax=d.stk[d.level].xmax;a.ymax=d.stk[d.level].ymax;l.dispatchEvent(d,a);this.inPan=!1}function A(a,b,c,d){var e=a._Mx,f=a._Gx,k=e.level;if("X"===d){if(e.stk[k].xmin!==b||e.stk[k].xmax!==c)e.stk[k].xmin=b,e.stk[k].xmax=c,f.xdata||1!==e.level||(f.xmin=e.stk[1].xmin,f.xmax=e.stk[1].xmax),a.refresh()}else"Y"!==d||b===e.stk[k].ymin&&c===e.stk[k].ymax||(e.stk[k].ymin=b,e.stk[k].ymax=c,f.cmode===f.basemode&&1===e.level&&(f.ymin=Math.min(f.ymin,b),f.ymax=Math.max(f.ymax,c)),a.refresh())}var q=R("spin"),
u=R("./common"),W=R("./bluefile"),k=R("./m"),l=R("./mx"),s=R("./sigplot.layer1d"),fa=R("./sigplot.layer2d");b.bluefile=W;b.m=k;b.mx=l;b.Layer1D=s;b.Layer2D=fa;var ha="Keypress Table:\n--------------\n?       - Main help box.\nA       - Toggle display x,y readouts:\n          (absc) -> (index) -> (1/absc) -> (time).\nB       - Toggle LM Drag Mode:\n          (box) -> (horizontal) -> (vertical).\nC       - Toggle controls.\nK       - Show Marker.\nL       - Toggle legend.\nM       - Pops up main menu\nR       - Toggle display specs (x/y readout)\nS       - Toggle display specs and axes.\nT       - Popup box with timecode value at mouse.\nX       - In 1D mode, popup box with X value at mouse.\n        - In 2D mode, toggle x-cut display.\nY       - In 1D mode, popup box with Y value at mouse.\n        - In 2D mode, toggle y-cut display.\nP       - In 2D mode, displays p-cuts along side and bottom.\nF       - Toggle fullscreen.\nCntrl+I - Invert colors.";
b.browserIsCompatible=function(){var a=document.createElement("canvas").getContext?!0:!1,b="ArrayBuffer"in window;return a&&b};b.Plot=function(x,J){if(!b.browserIsCompatible())throw"Browser is not compatible";var s=this._Mx=l.open(x);this._Gx=new e;this._Gx.parent=x;this.mouseOnCanvas=!1;J||(J={});f(this,J);this._refresh();this.onmousemove=function(a){return function(b){var c=a._Mx,d=a._Gx,e=b.target.getBoundingClientRect(),f=void 0===b.offsetX?b.pageX-e.left-window.scrollX:b.offsetX;b=void 0===b.offsetX?
b.pageY-e.top-window.scrollY:b.offsetY;e=X(a,f,b);d.retx=e.x;d.rety=e.y;c.widget||(B(a),e=document.createEvent("Event"),e.initEvent("mmove",!0,!0),e.xpos=f,e.ypos=b,e.x=d.retx,e.y=d.rety,l.dispatchEvent(c,e)&&(d.cross&&(c.warpbox?(void 0!==d.cross_xpos&&l.rubberline(c,d.cross_xpos,c.t,d.cross_xpos,c.b),void 0!==d.cross_ypos&&l.rubberline(c,c.l,d.cross_ypos,c.r,d.cross_ypos),d.cross_xpos=void 0,d.cross_ypos=void 0):a.mouseOnCanvas&&(G(a),d.p_cuts&&2===d.lyr[0].hcb["class"]&&(d.y_cut_press_on||d.x_cut_press_on||
w(a)))),2===d.cntrls&&(e=document.createEvent("Event"),e.initEvent("mtag",!0,!0),e.x=d.retx,e.y=d.rety,e.xpos=f,e.ypos=b,l.dispatchEvent(c,e))))}}(this);this.throttledOnMouseMove=k.throttle(this._Gx.scroll_time_interval,this.onmousemove);l.addEventListener(s,"mousemove",this.throttledOnMouseMove,!1);this.onmouseout=function(a){return function(b){b=a._Gx;var c=a._Mx;a.mouseOnCanvas&&(a.mouseOnCanvas=!1,b.autohide_readout&&B(a),b.autohide_panbars&&ca(a),c.prompt&&c.prompt.input.enableBlur())}}(this);
l.addEventListener(s,"mouseout",this.onmouseout,!1);this.onmouseover=function(a){return function(b){b=a._Gx;var c=a._Mx;a.mouseOnCanvas=!0;b.autohide_panbars&&ca(a);c.prompt&&c.prompt.input.disableBlur()}}(this);l.addEventListener(s,"mouseover",this.onmouseover,!1);this.onmousedown=function(a){return function(b){b.preventDefault();var d=a._Mx,e=a._Gx;d.widget&&"ONESHOT"===d.widget.type&&(d.widget=null,a.refresh());l.ifevent(d,b);var f=document.createEvent("Event");f.initEvent("mdown",!0,!0);f.xpos=
d.xpos;f.ypos=d.ypos;f.x=e.retx;f.y=e.rety;f.which=b.which;if(!l.dispatchEvent(d,f))return!1;var x=K(a);if(x.inPanRegion){if(b.preventDefault()," "!==x.command){var g=null,f=null;"XPAN"===x.command?g=d.scrollbar_x:"YPAN"===x.command&&(g=d.scrollbar_y);if(2===b.which)f={x:d.xpos,y:d.ypos},void 0!==g&&C(f,g)&&c(a,x.command);else if(" "!==x.command&&(f={x:d.xpos,y:d.ypos},!C(f,g)&&1===b.which)){Y(a,x.command,0,b);var J=function(){C({x:d.xpos,y:d.ypos},g)?e.stillPanning&&(window.clearInterval(e.stillPanning),
e.repeatPanning=void 0):Y(a,x.command,0,b)};e.stillPanning=window.setTimeout(function(){e.repeatPanning=window.setInterval(J,50)},250)}}}else if(1===b.which||3===b.which){f=!1;e.legendBtnLocation&&(f=p(d.xpos,d.ypos,e.legendBtnLocation.x,e.legendBtnLocation.y,e.legendBtnLocation.width,e.legendBtnLocation.height));if(e.lg_colorbar&&2===e.lyr[0].hcb["class"]&&(1===b.which||3===b.which)){var s=d.xpos,q=d.ypos,m=e.cbb_top_x1,r=e.cbb_top_y1;if(F(s,q,m,r,m+e.cbb_width,r,m+0.5*e.cbb_width,r-e.cbb_height)){m=
e.cmap;a.get_layer(0).img=void 0;console.log(k.Mc.colormap[m]);m=k.Mc.colormap[m];for(r=0;r<m.colors.length;r++)m.colors[r].pos+=5;l.colormap(d,m.colors,16);a.refresh()}m=e.cbb_bot_x1;r=e.cbb_bot_y1;if(F(s,q,m,r,m+e.cbb_width,r,m+0.5*e.cbb_width,r+e.cbb_height)){m=e.cmap;m=k.Mc.colormap[m];a.get_layer(0).img=void 0;for(r=0;r<m.colors.length;r++)m.colors[r].pos-=5;l.colormap(d,m.colors,16);a.refresh()}}f?a.change_settings({legend:!e.legend}):(B(a),f={opacity:0,return_value:"zoom"},s={opacity:0.4,fill_color:d.hi,
return_value:"select"},1===b.which?"zoom"===e.default_rubberbox_action?l.rubberbox(d,n(a,b.which),e.default_rubberbox_mode,f,s):"select"===e.default_rubberbox_action&&l.rubberbox(d,n(a,b.which),e.default_rubberbox_mode,s,f):3===b.which&&("zoom"===e.default_rightclick_rubberbox_action?l.rubberbox(d,n(a,b.which),e.default_rightclick_rubberbox_mode,f,s):"select"===e.default_rightclick_rubberbox_action&&l.rubberbox(d,n(a,b.which),e.default_rightclick_rubberbox_mode,s,f)))}else 2===b.which&&(e.nomenu||
h(a));return!1}}(this);l.addEventListener(s,"mousedown",this.onmousedown,!1);this.ontouchstart=function(a){return function(b){b.preventDefault();if(1===b.targetTouches.length)if(s.touchClear&&s.touches)window.clearTimeout(s.touchClear),a.unzoom(),g(a,l.SB_FULL,"XPAN"),g(a,l.SB_FULL,"YPAN");else{var c=b.targetTouches[0],d=c.target.getBoundingClientRect(),c={x:c.pageX-d.left-window.scrollX,y:c.pageY-d.top-window.scrollY};s.xpos=k.bound(c.x,0,s.width);s.ypos=k.bound(c.y,0,s.height);K(a,c).inPanRegion||
(s.touches=b.targetTouches)}else 2===b.targetTouches.length&&(s.touch_distance=k.touch_distance(b.targetTouches[0],b.targetTouches[1]))}}(this);l.addEventListener(s,"touchstart",this.ontouchstart,!1);this.ontouchmove=function(a){return function(b){var c=a._Mx,d=a._Gx,e=c.level;b.preventDefault();if(1===b.targetTouches.length){var f=c.touches[0].target.getBoundingClientRect();b=b.targetTouches[0];f=b.target.getBoundingClientRect();b={x:b.pageX-f.left-window.scrollX,y:b.pageY-f.top-window.scrollY};
var l=k.bound(b.x,0,c.width),x=k.bound(b.y,0,c.height),h=l-c.xpos,f=x-c.ypos;c.xpos=l;c.ypos=x;K(a,b).inPanRegion||(b=c.stk[e].xscl*h,x=c.stk[e].yscl*f,1===c.origin?b*=-1:2===c.origin?x*=-1:3===c.origin?x*=-1:4===c.origin&&(b*=-1,x*=-1),f=c.stk[e].xmin+b,b=c.stk[e].xmax+b,l=c.stk[e].ymin+x,x=c.stk[e].ymax+x,f>=d.xmin&&b<=d.xmax&&(c.stk[e].xmin=f,c.stk[e].xmax=b),l>=d.ymin&&x<=d.ymax&&(c.stk[e].ymin=l,c.stk[e].ymax=x),d.cmode===d.basemode&&1===c.level&&(d.xmin=Math.min(d.xmin,f),d.xmax=Math.max(d.xmax,
b),d.ymin=Math.min(d.ymin,l),d.ymax=Math.max(d.ymax,x)),a.refresh())}else 2===b.targetTouches.length&&(f=k.touch_distance(b.targetTouches[0],b.targetTouches[1]),x=0.05*(1-c.touch_distance/f),b=c.stk[e].xmax-c.stk[e].xmin,h=c.stk[e].ymax-c.stk[e].ymin,f=c.stk[e].xmin+x*b,b=c.stk[e].xmax-x*b,l=c.stk[e].ymin+x*h,x=c.stk[e].ymax-x*h,c.stk[e].xmin=Math.max(d.xmin,f),c.stk[e].xmax=Math.min(d.xmax,b),c.stk[e].ymin=Math.max(d.ymin,l),c.stk[e].ymax=Math.min(d.ymax,x),a.refresh())}}(this);this.throttledOnTouchMove=
k.throttle(this._Gx.scroll_time_interval,this.ontouchmove);l.addEventListener(s,"touchmove",this.throttledOnTouchMove,!1);this.ontouchend=function(a){return function(b){var c=a._Gx,d=a._Mx;b.preventDefault();console.log("on touch end ",b.targetTouches.length);c.panning=void 0;a._Mx.scrollbar_x.action=0;a._Mx.scrollbar_y.action=0;d.touch_distance=void 0;l.widget_callback(d,b);d.touchClear=window.setTimeout(function(){d.touches=void 0;d.touchClear=void 0},100)}}(this);l.addEventListener(s,"touchend",
this.ontouchend,!1);this.docMouseUp=function(a){return function(b){var c=a._Gx;1===b.which&&(c.panning=void 0,a._Mx.scrollbar_x.action=0,a._Mx.scrollbar_y.action=0);c.stillPanning&&(window.clearTimeout(c.stillPanning),c.stillPanning=void 0);c.repeatPanning&&(window.clearInterval(c.repeatPanning),c.repeatPanning=void 0);return!1}}(this);document.addEventListener("mouseup",this.docMouseUp,!1);this.mouseup=function(a){return function(b){b.preventDefault();var c=a._Gx,d=a._Mx;l.ifevent(a._Mx,b);var e=
document.createEvent("Event");e.initEvent("mup",!0,!0);e.xpos=d.xpos;e.ypos=d.ypos;e.x=c.retx;e.y=c.rety;e.which=b.which;if((e=l.dispatchEvent(d,e))&&!(d.warpbox||d.widget||d.prompt))if(1===b.which)e=v(a),e.inCenterRegion?" "!==e.command&&Y(a,e.command,0,b):1===c.cntrls&&(c.xmrk=c.retx,c.ymrk=c.rety,e=document.createEvent("Event"),e.initEvent("mtag",!0,!0),e.x=c.xmrk,e.y=c.ymrk,e.xpos=b.x||b.clientX,e.ypos=b.y||b.clientY,e.w=void 0,e.h=void 0,e.shift=b.shiftKey,l.dispatchEvent(d,e),(c.always_show_marker||
c.show_marker)&&a.redraw());else if(2===b.which){if(c.nomenu&&(e=document.createEvent("Event"),e.initEvent("showmenu",!0,!0),e.x=b.x||b.clientX,e.y=b.y||b.clientY,e=l.dispatchEvent(d,e))){b.stopPropagation&&b.stopPropagation();b.cancelBubble=!0;l.removeEventListener(d,"mousedown",a.onmousedown,!1);var f=function(){try{var b=document.createEvent("Event");b.initEvent("hidemenu",!0,!0);l.dispatchEvent(d,b)&&l.addEventListener(d,"mousedown",a.onmousedown,!1)}finally{document.removeEventListener("mouseup",
f,!1)}};document.addEventListener("mouseup",f,!1)}}else 3===b.which&&(b.preventDefault(),a.unzoom(1),a.refresh())}}(this);l.addEventListener(s,"mouseup",this.mouseup,!1);this.mouseclick=function(a){return function(b){b.preventDefault();var c=a._Gx,d=a._Mx;l.ifevent(a._Mx,b);var e=document.createEvent("Event");e.initEvent("mclick",!0,!0);e.xpos=d.xpos;e.ypos=d.ypos;e.x=c.retx;e.y=c.rety;e.which=b.which;l.dispatchEvent(d,e);return!1}}(this);l.addEventListener(s,"click",this.mouseclick,!1);this.mousedblclick=
function(a){return function(b){b.preventDefault();var c=a._Gx,d=a._Mx;l.ifevent(a._Mx,b);var e=document.createEvent("Event");e.initEvent("mdblclick",!0,!0);e.xpos=d.xpos;e.ypos=d.ypos;e.x=c.retx;e.y=c.rety;e.which=b.which;l.dispatchEvent(d,e);return!1}}(this);l.addEventListener(s,"dblclick",this.mousedblclick,!1);this.dragMouseDownHandler=function(a){return function(b){var c=a._Mx,d=a._Gx,e=K(a);if(e.inPanRegion&&(b.preventDefault()," "!==e.command)){var f;"XPAN"===e.command?f=c.scrollbar_x:"YPAN"===
e.command&&(f=c.scrollbar_y);var k={x:c.xpos,y:c.ypos};void 0!==f&&C(k,f)&&1===b.which&&(d.panning={axis:e.command,xpos:b.screenX,ypos:b.screenY,xmin:c.stk[c.level].xmin,xmax:c.stk[c.level].xmax,ymin:c.stk[c.level].ymin,ymax:c.stk[c.level].ymax})}}}(this);window.addEventListener("mousedown",this.dragMouseDownHandler,!1);this.dragMouseMoveHandler=function(a){return function(b){var c=a._Gx;if(void 0!==c.panning)try{$(a,c.panning.axis,b)}catch(d){console.log("Error: "+d)}}}(this);this.throttledDragOnMouseMove=
k.throttle(this._Gx.scroll_time_interval,this.dragMouseMoveHandler);window.addEventListener("mousemove",this.throttledDragOnMouseMove,!1);this.dragMouseUpHandler=function(a){return function(b){var c=a._Gx;1===b.which&&(c.panning=void 0)}}(this);window.addEventListener("mouseup",this.dragMouseUpHandler,!1);this.onresize=function(a){return function(b){l.checkresize(a._Mx)&&a.refresh()}}(this);this.wheelHandler=function(a){var b=a._Mx,c=a._Gx,d=k.throttle(100,function(d){var e;"XPAN"===d.command?e=b.scrollbar_x:
"YPAN"===d.command&&(e=b.scrollbar_y);e.action=c.wheelscroll_mode_natural?0>event.deltaY?l.SB_WHEELDOWN:l.SB_WHEELUP:0>event.deltaY?l.SB_WHEELUP:l.SB_WHEELDOWN;e.step=0.1*e.srange;e.page=9*e.step;l.scroll(b,e,l.XW_COMMAND,void 0,e);A(a,e.smin,e.smin+e.srange,d.command.slice(0,1))}),e=k.throttle(100,function(){var b=c.wheelZoomPercent||0.2;c.wheelscroll_mode_natural?0<event.deltaY&&(b*=-1):0>event.deltaY&&(b*=-1);"x"===c.wheelZoom?a.percent_zoom(b,1,!0):"y"===c.wheelZoom?a.percent_zoom(1,b,!0):a.percent_zoom(b,
b,!0)});return function(f){l.ifevent(b,f);var k=K(a);a.mouseOnCanvas&&(f.preventDefault(),k.inPanRegion?d(k):c.wheelZoom&&e())}}(this);window.addWheelListener(window,this.wheelHandler,!1);window.addEventListener("resize",this.onresize,!1);J.nokeypress||(this.onkeypress=function(b){return function(c){var e=b._Mx,f=b._Gx;if(b.mouseOnCanvas&&(!e.widget||"MENU"!==e.widget.type))if(e.widget&&"ONESHOT"===e.widget.type)e.widget=null,b.refresh();else{var x=u.getKeyCode(c),g=document.createEvent("Event");
g.initEvent("plotkeypress",!0,!0);g.keyCode=x;g.shiftKey=c.shiftKey;g.ctrlKey=c.ctrlKey;g.altKey=c.altKey;g.metaKey=c.metaKey;if(g=l.dispatchEvent(e,g))if(97===x)f.iabsc=(f.iabsc+1)%4,B(b);else if(108===x)b.change_settings({legend:!f.legend});else if(103===x)b.change_settings({grid:!f.grid});else if(98===x||2===x)e.warpbox&&(e.warpbox.mode="box"===e.warpbox.mode?"horizontal":"horizontal"===e.warpbox.mode?"vertical":"box",l.redraw_warpbox(e));else if(99===x)b.change_settings({xcnt:-1*f.cntrls});else if(114===
x)b.change_settings({show_readout:!f.show_readout});else if(115===x)b.change_settings({specs:!f.specs});else if(112===x)1!==f.lyr[0].hcb["class"]&&(f.p_press=!0,b.change_settings({p_cuts:!f.p_cuts}));else if(120===x)if(f.x_cut_press_on){f.x_cut_press_on=!1;f.ylabel=f.ylabel_stash;f.xlabel=f.xlabel_stash;for(e=0;e<f.xcut_layer;e++)b._Gx.lyr[e].display=!b._Gx.lyr[e].display;y(b,b._Gx.xcut_layer);b.rescale();b.refresh();f.xcut_layer=void 0}else if("pop-up"===f.xyKeys)f.x_pop_now?f.x_pop_now=!1:(a(b),
f.x_pop_now=!0);else if(1===f.lyr[0].hcb["class"]&&"automatic"===f.xyKeys)f.x_pop_now?f.x_pop_now=!1:(a(b),f.x_pop_now=!0);else{if("disable"!==f.xyKeys&&2===f.lyr[0].hcb["class"]&&!f.y_cut_press_on){f.p_cuts||(f.x_cut_data=[],g=e.r-e.l,x=f.lyr[0].yframe,c=f.lyr[0].xframe,e=Math.floor(x*(e.ypos-e.t)/(e.b-e.t))*c,f.x_cut_data=f.lyr[0].zbuf.slice(e,e+c));e=[];for(c=0;c<f.x_cut_data.length;c++)x=f.x_cut_data[c],x*=-1,e.push(x);f.ylabel_stash=f.ylabel;c=0<f.lyr.length&&f.lyr[0].cx;f.ylabel=1===f.cmode?
k.UNITS[28][0]:2===f.cmode?f.plab:3===f.cmode&&c?k.UNITS[21][0]:4===f.cmode?k.UNITS[22][0]:5===f.cmode?k.UNITS[22][0]:6===f.cmode?k.UNITS[26][0]:7===f.cmode?k.UNITS[27][0]:"Intensity";f.xlabel_stash=f.xlabel;f.xlabel="None"!==k.UNITS[f.xlab][0]&&"Unknown"!==k.UNITS[f.xlab][0]?k.UNITS[f.xlab][0]:"Frequency";f.xlabel+="    CURRENTLY IN X_CUT MODE";f.xcut_layer=b.overlay_array(e,null,{name:"x_cut_data",line:3});f.xcut_layer=f.lyr.length-1;for(e=0;e<f.xcut_layer;e++)b._Gx.lyr[e].display=!b._Gx.lyr[e].display;
f.x_cut_press_on=!0;b.rescale()}}else if(121===x)if(f.y_cut_press_on){f.y_cut_press_on=!1;f.ylabel=f.ylabel_stash;f.xlabel=f.xlabel_stash;for(e=0;e<f.ycut_layer;e++)b._Gx.lyr[e].display=!b._Gx.lyr[e].display;y(b,b._Gx.ycut_layer);b.rescale();b.refresh();f.ycut_layer=void 0}else if("pop-up"===f.xyKeys)f.y_pop_now?f.y_pop_now=!1:(d(b),f.y_pop_now=!0);else if(1===f.lyr[0].hcb["class"]&&"automatic"===f.xyKeys)f.y_pop_now?f.y_pop_now=!1:(d(b),f.y_pop_now=!0);else{if("disable"!==f.xyKeys&&2===f.lyr[0].hcb["class"]&&
!f.x_cut_press_on){if(!f.p_cuts)for(g=e.r-e.l,x=f.lyr[0].yframe,c=f.lyr[0].xframe,f.y_cut_data=[],e=Math.floor(c*(e.xpos-e.l)/g);e<c*x;e+=c)f.y_cut_data.push(f.lyr[0].zbuf[e]);e=[];for(c=0;c<f.y_cut_data.length;c++)x=f.y_cut_data[c],x*=-1,e.push(x);f.ylabel_stash=f.ylabel;c=0<f.lyr.length&&f.lyr[0].cx;f.ylabel=1===f.cmode?k.UNITS[28][0]:2===f.cmode?f.plab:3===f.cmode&&c?k.UNITS[21][0]:4===f.cmode?k.UNITS[22][0]:5===f.cmode?k.UNITS[22][0]:6===f.cmode?k.UNITS[26][0]:7===f.cmode?k.UNITS[27][0]:"Intensity";
f.xlabel_stash=f.xlabel;f.xlabel="None"!==k.UNITS[f.ylab][0]&&"Unknown"!==k.UNITS[f.ylab][0]?k.UNITS[f.ylab][0]:"Time";f.xlabel+="    CURRENTLY IN Y_CUT MODE";f.ycut_layer=b.overlay_array(e,null,{name:"y_cut_data",line:3});f.ycut_layer=f.lyr.length-1;for(e=0;e<f.ycut_layer;e++)b._Gx.lyr[e].display=!b._Gx.lyr[e].display;f.y_cut_press_on=!0;b.rescale()}}else 122===x?(f=b._Gx,e=b._Mx,f.zmin&&f.zmax&&(c="",c=1===f.lyr.length?"Z = "+f.lyr[0].get_z(f.retx,f.rety).toString():"TODO",l.message(e,c))):116===
x?(f=b._Gx,e=b._Mx,0<f.lyr.length&&(c=f.lyr[0].hcb,1!==c["class"]||1!==c.xunits&&4!==c.xunits?2!==c["class"]||1!==c.yunits&&4!==c.yunits?l.message(e,"Time = UNK"):l.message(e,"Time = "+k.sec2tod(c.timecode+f.rety),!0):l.message(e,"Time = "+k.sec2tod(c.timecode+f.retx),!0))):109===x?f.nomenu||(g=document.createEvent("Event"),g.initEvent("showmenu",!0,!0),g.x=e.x,g.y=e.y,(g=l.dispatchEvent(e,g))&&h(b)):63===x?l.message(e,"To zoom, press and drag the left mouse (LM) over the region of interest and release. To unzoom, press right mouse (RM).  Press the middle mouse (MM) button or press the 'M' key to open the main menu.View the function of all keypresses by selecting 'Keypress Info' from the main menu."):
102===x?(c=0,f.p_cuts&&(b.change_settings({p_cuts:!f.p_cuts}),c=1),l.fullscreen(e),b.refresh(),1===c&&b.change_settings({p_cuts:!f.p_cuts})):9===x&&c.ctrlKey?b.change_settings({invert:null}):107===x&&(f.show_marker=!f.show_marker,b.redraw())}}}(this),u.setKeypressHandler(this.onkeypress));return this};b.Plot.prototype={add_plugin:function(a,b){void 0===b&&(b=Number.MAX_VALUE);if(0>=b)throw"Invalid plugin zorder";a.init(this);var c=document.createElement("canvas");c.width=this._Mx.canvas.width;c.height=
this._Mx.canvas.height;this._Gx.plugins.push({impl:a,zorder:b,canvas:c});this._Gx.plugins.sort(function(a,b){return a.zorder-b.zorder});this.refresh()},remove_plugin:function(a){for(var b=this._Gx.plugins.length;b--;)this._Gx.plugins[b].impl===a&&(a.dispose&&a.dispose(),this._Gx.plugins[b].canvas.parentNode&&this._Gx.plugins[b].canvas.parentNode.removeElement(this._Gx.plugins[b].canvas),this._Gx.plugins.splice(b,1));this._Gx.plugins.sort(function(a,b){return a.zorder-b.zorder});this.refresh()},addListener:function(a,
b){l.addEventListener(this._Mx,a,b,!1)},removeListener:function(a,b){l.removeEventListener(this._Mx,a,b,!1)},change_settings:function(a){for(var b=this._Gx,c=this._Mx,d=0;d<b.lyr.length;d++)b.lyr[d].change_settings(a);void 0!==a.xyKeys&&(b.xyKeys=null===a.xyKeys?"automatic":a.xyKeys);void 0!==a.grid&&(b.grid=null===a.grid?!b.grid:a.grid);void 0!==a.gridBackground&&(b.gridBackground=a.gridBackground);void 0!==a.gridStyle&&(b.gridStyle=a.gridStyle);void 0!==a.wheelZoom&&(b.wheelZoom=a.wheelZoom);void 0!==
a.wheelZoomPercent&&(b.wheelZoomPercent=a.wheelZoomPercent);void 0!==a.autol&&(b.autol=a.autol);void 0!==a.index&&a.index!==b.index&&(b.index=null===a.index?!b.index:a.index,b.index&&1!==b.iabsc?b.iabsc=1:b.index||1!==b.iabsc||(b.iabsc=0),I(this,{get_data:!1},void 0,void 0),this.unzoom());void 0!==a.all&&(b.all=null===a.all?!b.all:a.all);void 0!==a.show_x_axis&&(b.show_x_axis=null===a.show_x_axis?!b.show_x_axis:a.show_x_axis,b.specs=b.show_x_axis||b.show_y_axis||b.show_readout);void 0!==a.show_y_axis&&
(b.show_y_axis=null===a.show_y_axis?!b.show_y_axis:a.show_y_axis,b.specs=b.show_x_axis||b.show_y_axis||b.show_readout);void 0!==a.show_readout&&(b.show_readout=null===a.show_readout?!b.show_readout:a.show_readout,b.specs=b.show_x_axis||b.show_y_axis||b.show_readout);void 0!==a.specs&&(b.specs=null===a.specs?!b.specs:a.specs,b.specs?(b.show_x_axis=!0,b.show_y_axis=!0,b.show_readout=!0):(b.show_x_axis=!1,b.show_y_axis=!1,b.show_readout=!1));void 0!==a.xcnt&&(b.cntrls="leftmouse"===a.xcnt?1:"continuous"===
a.xcnt?2:"disable"===a.xcnt&&0<b.cntrls?-1*b.cntrls:"enable"===a.xcnt&&0>b.cntrls?-1*b.cntrls:a.xcnt);void 0!==a.legend&&(b.legend=null===a.legend?!b.legend:a.legend);void 0!==a.pan&&(b.pan=null===a.pan?!b.pan:a.pan);void 0!==a.cross&&(b.cross=null===a.cross?!b.cross:a.cross,b.cross?(b.cross_xpos=void 0,b.cross_ypos=void 0,!c.warpbox&&this.mouseOnCanvas&&G(this)):(void 0!==b.cross_xpos&&l.rubberline(c,b.cross_xpos,c.t,b.cross_xpos,c.b),void 0!==b.cross_ypos&&l.rubberline(c,c.l,b.cross_ypos,c.r,b.cross_ypos),
b.cross_xpos=void 0,b.cross_ypos=void 0));void 0!==a.cmode&&T(this,a.cmode);if(void 0!==a.phunits){var e=a.phunits,d=this._Gx,f=this._Mx,k=d.plab;"R"===e?k=23:"D"===e&&(k=24);"C"===e&&(k=25);if(k!==d.plab&&(e=[Math.PI,180,0.5],e=e[k-23]/e[d.plab-23],d.plab=k,2===d.cmode)){for(k=0;k<=f.level;k++)f.stk[k].ymin*=e,f.stk[k].ymax*=e,f.stk[k].yscl*=e;d.panymin*=e;d.panymax*=e;this.refresh()}}void 0!==a.rubberbox_action&&(b.default_rubberbox_action=a.rubberbox_action);void 0!==a.rubberbox_mode&&(b.default_rubberbox_mode=
a.rubberbox_mode);void 0!==a.rightclick_rubberbox_action&&(b.default_rightclick_rubberbox_action=a.rightclick_rubberbox_action);void 0!==a.rightclick_rubberbox_mode&&(b.default_rightclick_rubberbox_mode=a.rightclick_rubberbox_mode);void 0!==a.wheelscroll_mode_natural&&(b.wheelscroll_mode_natural=a.wheelscroll_mode_natural);void 0!==a.colors&&(a.colors.fg||(a.colors.fg=c.fg),a.colors.bg||(a.colors.bg=c.bg),l.setbgfg(c,a.colors.bg,a.colors.fg,c.xi));void 0!==a.cmap&&(b.cmap=null===a.cmap?2===b.cmode?
2:1:a.cmap,m(this,b.cmap));void 0!==a.yinv&&(c.origin=a.yinv?4:1);void 0!==a.rasterSmoothing&&(b.rasterSmoothing=null===a.rasterSmoothing?!b.rasterSmoothing:a.rasterSmoothing);void 0!==a.fillStyle&&(b.fillStyle=a.fillStyle);void 0!==a.invert&&(null===a.invert?l.invertbgfg(c):!0===a.invert?l.setbgfg(this,"white","black"):l.setbgfg(this,"black","white"));void 0!==a.nomenu&&(b.nomenu=null===a.nomenu?!b.nomenu:a.nomenu);void 0!==a.ymax&&(null===a.ymax?(b.autoy|=2,b.panymax=void 0,I(this,{}),b.ymax=b.panymax):
(b.autoy&=13,b.ymax=a.ymax,A(this,c.stk[0].ymin,a.ymax,"Y")));void 0!==a.ymin&&(null===a.ymin?(b.autoy|=1,b.panymin=void 0,I(this,{}),b.ymin=b.panymin):(b.autoy&=14,b.ymin=a.ymin,A(this,a.ymin,c.stk[0].ymax,"Y")));void 0!==a.autoy&&(b.autoy=a.autoy,0!==(b.autoy&1)&&(b.ymin=void 0),0!==(b.autoy&2)&&(b.ymax=void 0));void 0!==a.xmin&&A(this,a.xmin,c.stk[0].xmax,"X");void 0!==a.xmax&&A(this,c.stk[0].xmin,a.xmax,"X");void 0!==a.zmin&&(b.zmin=a.zmin,b.autoz&=2);void 0!==a.zmax&&(b.zmax=a.zmax,b.autoz&=
1);void 0!==a.autoz&&(b.autoz=a.autoz,0!==(b.autoz&1)&&(b.zmin=void 0),0!==(b.autoz&2)&&(b.zmax=void 0));void 0!==a.note&&(b.note=a.note);void 0!==a.lg_colorbar&&(b.lg_colorbar=!b.lg_colorbar);void 0!==a.p_cuts&&(b.p_cuts=!b.p_cuts,!1===b.p_cuts&&(null===b.element1.parentNode&&document.getElementById(this._Gx.parent.id).appendChild(this._Gx.element1),null===b.element2.parentNode&&document.getElementById(this._Gx.parent.id).appendChild(this._Gx.element2),b.element1.parentNode.removeChild(b.element1),
b.element2.parentNode.removeChild(b.element2),b.ycut=void 0,b.xcut=void 0),b.parent.setAttribute("style","position:relative"));void 0!==a.xcut_now&&(b.xcut_now=!b.xcut_now);void 0!==a.ycut_now&&(b.ycut_now=!b.ycut_now);this.refresh();void 0!==a.pan&&B(this)},reread:function(){for(var a=this._Gx,b=[],c=0;c<a.lyr.length;c++)b[c]=a.lyr[c];c=a.HCB.slice();this.deoverlay();for(var d=0;d<c.length;d++)this.overlay_bluefile(c[d]);for(c=0;c<a.lyr.length;c++)a.lyr[c].symbol=b[c].symbol,a.lyr[c].radius=b[c].radius;
this.refresh();a=document.createEvent("Event");a.initEvent("reread",!0,!0);l.dispatchEvent(this._Mx,a)},cleanup:function(){},reload:function(a,b,c,d){var e=this._Mx,f=this._Gx;0>a||a>=f.lyr.length||void 0===f.lyr[a].reload||(a=f.lyr[a].reload(b,c),0===e.level&&I(this,{get_data:!1},a.xmin,a.xmax),d?this._refresh():this.refresh())},rescale:function(){0===this._Mx.level&&I(this,{get_data:!1},void 0,void 0);this.refresh()},push:function(a,b,c,d,e){var f=this._Mx,k=this._Gx;0>a||a>=k.lyr.length||void 0===
k.lyr[a].push||(a=k.lyr[a].push(b,c,d),0===f.level&&a&&I(this,{get_data:!1}),e?this._refresh():this.refresh())},overlay_array:function(a,b,c){k.log.debug("Overlay array");a=k.initialize(a,b);return this.overlay_bluefile(a,c)},overlay_pipe:function(a,b){k.log.debug("Overlay pipe");a||(a={});a.pipe=!0;var c=k.initialize(null,a);return this.overlay_bluefile(c,b)},overlay_websocket:function(a,b,c){k.log.debug("Overlay websocket: "+a);a=new WebSocket(a,"plot-data");a.binaryType="arraybuffer";var d=this;
b||(b={});b.pipe=!0;var e=k.initialize(null,b);e.ws=a;var f=this.overlay_bluefile(e,c);a.onopen=function(a){};a.onmessage=function(a){return function(a){a.data instanceof ArrayBuffer?(a=e.createArray(a.data),d.push(f,a)):"string"===typeof a.data&&(d._Gx.lyr[f].hcb||k.log.warning("Couldn't find header for layer "+f),a=JSON.parse(a.data),d.push(f,[],a))}}(a);return f},overlay_href:function(a,b,c){k.log.debug("Overlay href: "+a);try{this.show_spinner();var d=function(a,b){return function(d){try{if(d){var e=
a.overlay_bluefile(d,c);b&&b(d,e)}else alert("Failed to load data")}finally{a.hide_spinner()}}}(this,b);(new W.BlueFileReader).read_http(a,d)}catch(e){console.log(e),alert("Failed to load data"),this.hide_spinner()}},show_spinner:function(){this._Gx.spinner||(ga.color=this._Mx.xwfg,this._Gx.spinner=(new q(ga)).spin(this._Gx.parent))},hide_spinner:function(){this._Gx.spinner&&this._Gx.spinner.stop();this._Gx.spinner=void 0},add_layer:function(a){var b=this._Gx,c=this._Mx,d=document.createEvent("Event");
d.initEvent("lyradd",!0,!0);d.index=b.lyr.length;d.name=a.name;d.layer=a;l.dispatchEvent(c,d)&&b.lyr.push(a)},get_layer:function(a){var b=this._Gx;return 0<=a&&a<b.lyr.length?b.lyr[a]:null},overlay_bluefile:function(a,b){k.log.debug("Overlay bluefile: "+a.file_name);var c=this._Mx,d=this._Gx;b=b||{};var e=0===d.HCB.length;d.HCB.push(a);1===d.HCB.length&&z(this,!0);var f=d.lyr.length;void 0===b.layerType?1===a["class"]?s.overlay(this,a,b):2===a["class"]&&fa.overlay(this,a,b):"1D"===b.layerType?s.overlay(this,
a,b):"2D"===b.layerType?fa.overlay(this,a,b):b.layerType.overlay(this,a,b);T(this,d.cmode);if(e||b.expand)if(0===d.HCB.length)z(this,!1);else{d.basemode=d.cmode;var l,g;0===(d.autox&&1)&&(l=d.xmin);0===(d.autox&&2)&&(g=d.xmin);I(this,{get_data:!0},l,g);c.level=0;0!==(d.autox&&1)&&(d.xmin=c.stk[0].xmin);0!==(d.autox&&2)&&(d.xmax=c.stk[0].xmax);0!==(d.autoy&&1)&&(d.ymin=c.stk[0].ymin);0!==(d.autoy&&2)&&(d.ymax=c.stk[0].ymax);c.resize=!0;c.origin=d.lyr[0].preferred_origin?d.lyr[0].preferred_origin:1}else for(c=
f;c<d.lyr.length;c++)D(this,c);E(this);this.refresh();return d.HCB.length-1},load_files:function(a,b){for(var c=function(a){return function(c){a.overlay_bluefile(c,b)}}(this),d=0;d<a.length;d++){var e=a[d];(new W.BlueFileReader).read(e,c)}},deoverlay:function(a){var b=this._Gx;if(0<b.HCB.length)if(void 0===a)for(a=b.HCB.length-1;0<=a;a--)this.remove_layer(a);else if(0>a){a=b.HCB.length+a;if(0>a)return;this.remove_layer(a)}else a<b.HCB.length&&this.remove_layer(a);0===b.lyr.length&&(z(this,!1),I(this,
{}))},remove_layer:function(a){var b=this._Gx,c="",d=null;if(0<=a&&a<b.HCB.length){c=b.HCB[a].file_name;d=b.HCB[a];for(b.HCB[a]=null;a<b.HCB.length-1;a++)b.HCB[a]=b.HCB[a+1];b.HCB.length-=1}for(a=b.lyr.length-1;0<=a;a--)b.lyr[a].hcb===d&&y(this,a);E(this);this.refresh();b=document.createEvent("Event");b.initEvent("file_deoverlayed",!0,!0);""!==c&&(b.fileName=c);l.dispatchEvent(this._Mx,b)},pixel_zoom:function(a,b,c,d,e){a=X(this,a,b);c=X(this,c,d);this.zoom(a,c,e)},percent_zoom:function(a,b,c){var d=
this._Mx,e=this._Gx,f=0;1>Math.abs(a)&&(f=Math.abs(d.stk[d.level].xmax-d.stk[d.level].xmin),f=f*a/2);a=0;1>Math.abs(b)&&(a=Math.abs(d.stk[d.level].ymax-d.stk[d.level].ymin),a=a*b/2);b={x:Math.max(d.stk[d.level].xmin+f,e.panxmin),y:Math.max(d.stk[d.level].ymin+a,e.panymin)};d={x:Math.min(d.stk[d.level].xmax-f,e.panxmax),y:Math.min(d.stk[d.level].ymax-a,e.panymax)};this.zoom(b,d,c)},zoom:function(a,b,c){var d=this._Mx,e=this._Gx;if(!(9<=d.level)){void 0===a.x&&(a.x=d.stk[d.level].xmin);void 0===a.y&&
(a.y=d.stk[d.level].ymin);void 0===b.x&&(b.x=d.stk[d.level].xmax);void 0===b.y&&(b.y=d.stk[d.level].ymax);if(b.x<a.x){var f=b.x;b.x=a.x;a.x=f}b.y<a.y&&(f=b.y,b.y=a.y,a.y=f);f={};f.xscl=d.stk[d.level].xscl;f.yscl=d.stk[d.level].yscl;f.xmin=a.x;f.xmax=b.x;f.ymin=a.y;f.ymax=b.y;e.index&&(f.xmin=Math.min(f.xmin/e.xdelta),f.xmax=Math.min(f.xmax/e.xdelta));c&&e.inContinuousZoom?d.stk[d.level]=f:(d.stk.push(f),d.level=d.stk.length-1);e.inContinuousZoom=c;this.inZoom=!0;a=document.createEvent("Event");a.initEvent("zoom",
!0,!0);a.level=d.level;a.inContinuousZoom=e.inContinuousZoom;a.xmin=d.stk[d.level].xmin;a.ymin=d.stk[d.level].ymin;a.xmax=d.stk[d.level].xmax;a.ymax=d.stk[d.level].ymax;l.dispatchEvent(d,a);this.inZoom=!1;this.refresh()}},unzoom:function(a){var b=this._Mx,c=this._Gx;if(0!==b.level){a||(a=b.stk.length);for(;0<a&&0!==b.level;)b.stk.pop(),b.level=b.stk.length-1,a-=1;0===b.level&&this.rescale();c.inContinuousZoom=!1;this.inZoom=!0;a=document.createEvent("Event");a.initEvent("unzoom",!0,!0);a.level=b.level;
a.xmin=b.stk[b.level].xmin;a.ymin=b.stk[b.level].ymin;a.xmax=b.stk[b.level].xmax;a.ymax=b.stk[b.level].ymax;l.dispatchEvent(b,a);this.inZoom=!1;this.refresh()}},mimic:function(a,b){var c=this;if(!b)throw"mimic must be called with at least one event mask";b.zoom?a.addListener("zoom",function(a){c.inZoom||c.zoom({x:a.xmin,y:a.ymin},{x:a.xmax,y:a.ymax},a.inContinuousZoom)}):b.xzoom?a.addListener("zoom",function(a){c.inZoom||c.zoom({x:a.xmin,y:void 0},{x:a.xmax,y:void 0},a.inContinuousZoom)}):b.yzoom&&
a.addListener("zoom",function(a){c.inZoom||c.zoom({x:void 0,y:a.ymin},{x:void 0,y:a.ymax},a.inContinuousZoom)});b.unzoom&&a.addListener("unzoom",function(a){c.inZoom||a.level<c._Mx.level&&c.unzoom(c._Mx.level-a.level)});(b.pan||b.xpan)&&a.addListener("xpan",function(a){c.inPan||A(c,a.xmin,a.xmax,"X")});(b.pan||b.ypan)&&a.addListener("ypan",function(a){c.inPan||A(c,a.ymin,a.ymax,"Y")})},redraw:function(){var a=this._Gx,b=this._Mx,c=b.canvas.getContext("2d");a.plotData.valid?(c.drawImage(a.plotData,
b.l-1,b.t-1,b.r-b.l+2,b.b-b.t+2,b.l-1,b.t-1,b.r-b.l+2,b.b-b.t+2),r(this),a.cross_xpos=void 0,a.cross_ypos=void 0,!b.warpbox&&this.mouseOnCanvas&&G(this),(a.always_show_marker||a.show_marker)&&L(this)):this.refresh()},refresh:function(){var a=this;l.render(this._Mx,function(){a._refresh()})},enable_listeners:function(){var a=this._Mx;l.addEventListener(a,"mousedown",this.onmousedown,!1);l.addEventListener(a,"mousemove",this.throttledOnMouseMove,!1);window.addEventListener("mouseup",a.onmouseup,!1);
window.addEventListener("keydown",a.onkeydown,!1);window.addEventListener("keyup",a.onkeyup,!1);window.addEventListener("resize",this.onresize,!1);document.addEventListener("mouseup",this.docMouseUp,!1);l.addEventListener(a,"mouseup",this.mouseup,!1);window.addEventListener("mousedown",this.dragMouseDownHandler,!1);window.addEventListener("mousemove",this.throttledDragOnMouseMove,!1);window.addEventListener("mouseup",this.dragMouseUpHandler,!1);window.addEventListener("wheel",this.wheelHandler,!1);
window.addEventListener("mousewheel",this.wheelHandler,!1);window.addEventListener("DOMMouseScroll",this.wheelHandler,!1);window.addEventListener("keypress",this.onkeypress,!1)},disable_listeners:function(){var a=this._Mx;l.removeEventListener(a,"mousedown",this.onmousedown,!1);l.removeEventListener(a,"mousemove",this.throttledOnMouseMove,!1);l.removeEventListener(a,"mouseup",this.mouseup,!1);window.removeEventListener("mouseup",a.onmouseup,!1);window.removeEventListener("keydown",a.onkeydown,!1);
window.removeEventListener("keyup",a.onkeyup,!1);window.removeEventListener("resize",this.onresize,!1);document.removeEventListener("mouseup",this.docMouseUp,!1);window.removeEventListener("mousedown",this.dragMouseDownHandler,!1);window.removeEventListener("mousemove",this.throttledDragOnMouseMove,!1);window.removeEventListener("mouseup",this.dragMouseUpHandler,!1);window.removeEventListener("wheel",this.wheelHandler,!1);window.removeEventListener("mousewheel",this.wheelHandler,!1);window.removeEventListener("DOMMouseScroll",
this.wheelHandler,!1);window.removeEventListener("keypress",this.onkeypress,!1)},checkresize:function(){l.checkresize(this._Mx)&&this.refresh()},_refresh:function(){var a=this._Mx,b=this._Gx;a.canvas.getContext("2d");if(!b.hold){l.set_font(a,Math.min(8,a.width/64));b.pthk=1.5*a.text_w;if(b.specs){var c=!1;4===b.ylab&&(c=!0);!0===b.show_y_axis?(a.l=6*a.text_w,c&&(31536E3<=Math.abs(a.stk[0].ymin)||31536E3<=Math.abs(a.stk[0].ymax))&&(a.l=11*a.text_w)):a.l=1;a.r=!0===b.pan?a.width-(b.pthk+2*a.text_w):
a.width-5;b.show_readout?(a.t=2*a.text_h,a.b=b.show_x_axis?a.height-4*a.text_h:a.height-3*a.text_h):"bottom"===b.x_scrollbar_location?(a.t=2*a.text_h,a.b=b.pan?b.show_x_axis?a.height-3*a.text_h:a.height-2*a.text_h:b.show_x_axis?a.height-2*a.text_h:a.height-5):(a.t=b.pan?b.pthk+2*a.text_w:1,a.b=b.show_x_axis?a.height-3*a.text_h/2:a.height-2);b.pl=b.show_readout?50*a.text_w:"bottom"===b.x_scrollbar_location?a.l:35*a.text_w;b.pr=Math.max(b.pl+9*a.text_w,a.r);b.pt=b.show_readout?b.show_x_axis?a.b+a.text_h+
(a.height-a.b-a.text_h-b.pthk)/2:a.b+(a.height-a.b-b.pthk)/2:"bottom"===b.x_scrollbar_location?b.show_x_axis?a.b+a.text_h+(a.height-a.b-a.text_h-b.pthk)/2:a.b+(a.height-a.b-b.pthk)/2:(a.t-b.pthk)/2;b.lbtn=a.text_h+a.text_w+2}else b.pan?(a.t=b.pthk+2*a.text_w,a.r=a.width-(b.pthk+a.text_w)):(a.t=1,a.r=a.width-2),a.b=a.height-2,a.l=1,b.pl=a.l,b.pr=a.r,b.pt=(a.t-b.pthk)/2,b.lbtn=0;b.pyl=a.r+(a.width-a.r-b.pthk)/2+1;b.lg_colorbar&&2===b.lyr[0].hcb["class"]&&(c=a.r,a.r=c-100);b.p_cuts&&2===b.lyr[0].hcb["class"]&&
(b.cross=!0,c=a.r,a.r=c-100,a.b-=100);b.xcut_now&&(a.canvas.width=b.x_box_w-1,a.canvas.height=b.x_box_h,a.r=b.x_box_w-1,a.l=0,a.b=b.x_box_h,a.t=0);b.ycut_now&&(a.canvas.width=b.y_box_h-1,a.canvas.height=b.y_box_w,a.r=b.y_box_h-1,a.l=0,a.b=b.y_box_w,a.t=0);c=a.level;a.stk[c].x1=a.l;a.stk[c].y1=a.t;a.stk[c].x2=a.r;a.stk[c].y2=a.b;a.stk[c].xscl=(a.stk[c].xmax-a.stk[c].xmin)/(a.r-a.l);a.stk[c].yscl=(a.stk[c].ymax-a.stk[c].ymin)/(a.b-a.t);c=X(this,a.xpos,a.ypos);b.retx=c.x;b.rety=c.y;if(0===b.panning||
0!==b.panning)b.plotData.valid=!1,l.clear_window(a);var c=b.xlab,d=b.ylab;void 0===c&&(c=30);b.index&&(c=0);void 0===d&&(d=0<b.lyr.length&&b.lyr[0].cx,1===b.cmode?d=28:2===b.cmode?d=b.plab:3===b.cmode&&d?d=21:4===b.cmode?d=22:5===b.cmode?(d=22,c=21):d=6===b.cmode?26:7===b.cmode?27:0);if(b.specs){if(0===b.sections){var e={grid:b.grid};2===b.panning&&(e.noxtlab=!0);b.show_x_axis||(e.noxtics=!0,e.noxtlab=!0,e.noxplab=!0);b.show_y_axis||(e.noytics=!0,e.noytlab=!0,e.noyplab=!0);!b.specs||b.show_readout||
b.pan||(e.noyplab=!0,e.noxplab=!0);b.gridBackground&&(e.fillStyle=b.gridBackground);b.gridStyle&&(e.gridStyle=b.gridStyle);b.xmult&&(e.xmult=b.xmult);b.ymult&&(e.ymult=b.ymult);4===c&&(e.xtimecode=!0);4===d&&(e.ytimecode=!0);void 0!==b.xlabel&&(e.xlabel=b.xlabel);void 0!==b.ylabel&&(e.ylabel=b.ylabel);l.drawaxis(b,a,b.xdiv,b.ydiv,c,d,e)}c=b.lbtn-2;b.show_readout&&b.pan&&!b.no_legend_button?(b.legend?(b.legendBtnLocation={x:a.width-b.lbtn,y:2,width:c,height:c},l.shadowbox(a,a.width-b.lbtn,2,c,c,1,
-2,"L")):(b.legendBtnLocation={x:a.width-b.lbtn,y:2,width:c,height:c},l.shadowbox(a,a.width-b.lbtn,2,c,c,1,2,"L")),B(this)):b.legendBtnLocation=null}else b.grid&&0<=b.sections&&(e={grid:!0,noaxisbox:!0,noxtics:!0,noxtlab:!0,noxplab:!0,noytics:!0,noytlab:!0,noyplab:!0},l.drawaxis(b,a,b.xdiv,b.ydiv,c,d,e));for(c=0;c<b.lyr.length;c++)D(this,c);c=this._Mx;d=this._Gx;d.show_readout&&!d.hide_note&&l.text(c,c.width-d.lbtn-(d.note.length+1)*c.text_w,c.text_h,d.note);ca(this);if(d.legend){for(var c=this._Mx,
d=this._Gx,e=c.canvas.getContext("2d"),f=0,g=0,h=0,s=0,p=0,n=0,q=0,m=f=0,u=0,s=c.text_w,q=23*s,f=(d.lyr.length+1)*c.text_h,p=c.r-q,n=c.t,g=p+2,h=n+2,m=q-5,u=f-5,v=0,f=q=0;f<d.lyr.length;f++){var y=e.measureText(d.lyr[f].name).width;y>v&&(v=y)}98<v&&(q=v-98,m+=q,g-=q);e.strokeStyle=c.fg;e.fillStyle=c.bg;e.fillRect(g,h,m,u);e.strokeRect(g,h,m,u);for(f=0;f<d.lyr.length;f++)g=p+4*s,h=n+f*c.text_h+c.text_h,f===d.modlayer&&l.text(c,p+s-q,h+Math.floor(c.text_w/2),"**"),d.lyr[f].display&&(u=d.lyr[f].color,
0<d.lyr[f].line&&(m=k.sign(Math.min(s,Math.abs(d.lyr[f].thick)),d.lyr[f].thick),0>m||m===l.L_dashed?l.draw_line(c,u,g-q,h-3,g+2*s-q,h-3,Math.abs(m),{mode:"dashed",on:4,off:4}):l.draw_line(c,u,g-q,h-3,g+2*s-q,h-3,Math.abs(m))),0<d.lyr[f].symbol&&(m=0>d.lyr[f].radius?-k.trunc(0.6*s):Math.min(d.lyr[f].radius,k.trunc(0.6*s)),l.draw_symbol(c,u,g+s-q,h-3,d.lyr[f].symbol,m))),g+=3*s,h+=0.3*c.text_h,l.text(c,g-q,h,d.lyr[f].name)}r(this);b.cross_xpos=void 0;b.cross_ypos=void 0;!a.warpbox&&this.mouseOnCanvas&&
(G(this),b.y_cut_press_on||b.x_cut_press_on||2!==b.lyr[0].hcb["class"]||w(this));(b.always_show_marker||b.show_marker)&&L(this)}}};var ga={lines:13,length:7,width:4,radius:10,corners:1,rotate:0,color:"#FFF",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2E9,top:"auto",left:"auto"},ia="Ma Ph Re Im IR Lo L2".split(" "),ja=["(absc)","(indx)","(1/ab)","(dydx)"];P.exports=b})()},{"./bluefile":2,"./common":3,"./m":4,"./mx":5,"./sigplot.layer1d":7,"./sigplot.layer2d":8,spin:10}],7:[function(R,
P,W){(function(){var b=R("./m"),e=R("./mx"),m=function(a){this.plot=a;this.ybuf=this.xbuf=void 0;this.xmax=this.xmin=this.imin=this.xdelta=this.xstart=this.offset=0;this.name="";this.cx=!1;this.hcb=void 0;this.size=0;this.display=!0;this.color=0;this.line=3;this.thick=1;this.symbol=0;this.radius=3;this.ysub=this.xsub=this.skip=0;this.modified=this.xdata=!1;this.preferred_origin=this.opacity=1;this.pointbufsize=0;this.ypoint=this.xpoint=this.yptr=this.xptr=null;this.options={}};m.prototype={init:function(a,
c){this.hcb=a;this.hcb.buf_type="D";this.ybufn=this.xbufn=this.size=this.offset=0;this.hcb.pipe?2===a["class"]&&(b.force1000(a),this.size=a.subsize):2===a["class"]?(b.force1000(a),this.size=a.subsize):this.size=a.size;c.framesize&&(this.size=c.framesize);if(this.hcb.pipe&&!this.size)throw"1D layer could not determine appropriate size for pipe, use framesize option";2>=a["class"]&&(this.xsub=-1,this.ysub=1,this.cx="C"===a.format[0]);this.skip=1;this.cx&&(this.skip=2);this.xstart=a.xstart;this.xdelta=
a.xdelta;var e=a.xstart+a.xdelta*(this.size-1);this.xmin=Math.min(a.xstart,e);this.xmax=Math.max(a.xstart,e);this.xlab=a.xunits;this.ylab=a.yunits;if(this.hcb.pipe){this.drawmode="scrolling";this.position=0;this.tle=c.tl;this.ybufn=this.size*Math.max(this.skip*b.PointArray.BYTES_PER_ELEMENT,b.PointArray.BYTES_PER_ELEMENT);this.ybuf=new ArrayBuffer(this.ybufn);var n=this;b.addPipeWriteListener(this.hcb,function(){n._onpipewrite()})}},_onpipewrite:function(){var a=new b.PointArray(this.ybuf),c=this.tle;
if(void 0===c)c=Math.floor(b.pavail(this.hcb))/this.hcb.spa;else if(b.pavail(this.hcb)<c*this.hcb.spa)return;var e=c*this.hcb.spa;if("lefttoright"===this.drawmode)this.position=0,a.set(a.subarray(0,this.size-e),e);else if("righttoleft"===this.drawmode)this.position=this.size-c,a.set(a.subarray(e),0);else if("scrolling"!==this.drawmode)throw"Invalid draw mode";c=Math.min(c,this.size-this.position);0!==b.grabx(this.hcb,a,c*this.hcb.spa,this.position*this.hcb.spa)&&(this.position=(this.position+c)%this.size,
0!==this.plot._Gx.autol&&this.plot.rescale())},get_data:function(a,c){var e=this.plot._Gx,n=this.hcb,f=this.skip,m;m=2===n["class"]?n.subsize:n.size;var r=0,f=0;e.index?(r=Math.floor(a),f=Math.floor(c+0.5)):0<=n.xdelta?(r=Math.floor((a-n.xstart)/n.xdelta)-1,f=Math.floor((c-n.xstart)/n.xdelta+0.5)):(r=Math.floor((c-n.xstart)/n.xdelta)-1,f=Math.floor((a-n.xstart)/n.xdelta+0.5));r=Math.max(0,r);f=Math.min(m,f);e=Math.max(0,Math.min(f-r+1,e.bufmax));0>n.xdelta&&(r=f-e+1);if(!(r>=this.imin&&r+e<=this.imin+
this.size&&void 0!==this.ybuf||this.modified)&&2>=n["class"]){m=this.offset+r;f=this.skip;this.ybufn=e*Math.max(f*b.PointArray.BYTES_PER_ELEMENT,b.PointArray.BYTES_PER_ELEMENT);if(void 0===this.ybuf||this.ybuf.byteLength<this.ybufn)this.ybuf=new ArrayBuffer(this.ybufn);f=new b.PointArray(this.ybuf);e=b.grab(n,f,m,e);this.imin=r;this.xstart=n.xstart+r*this.xdelta;this.size=e}},change_settings:function(a){if(void 0!==a.index)if(a.index)this.xmin=this.xdelta=this.xstart=1,this.xmax=this.size;else{this.xstart=
this.hcb.xstart+this.imin*this.xdelta;this.xdelta=this.hcb.xdelta;var c=this.hcb.xstart+this.hcb.xdelta*(this.size-1);this.xmin=Math.min(this.hcb.xstart,c);this.xmax=Math.max(this.hcb.xstart,c)}void 0!==a.drawmode&&(this.drawmode=a.drawmode,this.position=0,this.ybufn=this.size*Math.max(this.skip*b.PointArray.BYTES_PER_ELEMENT,b.PointArray.BYTES_PER_ELEMENT),this.ybuf=new ArrayBuffer(this.ybufn))},reload:function(a,c){if(this.hcb.pipe)throw"reload cannot be used with pipe, use push instead";var e=
this.hcb.dview.length!==a.length||c;if(c)for(var n in c)if(this.hcb[n]=c[n],"xstart"===n||"xdelta"===n)e=!0;this.hcb.setData(a);this.imin=0;this.xstart=void 0;this.size=0;n=this.xmin;var f=this.xmax;e&&(2===this.hcb["class"]&&b.force1000(this.hcb),e=this.hcb.xstart+this.hcb.xdelta*(this.hcb.size-1),this.xmin=Math.min(this.hcb.xstart,e),this.xmax=Math.max(this.hcb.xstart,e),this.xdelta=this.hcb.xdelta,this.xstart=this.hcb.xstart,f=n=void 0);return{xmin:n,xmax:f}},push:function(a,c,e){if(c){for(var n in c)this.hcb[n]=
c[n],"type"===n&&(this.hcb["class"]=c[n]/1E3);c.subsize&&2===this.hcb["class"]&&(b.force1000(this.hcb),this.size=this.hcb.subsize,this.position=null,this.ybufn=this.size*Math.max(this.skip*b.PointArray.BYTES_PER_ELEMENT,b.PointArray.BYTES_PER_ELEMENT),this.ybuf=new ArrayBuffer(this.ybufn));n=this.hcb.xstart+this.hcb.xdelta*(this.hcb.size-1);this.xmin=Math.min(this.hcb.xstart,n);this.xmax=Math.max(this.hcb.xstart,n);this.xdelta=this.hcb.xdelta;this.xstart=this.hcb.xstart}b.filad(this.hcb,a,e);return c?
!0:!1},prep:function(a,c){var e=this.plot._Gx,n=this.plot._Mx,f=Math.ceil(this.size),m=this.skip;if(0===f)return{num:0,start:0,end:0};f*b.PointArray.BYTES_PER_ELEMENT>this.pointbufsize&&(this.pointbufsize=f*b.PointArray.BYTES_PER_ELEMENT,this.xptr=new ArrayBuffer(this.pointbufsize),this.yptr=new ArrayBuffer(this.pointbufsize),this.xpoint=new b.PointArray(this.xptr),this.ypoint=new b.PointArray(this.yptr));var r=new b.PointArray(this.ybuf),E=this.xmin,D=this.xmax,y,w,G;if(5===e.cmode||0<this.xsub)0>=
f?(E=e.panxmin,D=e.panxmax):5!==e.cmode?this.xpoint=new b.PointArray(this.xbuf):this.cx?b.vmov(r,m,this.xpoint,1,f):0!==this.line?(G=b.vmxmn(r,f),this.xpoint[0]=G.smax,this.xpoint[1]=G.smin,y=0,f=w=2):this.xpoint=r,0<f&&(G=b.vmxmn(this.xpoint,f),D=G.smax,E=G.smin,y=0,w=f);else if(0<f){G=this.xstart;var L=this.xdelta;w=f;e.index?(y=0,w=f-1):0<=L?(y=Math.max(1,Math.min(w,Math.round((a-G)/L)))-1,w=Math.max(1,Math.min(w,Math.round((c-G)/L)+2))-1):(y=Math.max(1,Math.min(w,Math.round((c-G)/L)-1))-1,w=Math.max(1,
Math.min(w,Math.round((a-G)/L)+2))-1);f=w-y+1;0>f&&(b.log.debug("Nothing to plot"),f=0);r=(new b.PointArray(this.ybuf)).subarray(y*m);G+=L*y;for(var T=0;T<f;T++)this.xpoint[T]=e.index?this.imin+T+1:G+T*L}e.panxmin>e.panxmax?(e.panxmin=E,e.panxmax=D):(e.panxmin=Math.min(e.panxmin,E),e.panxmax=Math.max(e.panxmax,D));if(0>=f)return b.log.debug("Nothing to plot"),{num:f,start:y,end:w};if(this.cx)1===e.cmode?b.cvmag(r,this.ypoint,f):2===e.cmode?25===e.plab?(b.cvpha(r,this.ypoint,f),b.vsmul(this.ypoint,
1/(2*Math.PI),this.ypoint,f)):24!==e.plab?b.cvpha(r,this.ypoint,f):b.cvphad(r,this.ypoint,f):3===e.cmode?b.vmov(r,m,this.ypoint,1,f):6<=e.cmode?b.cvmag2(r,this.ypoint,f):4<=e.cmode&&b.vmov(r.subarray(1),m,this.ypoint,1,f);else if(5===e.cmode)b.vfill(this.ypoint,0,f);else if(1===e.cmode||6<=e.cmode)for(T=0;T<f;T++)this.ypoint[T]=Math.abs(r[T]);else for(T=0;T<f;T++)this.ypoint[T]=r[T];6<=e.cmode&&(b.vlog10(this.ypoint,e.dbmin,this.ypoint),E=10,7===e.cmode&&(E=20),0<e.lyr.length&&e.lyr[0].cx&&(E/=2),
b.vsmul(this.ypoint,E,this.ypoint));G=b.vmxmn(this.ypoint,f);D=G.smax;E=G.smin;m=D-E;0>m&&(D=E,E=D+m,m=-m);1E-20>=m?(E-=1,D+=1):(E-=0.02*m,D+=0.02*m);0===n.level&&(e.panymin>e.panymax?(e.panymin=E,e.panymax=D):(e.panymin=Math.min(e.panymin,E),e.panymax=Math.max(e.panymax,D)),1<e.autol&&(E=1/Math.max(e.autol,1),e.panymin=e.panymin*E+n.stk[0].ymin*(1-E),e.panymax=e.panymax*E+n.stk[0].ymax*(1-E)));return{num:f,start:y,end:w}},draw:function(){var a=this.plot._Mx,c=this.plot._Gx,h=this.color,n=this.symbol,
f=this.radius,m=0,r={};r.fillStyle=c.fillStyle;this.options&&(r.highlight=this.options.highlight,r.noclip=this.options.noclip);0===this.line?m=0:(m=1,0<this.thick?m=this.thick:0>this.thick&&(m=Math.abs(this.thick),r.dashed=!0),1===this.line&&(r.vertsym=!0),2===this.line&&(r.horzsym=!0));var E=c.segment&&5!==c.cmode&&0<this.xsub&&!0,D=this.xdelta,y,w;this.xdata?(y=this.xmin,w=this.xmax):(y=Math.max(this.xmin,a.stk[a.level].xmin),w=Math.min(this.xmax,a.stk[a.level].xmax),y>=w&&(c.panxmin=Math.min(c.panxmin,
this.xmin),c.panxmax=Math.max(c.panxmax,this.xmax)));if(!c.all){var G=(c.bufmax-1)*D;-0<=G?w=Math.min(w,y+G):y=Math.max(y,w+G)}if(0!==m||0!==n){for(;y<w;)this.hcb.pipe||this.get_data(y,w),G=this.prep(y,w),0<G.num&&!E&&e.trace(a,h,new b.PointArray(this.xptr),new b.PointArray(this.yptr),G.num,G.start,1,m,n,f,r),c.all?0===this.size?y=w:c.index?y+=G.num:0<=D?y+=this.size*D:w+=this.size*D:y=w;this.position&&"scrolling"===this.drawmode&&(c=e.real_to_pixel(a,this.position*this.xdelta,0),c.x>a.l&&c.x<a.r&&
e.draw_line(a,"white",c.x,a.t,c.x,a.b))}},add_highlight:function(a){this.options.highlight||(this.options.highlight=[]);a instanceof Array?this.options.highlight.push.apply(this.options.highlight,a):this.options.highlight.push(a);this.plot.refresh()},remove_highlight:function(a){if(this.options.highlight){for(var b=this.options.highlight.length;b--;)a!==this.options.highlight[b]&&a!==this.options.highlight[b].id||this.options.highlight.splice(b,1);this.plot.refresh()}},get_highlights:function(){return this.options.highlight?
this.options.highlight.slice(0):[]},clear_highlights:function(){this.options.highlight&&(this.options.highlight=void 0,this.plot.refresh())}};var a=[0,53,27,80,13,40,67,93,7,60,33,87,20,47,73,100];m.overlay=function(d,c,h){var n=d._Gx,f=d._Mx;2===c["class"]&&b.force1000(c);c.buf_type="D";var z=1;2===c["class"]&&0<c.size&&(z=Math.min(c.size/c.subsize,16-n.lyr.length));var r=h.name;delete h.name;for(var E=0;E<z;E++){var D=new m(d);D.init(c,h);D.color=e.getcolor(f,b.Mc.colormap[3].colors,a[n.lyr.length%
a.length]);2===c["class"]?(void 0!==r&&(Array.isArray(r)?D.name=r[E]:(D.name=r,D.name=D.name+"."+e.pad((E+1).toString(),3,"0"))),D.name||(D.name=c.file_name?b.trim_name(c.file_name):"layer_"+n.lyr.length,D.name=D.name+"."+e.pad((E+1).toString(),3,"0")),D.offset=E*c.subsize):(D.name=void 0!==r?r:c.file_name?b.trim_name(c.file_name):"layer_"+n.lyr.length,D.offset=0);for(var y in h)void 0!==D[y]&&(D[y]=h[y]);d.add_layer(D)}};P.exports=m})()},{"./m":4,"./mx":5}],8:[function(R,P,W){(function(){var b=R("./m"),
e=R("./mx"),m=function(a){this.plot=a;this.xmax=this.xmin=this.imin=this.ydelta=this.ystart=this.xdelta=this.xstart=this.offset=0;this.name="";this.cx=!1;this.hcb=void 0;this.display=!0;this.color=0;this.line=3;this.thick=1;this.symbol=0;this.radius=3;this.ysub=this.xsub=this.skip=0;this.modified=this.xdata=!1;this.preferred_origin=4;this.opacity=1;this.lpb=void 0;this.yc=1;this.options={}};m.prototype={init:function(a){var d=this.plot._Gx,c=this.plot._Mx;this.hcb=a;this.hcb.buf_type="D";if(this.hcb.pipe){var e=
this;this.frame=this.position=0;this.lps=this.hcb.lps||Math.ceil(Math.max(1,c.b-c.t));b.addPipeWriteListener(this.hcb,function(){e._onpipewrite()})}else this.lps=this.hcb.lps||Math.ceil(a.size);this.ybufn=this.xbufn=this.offset=0;this.drawmode="scrolling";2>=a["class"]&&(this.xsub=-1,this.ysub=1,this.cx="C"===a.format[0]);this.skip=1;this.cx&&(this.skip=2);d.index?(this.xmin=this.xdelta=this.xstart=1,this.xmax=a.subsize,this.ymin=this.ydelta=this.ystart=1,this.ymax=this.size):(this.xstart=a.xstart,
this.xdelta=a.xdelta,d=a.xstart+a.xdelta*(a.subsize-1),this.xmin=Math.min(a.xstart,d),this.xmax=Math.max(a.xstart,d),this.ystart=a.ystart,this.ydelta=a.ydelta,d=a.ystart+a.ydelta*(this.lps-1),this.ymin=Math.min(a.ystart,d),this.ymax=Math.max(a.ystart,d));this.xframe=this.hcb.subsize;this.yframe=this.lps*this.hcb.subsize/this.xframe;0===this.lpb&&(this.lpb=this.yframe);if(!this.lpb||0>=this.lpb)this.lpb=16;this.lpb=Math.max(1,this.lpb/this.yc)*this.yc;this.xlab=a.xunits;this.ylab=a.yunits},_onpipewrite:function(){var a=
this.plot._Gx,d=this.plot._Mx;if(!(b.pavail(this.hcb)<this.hcb.subsize*this.hcb.spa)){"scrolling"!==this.drawmode&&(this.hcb.ystart+=this.hcb.ydelta,this.ystart=this.hcb.ystart,this.ymin=this.hcb.ystart-this.hcb.ydelta*this.lps,this.ymax=this.hcb.ystart);if("falling"===this.drawmode)this.position=0,this.img&&e.shift_image_rows(d,this.img,1);else if("rising"===this.drawmode)this.position=this.lps-1,this.img&&e.shift_image_rows(d,this.img,-1);else if("scrolling"===this.drawmode)this.position>=this.lps&&
(this.position=0);else throw"Invalid draw mode";if(this.buf)if(0===b.grabx(this.hcb,this.buf,this.hcb.subsize*this.hcb.spa))b.log.error("Internal error");else{var c=new b.PointArray(this.hcb.subsize);this.cx?1===a.cmode?b.cvmag(this.buf,c,c.length):2===a.cmode?25===a.plab?(b.cvpha(this.buf,c,c.length),b.vsmul(c,1/(2*Math.PI),c,c.length)):24!==a.plab?b.cvpha(this.buf,c,c.length):b.cvphad(this.buf,c,c.length):3===a.cmode?b.vmov(this.buf,this.skip,c,1,c.length):4===a.cmode?b.vmov(this.buf.subarray(1),
this.skip,c,1,c.length):5===a.cmode?b.vfill(c,0,c.length):6===a.cmode?b.cvmag2logscale(this.buf,a.dbmin,10,c):7===a.cmode&&b.cvmag2logscale(this.buf,a.dbmin,20,c):1===a.cmode?b.vabs(this.buf,c):2===a.cmode?b.vfill(c,0,c.length):3===a.cmode?b.vmov(this.buf,this.skip,c,1,c.length):4===a.cmode?b.vfill(c,0,c.length):5===a.cmode?b.vfill(c,0,c.length):6===a.cmode?b.vlogscale(this.buf,a.dbmin,10,c):7===a.cmode&&b.vlogscale(this.buf,a.dbmin,20,c);for(var h=c[0],n=c[0],f=0;f<c.length;f++)c[f]<h&&(h=c[f]),
c[f]>n&&(n=c[f]);var m,r;1===a.autol?(m=h,r=n):1<a.autol?(f=1/Math.max(a.autol,1),m=a.zmin*f+h*(1-f),r=a.zmax*f+n*(1-f)):0>a.autol&&(f=1/Math.max(5,1),m=a.zmin*f+h*(1-f),r=a.zmax*f+n*(1-f));0!==(a.autoz&1)&&(a.zmin=m);0!==(a.autoz&2)&&(a.zmax=r);this.img&&e.update_image_row(d,this.img,c,this.position,a.zmin,a.zmax,a.xcompression);this.frame+=1;"scrolling"===this.drawmode&&(this.position=(this.position+1)%this.lps);0===d.level&&(a.panymin=this.ymin,a.panymax=this.ymax,d.stk[0].ymin=this.ymin,d.stk[0].ymax=
this.ymax)}}},get_data:function(){var a=this.hcb;this.buf||(this.hcb.pipe?(this.buf=this.hcb.createArray(null,0,this.hcb.subsize*this.hcb.spa),this.zbuf=new b.PointArray(this.hcb.subsize)):(this.buf=this.hcb.createArray(null,0,this.lps*this.hcb.subsize*this.hcb.spa),this.zbuf=new b.PointArray(this.lps*this.hcb.subsize)));this.hcb.pipe||b.grab(a,this.buf,0,a.subsize)},get_z:function(a,b){return this.zbuf[Math.floor(b/this.hcb.ydelta)*this.hcb.subsize+Math.floor(a/this.hcb.xdelta)]},change_settings:function(a){var d=
this.plot._Gx;void 0!==a.cmode&&(this.img=void 0,0!==(d.autoz&1)&&(d.zmin=void 0),0!==(d.autoz&2)&&(d.zmax=void 0));if(void 0!==a.zmin||void 0!==a.zmax||void 0!==a.autoz)this.img=void 0;void 0!==a.cmap&&(this.img=void 0);void 0!==a.drawmode&&(this.drawmode=a.drawmode,this.frame=this.position=0,this.hcb.pipe?(this.buf=this.hcb.createArray(null,0,this.hcb.subsize*this.hcb.spa),this.zbuf=new b.PointArray(this.hcb.subsize)):(this.buf=this.hcb.createArray(null,0,this.lps*this.hcb.subsize*this.hcb.spa),
this.zbuf=new b.PointArray(this.lps*this.hcb.subsize)),this.img=void 0,this.preferred_origin="falling"===this.drawmode?this.plot._Mx.origin=1:this.plot._Mx.origin=4);void 0!==a.opacity&&(this.opacity=a.opacity)},push:function(a,d,c){var e=!1,n=null;if(d){d.timestamp&&(n=d.timestamp,delete d.timestamp);d.subsize&&d.subsize!==this.hcb.subsize&&(this.hcb.subsize=d.subsize,this.hcb.pipe?(this.buf=this.hcb.createArray(null,0,this.hcb.subsize*this.hcb.spa),this.zbuf=new b.PointArray(this.hcb.subsize)):
(this.buf=this.hcb.createArray(null,0,this.lps*this.hcb.subsize*this.hcb.spa),this.zbuf=new b.PointArray(this.lps*this.hcb.subsize)),e=!0);for(var f in d)this.hcb[f]!==d[f]&&(this.hcb[f]=d[f],"type"===f&&(this.hcb["class"]=d[f]/1E3),e=!0);d.lps&&(this.lps=d.lps);e&&(d=this.hcb.xstart+this.hcb.xdelta*(this.hcb.subsize-1),this.xmin=Math.min(this.hcb.xstart,d),this.xmax=Math.max(this.hcb.xstart,d),this.xdelta=this.hcb.xdelta,this.xstart=this.hcb.xstart,this.ystart=this.hcb.ystart,this.ydelta=this.hcb.ydelta,
d=this.hcb.ystart+this.hcb.ydelta*(this.lps-1),this.ymin=Math.min(this.hcb.ystart,d),this.ymax=Math.max(this.hcb.ystart,d))}1!==this.hcb.yunits&&4!==this.hcb.yunits||this.hcb.timecode||!n||(this.hcb.timecode=b.j1970toj1950(n),this.hcb.ystart=0,e=!0);b.filad(this.hcb,a,c);return e},prep:function(a,d){var c=this.plot._Gx,h=this.plot._Mx,n=this.lps,f=this.xmin,m=this.xmax,r,E=this.hcb.subsize;0<c.xcompression&&(E=Math.ceil(h.r-h.l));this.get_data(a,d);if(this.hcb.pipe)c.panxmin>c.panxmax?(c.panxmin=
f,c.panxmax=m):(c.panxmin=Math.min(c.panxmin,f),c.panxmax=Math.max(c.panxmax,m)),c.panymin>c.panxmax?(c.panymin=this.ymin,c.panymax=this.ymax):(c.panymin=Math.min(c.panymin,this.ymin),c.panymax=Math.max(c.panymax,this.ymax)),this.img||(void 0===c.zmin&&(c.zmin=0),void 0===c.zmax&&(c.zmax=0),this.img=e.create_image(h,null,this.hcb.subsize,E,this.lps,c.zmin+c.zoff,c.zmax+c.zoff,c.xcompression));else{if(!(5===c.cmode||0<this.xsub)&&0<n){var D=this.xstart,y=this.xdelta,w=n;c.index?(r=0,n-=1):0<=y?(r=
Math.max(1,Math.min(w,Math.round((a-D)/y)))-1,n=Math.max(1,Math.min(w,Math.round((d-D)/y)+2))-1):(r=Math.max(1,Math.min(w,Math.round((d-D)/y)-1))-1,n=Math.max(1,Math.min(w,Math.round((a-D)/y)+2))-1);n=n-r+1;0>n&&(b.log.debug("Nothing to plot"),n=0)}c.panxmin>c.panxmax?(c.panxmin=f,c.panxmax=m):(c.panxmin=Math.min(c.panxmin,f),c.panxmax=Math.max(c.panxmax,m));if(0>=n){b.log.debug("Nothing to plot");return}!(5===c.cmode||0<this.ysub)&&0<n&&(f=this.ystart,m=this.ydelta,w=n,c.index?(r=0,n-=1):0<=m?(r=
Math.max(1,Math.min(w,Math.round((a-f)/m)))-1,n=Math.max(1,Math.min(w,Math.round((d-f)/m)+2))-1):(r=Math.max(1,Math.min(w,Math.round((d-f)/m)-1))-1,n=Math.max(1,Math.min(w,Math.round((a-f)/m)+2))-1),n=n-r+1,0>n&&(b.log.debug("Nothing to plot"),n=0));c.panymin>c.panxmax?(c.panymin=this.ymin,c.panymax=this.ymax):(c.panymin=Math.min(c.panymin,this.ymin),c.panymax=Math.max(c.panymax,this.ymax));this.cx?1===c.cmode?b.cvmag(this.buf,this.zbuf,this.zbuf.length):2===c.cmode?25===c.plab?(b.cvpha(this.buf,
this.zbuf,this.zbuf.length),b.vsmul(this.zbuf,1/(2*Math.PI),this.zbuf,this.zbuf.length)):24!==c.plab?b.cvpha(this.buf,this.zbuf,this.zbuf.length):b.cvphad(this.buf,this.zbuf,this.zbuf.length):3===c.cmode?b.vmov(this.buf,this.skip,this.zbuf,1,this.zbuf.length):4===c.cmode?b.vmov(this.buf.subarray(1),this.skip,this.zbuf,1,this.zbuf.length):5===c.cmode?b.vfill(this.zbuf,0,this.zbuf.length):6===c.cmode?b.cvmag2logscale(this.buf,c.dbmin,10,this.zbuf):7===c.cmode&&b.cvmag2logscale(this.buf,c.dbmin,20,this.zbuf):
1===c.cmode?b.vabs(this.buf,this.zbuf):2===c.cmode?b.vfill(this.zbuf,0,this.zbuf.length):3===c.cmode?b.vmov(this.buf,this.skip,this.zbuf,1,this.zbuf.length):4===c.cmode?b.vfill(this.zbuf,0,this.zbuf.length):5===c.cmode?b.vfill(this.zbuf,0,this.zbuf.length):6===c.cmode?b.vlogscale(this.buf,c.dbmin,10,this.zbuf):7===c.cmode&&b.vlogscale(this.buf,c.dbmin,20,this.zbuf);w=this.zbuf;m=f=0;if(0>=c.autol||this.hcb.pipe){if(0<w.length)for(f=w[0],m=w[0],r=0;r<w.length&&!(r/this.xframe>=this.lpb);r++)w[r]<f&&
(f=w[r]),w[r]>m&&(m=w[r]);0!==(c.autoz&1)&&(c.zmin=void 0!==c.zmin?Math.min(c.zmin,f):f);0!==(c.autoz&2)&&(c.zmax=void 0!==c.zmax?Math.min(c.zmax,m):m);this.img=e.create_image(h,this.zbuf,this.hcb.subsize,E,this.lps,c.zmin+c.zoff,c.zmax+c.zoff,c.xcompression)}else if(D=this.hcb.size,y=1/Math.max(c.autol,1),this.img||(this.img=e.create_image(h,this.zbuf,this.hcb.subsize,E,this.lps,c.zmin+c.zoff,c.zmax+c.zoff)),c.zmin=0,c.zmax=0,0<w.length)for(var G=0;G<D;G++){var L=G*this.xframe,f=w[L],m=w[L];for(r=
0;r<this.xframe;r++)f=Math.min(w[L+r],f),m=Math.max(w[L+r],m);2!==c.autoz&&void 0!==f&&(c.zmin=f*y+c.zmin*(1-y));1!==c.autoz&&void 0!==m&&(c.zmax=m*y+c.zmax*(1-y));e.update_image_row(h,this.img,w.subarray(L,L+this.xframe),G,c.zmin,c.zmax)}}this.img.cmode=c.cmode;this.img.cmap=c.cmap;this.img.origin=h.origin;if(this.hcb.pipe&&this.frame<this.lps)if(c=new Uint32Array(this.img),"rising"===this.drawmode)for(r=0;r<c.length-this.frame*E;r++)c[r]=0;else for(r=this.frame*E;r<c.length;r++)c[r]=0;return n},
draw:function(){var a=this.plot._Mx,b=this.plot._Gx,c=this.hcb;if(this.hcb.pipe){var h=this.hcb.lps||Math.ceil(Math.max(1,a.b-a.t));h!==this.lps&&this.buf&&(this.lps=h,this.position>=this.lps&&(this.position=0),h=c.ystart+c.ydelta*(this.lps-1),this.ymin=Math.min(c.ystart,h),this.ymax=Math.max(c.ystart,h),this.img=null,this.plot.rescale())}var h=Math.max(this.xmin,a.stk[a.level].xmin),m=Math.min(this.xmax,a.stk[a.level].xmax);if(h>=m)b.panxmin=Math.min(b.panxmin,this.xmin),b.panxmax=Math.max(b.panxmax,
this.xmax);else{var f=Math.max(this.ymin,a.stk[a.level].ymin),z=Math.min(this.ymax,a.stk[a.level].ymax),r=Math.abs(m-h)+1,E=Math.abs(z-f)+1,r=Math.floor(r/c.xdelta),E=Math.floor(E/c.ydelta),r=Math.min(r,c.subsize),E=Math.min(E,c.size),c=e.real_to_pixel(a,h,f),z=e.real_to_pixel(a,m,z),E=(z.y-c.y)/E;b.xe=Math.max(1,Math.round((z.x-c.x)/r));b.ye=Math.max(1,Math.round(E));this.img&&this.buf&&b.cmode===this.img.cmode&&b.cmap===this.img.cmap&&a.origin===this.img.origin||this.prep(h,m);this.img&&e.draw_image(a,
this.img,this.xmin,this.ymin,this.xmax,this.ymax,this.opacity,b.rasterSmoothing);null!==this.position&&"scrolling"===this.drawmode&&(b=e.real_to_pixel(a,0,this.position*this.ydelta),b.y>a.t&&b.y<a.b&&e.draw_line(a,"white",a.l,b.y,a.r,b.y))}}};m.overlay=function(a,d,c){var e=a._Gx;d.buf_type="D";var n=new m(a);n.init(d);n.name=d.file_name?b.trim_name(d.file_name):"layer_"+e.lyr.length;n.change_settings(c);a.add_layer(n)};P.exports=m})()},{"./m":4,"./mx":5}],9:[function(R,P,W){(function(b,e){"object"===
typeof P&&P.exports?P.exports=e():b.log=e()})(this,function(){function b(a,b){var c=a[b];if("function"===typeof c.bind)return c.bind(a);try{return Function.prototype.bind.call(c,a)}catch(d){return function(){return Function.prototype.apply.apply(c,[a,arguments])}}}function e(a,b,c){return function(){typeof console!==h&&(m.call(this,b,c),this[a].apply(this,arguments))}}function m(a,b){for(var d=0;d<n.length;d++){var e=n[d];this[e]=d<a?c:this.methodFactory(e,a,b)}}function a(a,d,f){return(typeof console===
h?!1:void 0!==console[a]?b(console,a):void 0!==console.log?b(console,"log"):c)||e.apply(this,arguments)}function d(b,c,d){function e(){var a;try{a=window.localStorage[z]}catch(b){}if(typeof a===h)try{var c=window.document.cookie,d=c.indexOf(encodeURIComponent(z)+"=");d&&(a=/^([^;]+)/.exec(c.slice(d))[1])}catch(m){}void 0===f.levels[a]&&(a=void 0);return a}var f=this,r,z="loglevel";b&&(z+=":"+b);f.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5};f.methodFactory=d||a;f.getLevel=function(){return r};
f.setLevel=function(a,c){"string"===typeof a&&void 0!==f.levels[a.toUpperCase()]&&(a=f.levels[a.toUpperCase()]);if("number"===typeof a&&0<=a&&a<=f.levels.SILENT){r=a;if(!1!==c)a:{var d=(n[a]||"silent").toUpperCase();try{window.localStorage[z]=d;break a}catch(e){}try{window.document.cookie=encodeURIComponent(z)+"="+d+";"}catch(w){}}m.call(f,a,b);if(typeof console===h&&a<f.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+a;};f.setDefaultLevel=
function(a){e()||f.setLevel(a,!1)};f.enableAll=function(a){f.setLevel(f.levels.TRACE,a)};f.disableAll=function(a){f.setLevel(f.levels.SILENT,a)};d=e();null==d&&(d=null==c?"WARN":c);f.setLevel(d,!1)}var c=function(){},h="undefined",n=["trace","debug","info","warn","error"],f=new d,z={};f.getLogger=function(a){if("string"!==typeof a||""===a)throw new TypeError("You must supply a name when creating a logger.");var b=z[a];b||(b=z[a]=new d(a,f.getLevel(),f.methodFactory));return b};var r=typeof window!==
h?window.log:void 0;f.noConflict=function(){typeof window!==h&&window.log===f&&(window.log=r);return f};return f})},{}],10:[function(R,P,W){function b(a,b){var c=document.createElement(a||"div"),d;for(d in b)c[d]=b[d];return c}function e(a){for(var b=1,c=arguments.length;b<c;b++)a.appendChild(arguments[b]);return a}function m(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-");c=0.01+c/d*100;d=Math.max(1-(1-a)/b*(100-c),a);var h=z.substring(0,z.indexOf("Animation")).toLowerCase();f[e]||(r.insertRule("@"+
(h&&"-"+h+"-"||"")+"keyframes "+e+"{0%{opacity:"+d+"}"+c+"%{opacity:"+a+"}"+(c+0.01)+"%{opacity:1}"+(c+b)%100+"%{opacity:"+a+"}100%{opacity:"+d+"}}",0),f[e]=1);return e}function a(a,b){var c=a.style,d,e;if(void 0!==c[b])return b;b=b.charAt(0).toUpperCase()+b.slice(1);for(e=0;e<n.length;e++)if(d=n[e]+b,void 0!==c[d])return d}function d(b,c){for(var d in c)b.style[a(b,d)||d]=c[d];return b}function c(a){for(var b=1;b<arguments.length;b++){var c=arguments[b],d;for(d in c)void 0===a[d]&&(a[d]=c[d])}return a}
function h(a){for(var b={x:a.offsetLeft,y:a.offsetTop};a=a.offsetParent;)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}var n=["webkit","Moz","ms","O"],f={},z,r=function(){var a=b("style");e(document.getElementsByTagName("head")[0],a);return a.sheet||a.styleSheet}(),E={lines:12,length:7,width:5,radius:10,rotate:0,color:"#000",speed:1,trail:100,opacity:0.25,fps:20,zIndex:2E9,className:"spinner",top:"auto",left:"auto"},D=function w(a){if(!this.spin)return new w(a);this.opts=c(a||{},w.defaults,E)};D.defaults=
{};c(D.prototype,{spin:function(a){this.stop();var c=this,e=c.opts,f=c.el=d(b(0,{className:e.className}),{position:"relative",zIndex:e.zIndex}),m=e.radius+e.length+e.width,n,r;a&&(a.insertBefore(f,a.firstChild||null),r=h(a),n=h(f),d(f,{left:("auto"==e.left?r.x-n.x+(a.offsetWidth>>1):e.left+m)+"px",top:("auto"==e.top?r.y-n.y+(a.offsetHeight>>1):e.top+m)+"px"}));f.setAttribute("aria-role","progressbar");c.lines(f,c.opts);if(!z){var D=0,B=e.fps,E=B/e.speed,P=(1-e.opacity)/(E*e.trail/100),p=E/e.lines;
!function K(){D++;for(var a=e.lines;a;a--){var b=Math.max(1-(D+a*p)%E*P,e.opacity);c.opacity(f,e.lines-a,b,e)}c.timeout=c.el&&setTimeout(K,~~(1E3/B))}()}return c},stop:function(){var a=this.el;a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=void 0);return this},lines:function(a,c){function f(a,e){return d(b(),{position:"absolute",width:c.length+c.width+"px",height:c.width+"px",background:a,boxShadow:e,transformOrigin:"left",transform:"rotate("+~~(360/c.lines*h+c.rotate)+
"deg) translate("+c.radius+"px,0)",borderRadius:(c.width>>1)+"px"})}for(var h=0,n;h<c.lines;h++)n=d(b(),{position:"absolute",top:1+~(c.width/2)+"px",transform:c.hwaccel?"translate3d(0,0,0)":"",opacity:c.opacity,animation:z&&m(c.opacity,c.trail,h,c.lines)+" "+1/c.speed+"s linear infinite"}),c.shadow&&e(n,d(f("#000","0 0 4px #000"),{top:"2px"})),e(a,e(n,f(c.color,"0 0 1px rgba(0,0,0,.1)")));return a},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}});!function(){function c(a,
d){return b("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',d)}var f=d(b("group"),{behavior:"url(#default#VML)"});!a(f,"transform")&&f.adj?(r.addRule(".spin-vml","behavior:url(#default#VML)"),D.prototype.lines=function(a,b){function f(){return d(c("group",{coordsize:n+" "+n,coordorigin:-m+" "+-m}),{width:n,height:n})}function h(a,p,n){e(z,e(d(f(),{rotation:360/b.lines*a+"deg",left:~~p}),e(d(c("roundrect",{arcsize:1}),{width:m,height:b.width,left:b.radius,top:-b.width>>1,filter:n}),
c("fill",{color:b.color,opacity:b.opacity}),c("stroke",{opacity:0}))))}var m=b.length+b.width,n=2*m,r=2*-(b.width+b.length)+"px",z=d(f(),{position:"absolute",top:r,left:r});if(b.shadow)for(r=1;r<=b.lines;r++)h(r,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(r=1;r<=b.lines;r++)h(r);return e(a,z)},D.prototype.opacity=function(a,b,c,d){a=a.firstChild;d=d.shadow&&d.lines||0;a&&b+d<a.childNodes.length&&(a=(a=(a=a.childNodes[b+d])&&a.firstChild)&&a.firstChild)&&
(a.opacity=c)}):z=a(f,"animation")}();P.exports=D},{}],11:[function(R,P,W){(function(b){function e(c,d){var f,h,m,n,r;c=c?c:"";d=d||{};if(c instanceof e)return c;if(!(this instanceof e))return new e(c,d);h=c;r={r:0,g:0,b:0};var u=1;n=n=m=null;m=n=!1;if("string"==typeof h)a:{h=h.replace(p,"").replace(F,"").toLowerCase();var x=!1;if(q[h])h=q[h],x=!0;else if("transparent"==h){h={r:0,g:0,b:0,a:0,format:"name"};break a}h=(f=aa.rgb.exec(h))?{r:f[1],g:f[2],b:f[3]}:(f=aa.rgba.exec(h))?{r:f[1],g:f[2],b:f[3],
a:f[4]}:(f=aa.hsl.exec(h))?{h:f[1],s:f[2],l:f[3]}:(f=aa.hsla.exec(h))?{h:f[1],s:f[2],l:f[3],a:f[4]}:(f=aa.hsv.exec(h))?{h:f[1],s:f[2],v:f[3]}:(f=aa.hsva.exec(h))?{h:f[1],s:f[2],v:f[3],a:f[4]}:(f=aa.hex8.exec(h))?{r:parseInt(f[1],16),g:parseInt(f[2],16),b:parseInt(f[3],16),a:parseInt(f[4],16)/255,format:x?"name":"hex8"}:(f=aa.hex6.exec(h))?{r:parseInt(f[1],16),g:parseInt(f[2],16),b:parseInt(f[3],16),format:x?"name":"hex"}:(f=aa.hex4.exec(h))?{r:parseInt(f[1]+""+f[1],16),g:parseInt(f[2]+""+f[2],16),
b:parseInt(f[3]+""+f[3],16),a:parseInt(f[4]+""+f[4],16)/255,format:x?"name":"hex8"}:(f=aa.hex3.exec(h))?{r:parseInt(f[1]+""+f[1],16),g:parseInt(f[2]+""+f[2],16),b:parseInt(f[3]+""+f[3],16),format:x?"name":"hex"}:!1}if("object"==typeof h){if(X(h.r)&&X(h.g)&&X(h.b))r=h.g,f=h.b,r={r:255*M(h.r,255),g:255*M(r,255),b:255*M(f,255)},n=!0,m="%"===String(h.r).substr(-1)?"prgb":"rgb";else if(X(h.h)&&X(h.s)&&X(h.v)){m=I(h.s);n=I(h.v);x=h.h;f=m;r=n;x=6*M(x,360);f=M(f,100);r=M(r,100);m=b.floor(x);var w=x-m;n=r*
(1-f);x=r*(1-w*f);f=r*(1-(1-w)*f);m%=6;r={r:255*[r,x,n,n,f,r][m],g:255*[f,r,r,x,n,n][m],b:255*[n,n,f,r,r,x][m]};n=!0;m="hsv"}else X(h.h)&&X(h.s)&&X(h.l)&&(m=I(h.s),n=I(h.l),r=a(h.h,m,n),n=!0,m="hsl");h.hasOwnProperty("a")&&(u=h.a)}u=$(u);f=n;h=h.format||m;m=C(255,g(r.r,0));n=C(255,g(r.g,0));r=C(255,g(r.b,0));this._originalInput=c;this._r=m;this._g=n;this._b=r;this._a=u;this._roundA=v(100*this._a)/100;this._format=d.format||h;this._gradientType=d.gradientType;1>this._r&&(this._r=v(this._r));1>this._g&&
(this._g=v(this._g));1>this._b&&(this._b=v(this._b));this._ok=f;this._tc_id=K++}function m(a,b,c){a=M(a,255);b=M(b,255);c=M(c,255);var d=g(a,b,c),e=C(a,b,c),f,h=(d+e)/2;if(d==e)f=e=0;else{var m=d-e,e=0.5<h?m/(2-d-e):m/(d+e);switch(d){case a:f=(b-c)/m+(b<c?6:0);break;case b:f=(c-a)/m+2;break;case c:f=(a-b)/m+4}f/=6}return{h:f,s:e,l:h}}function a(a,b,c){function d(a,b,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(b-a)*c:0.5>c?b:c<2/3?a+(b-a)*(2/3-c)*6:a}a=M(a,360);b=M(b,100);c=M(c,100);if(0===b)c=b=
a=c;else{var e=0.5>c?c*(1+b):c+b-c*b,f=2*c-e;c=d(f,e,a+1/3);b=d(f,e,a);a=d(f,e,a-1/3)}return{r:255*c,g:255*b,b:255*a}}function d(a,b,c){a=M(a,255);b=M(b,255);c=M(c,255);var d=g(a,b,c),e=C(a,b,c),f,h=d-e;if(d==e)f=0;else{switch(d){case a:f=(b-c)/h+(b<c?6:0);break;case b:f=(c-a)/h+2;break;case c:f=(a-b)/h+4}f/=6}return{h:f,s:0===d?0:h/d,v:d}}function c(a,b,c,d){a=[B(v(a).toString(16)),B(v(b).toString(16)),B(v(c).toString(16))];return d&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&
a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function h(a,c,d,e){return[B(b.round(255*parseFloat(e)).toString(16)),B(v(a).toString(16)),B(v(c).toString(16)),B(v(d).toString(16))].join("")}function n(a,b){b=0===b?0:b||10;var c=e(a).toHsl();c.s-=b/100;c.s=C(1,g(0,c.s));return e(c)}function f(a,b){b=0===b?0:b||10;var c=e(a).toHsl();c.s+=b/100;c.s=C(1,g(0,c.s));return e(c)}function z(a){return e(a).desaturate(100)}function r(a,b){b=0===b?0:b||10;var c=e(a).toHsl();
c.l+=b/100;c.l=C(1,g(0,c.l));return e(c)}function E(a,b){b=0===b?0:b||10;var c=e(a).toRgb();c.r=g(0,C(255,c.r-v(255*-(b/100))));c.g=g(0,C(255,c.g-v(255*-(b/100))));c.b=g(0,C(255,c.b-v(255*-(b/100))));return e(c)}function D(a,b){b=0===b?0:b||10;var c=e(a).toHsl();c.l-=b/100;c.l=C(1,g(0,c.l));return e(c)}function y(a,b){var c=e(a).toHsl(),d=(c.h+b)%360;c.h=0>d?360+d:d;return e(c)}function w(a){a=e(a).toHsl();a.h=(a.h+180)%360;return e(a)}function G(a){var b=e(a).toHsl(),c=b.h;return[e(a),e({h:(c+120)%
360,s:b.s,l:b.l}),e({h:(c+240)%360,s:b.s,l:b.l})]}function L(a){var b=e(a).toHsl(),c=b.h;return[e(a),e({h:(c+90)%360,s:b.s,l:b.l}),e({h:(c+180)%360,s:b.s,l:b.l}),e({h:(c+270)%360,s:b.s,l:b.l})]}function R(a){var b=e(a).toHsl(),c=b.h;return[e(a),e({h:(c+72)%360,s:b.s,l:b.l}),e({h:(c+216)%360,s:b.s,l:b.l})]}function W(a,b,c){b=b||6;c=c||30;var d=e(a).toHsl();c=360/c;a=[e(a)];for(d.h=(d.h-(c*b>>1)+720)%360;--b;)d.h=(d.h+c)%360,a.push(e(d));return a}function Y(a,b){b=b||6;for(var c=e(a).toHsv(),d=c.h,
f=c.s,c=c.v,g=[],h=1/b;b--;)g.push(e({h:d,s:f,v:c})),c=(c+h)%1;return g}function $(a){a=parseFloat(a);if(isNaN(a)||0>a||1<a)a=1;return a}function M(a,c){var d=a;"string"==typeof d&&-1!=d.indexOf(".")&&1===parseFloat(d)&&(a="100%");d="string"===typeof a&&-1!=a.indexOf("%");a=C(c,g(0,parseFloat(a)));d&&(a=parseInt(a*c,10)/100);return 1E-6>b.abs(a-c)?1:a%c/parseFloat(c)}function B(a){return 1==a.length?"0"+a:""+a}function I(a){1>=a&&(a=100*a+"%");return a}function X(a){return!!aa.CSS_UNIT.exec(a)}var p=
/^\s+/,F=/\s+$/,K=0,v=b.round,C=b.min,g=b.max,A=b.random;e.prototype={isDark:function(){return 128>this.getBrightness()},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var a=this.toRgb();return(299*a.r+587*a.g+114*a.b)/1E3},getLuminance:function(){var a=this.toRgb(),c,d;c=a.r/255;d=a.g/255;a=a.b/255;c=0.03928>=
c?c/12.92:b.pow((c+0.055)/1.055,2.4);d=0.03928>=d?d/12.92:b.pow((d+0.055)/1.055,2.4);a=0.03928>=a?a/12.92:b.pow((a+0.055)/1.055,2.4);return 0.2126*c+0.7152*d+0.0722*a},setAlpha:function(a){this._a=$(a);this._roundA=v(100*this._a)/100;return this},toHsv:function(){var a=d(this._r,this._g,this._b);return{h:360*a.h,s:a.s,v:a.v,a:this._a}},toHsvString:function(){var a=d(this._r,this._g,this._b),b=v(360*a.h),c=v(100*a.s),a=v(100*a.v);return 1==this._a?"hsv("+b+", "+c+"%, "+a+"%)":"hsva("+b+", "+c+"%, "+
a+"%, "+this._roundA+")"},toHsl:function(){var a=m(this._r,this._g,this._b);return{h:360*a.h,s:a.s,l:a.l,a:this._a}},toHslString:function(){var a=m(this._r,this._g,this._b),b=v(360*a.h),c=v(100*a.s),a=v(100*a.l);return 1==this._a?"hsl("+b+", "+c+"%, "+a+"%)":"hsla("+b+", "+c+"%, "+a+"%, "+this._roundA+")"},toHex:function(a){return c(this._r,this._g,this._b,a)},toHexString:function(a){return"#"+this.toHex(a)},toHex8:function(a){var c=this._g,d=this._b,e=this._a,c=[B(v(this._r).toString(16)),B(v(c).toString(16)),
B(v(d).toString(16)),B(b.round(255*parseFloat(e)).toString(16))];a=a&&c[0].charAt(0)==c[0].charAt(1)&&c[1].charAt(0)==c[1].charAt(1)&&c[2].charAt(0)==c[2].charAt(1)&&c[3].charAt(0)==c[3].charAt(1)?c[0].charAt(0)+c[1].charAt(0)+c[2].charAt(0)+c[3].charAt(0):c.join("");return a},toHex8String:function(a){return"#"+this.toHex8(a)},toRgb:function(){return{r:v(this._r),g:v(this._g),b:v(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+v(this._r)+", "+v(this._g)+", "+v(this._b)+")":"rgba("+
v(this._r)+", "+v(this._g)+", "+v(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:v(100*M(this._r,255))+"%",g:v(100*M(this._g,255))+"%",b:v(100*M(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+v(100*M(this._r,255))+"%, "+v(100*M(this._g,255))+"%, "+v(100*M(this._b,255))+"%)":"rgba("+v(100*M(this._r,255))+"%, "+v(100*M(this._g,255))+"%, "+v(100*M(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":1>this._a?
!1:u[c(this._r,this._g,this._b,!0)]||!1},toFilter:function(a){var b="#"+h(this._r,this._g,this._b,this._a),c=b,d=this._gradientType?"GradientType = 1, ":"";a&&(a=e(a),c="#"+h(a._r,a._g,a._b,a._a));return"progid:DXImageTransform.Microsoft.gradient("+d+"startColorstr="+b+",endColorstr="+c+")"},toString:function(a){var b=!!a;a=a||this._format;var c=!1,d=1>this._a&&0<=this._a;if(!b&&d&&("hex"===a||"hex6"===a||"hex3"===a||"hex4"===a||"hex8"===a||"name"===a))return"name"===a&&0===this._a?this.toName():
this.toRgbString();"rgb"===a&&(c=this.toRgbString());"prgb"===a&&(c=this.toPercentageRgbString());if("hex"===a||"hex6"===a)c=this.toHexString();"hex3"===a&&(c=this.toHexString(!0));"hex4"===a&&(c=this.toHex8String(!0));"hex8"===a&&(c=this.toHex8String());"name"===a&&(c=this.toName());"hsl"===a&&(c=this.toHslString());"hsv"===a&&(c=this.toHsvString());return c||this.toHexString()},clone:function(){return e(this.toString())},_applyModification:function(a,b){var c=a.apply(null,[this].concat([].slice.call(b)));
this._r=c._r;this._g=c._g;this._b=c._b;this.setAlpha(c._a);return this},lighten:function(){return this._applyModification(r,arguments)},brighten:function(){return this._applyModification(E,arguments)},darken:function(){return this._applyModification(D,arguments)},desaturate:function(){return this._applyModification(n,arguments)},saturate:function(){return this._applyModification(f,arguments)},greyscale:function(){return this._applyModification(z,arguments)},spin:function(){return this._applyModification(y,
arguments)},_applyCombination:function(a,b){return a.apply(null,[this].concat([].slice.call(b)))},analogous:function(){return this._applyCombination(W,arguments)},complement:function(){return this._applyCombination(w,arguments)},monochromatic:function(){return this._applyCombination(Y,arguments)},splitcomplement:function(){return this._applyCombination(R,arguments)},triad:function(){return this._applyCombination(G,arguments)},tetrad:function(){return this._applyCombination(L,arguments)}};e.fromRatio=
function(a,b){if("object"==typeof a){var c={},d;for(d in a)a.hasOwnProperty(d)&&(c[d]="a"===d?a[d]:I(a[d]));a=c}return e(a,b)};e.equals=function(a,b){return a&&b?e(a).toRgbString()==e(b).toRgbString():!1};e.random=function(){return e.fromRatio({r:A(),g:A(),b:A()})};e.mix=function(a,b,c){c=0===c?0:c||50;a=e(a).toRgb();b=e(b).toRgb();c/=100;return e({r:(b.r-a.r)*c+a.r,g:(b.g-a.g)*c+a.g,b:(b.b-a.b)*c+a.b,a:(b.a-a.a)*c+a.a})};e.readability=function(a,c){var d=e(a),f=e(c);return(b.max(d.getLuminance(),
f.getLuminance())+0.05)/(b.min(d.getLuminance(),f.getLuminance())+0.05)};e.isReadable=function(a,b,c){a=e.readability(a,b);b=!1;var d;d=c||{level:"AA",size:"small"};c=(d.level||"AA").toUpperCase();d=(d.size||"small").toLowerCase();"AA"!==c&&"AAA"!==c&&(c="AA");"small"!==d&&"large"!==d&&(d="small");switch(c+d){case "AAsmall":case "AAAlarge":b=4.5<=a;break;case "AAlarge":b=3<=a;break;case "AAAsmall":b=7<=a}return b};e.mostReadable=function(a,b,c){var d=null,f=0,g,h,m,n;c=c||{};h=c.includeFallbackColors;
m=c.level;n=c.size;for(var p=0;p<b.length;p++)g=e.readability(a,b[p]),g>f&&(f=g,d=e(b[p]));if(e.isReadable(a,d,{level:m,size:n})||!h)return d;c.includeFallbackColors=!1;return e.mostReadable(a,["#fff","#000"],c)};var q=e.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",
chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",
deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",
lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",
mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",
rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},u=e.hexNames=function(a){var b={},
c;for(c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b}(q),aa={CSS_UNIT:/(?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?)/,rgb:RegExp("rgb[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),rgba:RegExp("rgba[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),
hsl:RegExp("hsl[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),hsla:RegExp("hsla[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),hsv:RegExp("hsv[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),
hsva:RegExp("hsva[\\s|\\(]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))[,|\\s]+((?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?))\\s*\\)?"),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};
"undefined"!==typeof P&&P.exports?P.exports=e:window.tinycolor=e})(Math)},{}]},{},[6])(6)});
